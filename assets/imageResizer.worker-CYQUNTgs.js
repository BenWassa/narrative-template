(function(){"use strict";async function g(s,a,o,i){return new Promise((c,r)=>{const e=new FileReader;e.onload=m=>{const t=new Image;t.onload=()=>{const n=document.createElement("canvas");n.width=a,n.height=o;const l=n.getContext("2d");if(!l){r(new Error("Failed to get canvas context"));return}l.drawImage(t,0,0,a,o),n.toBlob(d=>{d?c(d):r(new Error("Failed to create blob from canvas"))},"image/jpeg",i)},t.onerror=()=>{r(new Error("Failed to load image"))},t.src=m.target?.result},e.onerror=()=>{r(new Error("Failed to read blob"))},e.readAsDataURL(s)})}self.onmessage=async s=>{const{id:a,blob:o,width:i,height:c,quality:r}=s.data;try{const e=await g(o,i,c,r);self.postMessage({id:a,blob:e})}catch(e){self.postMessage({id:a,error:e instanceof Error?e.message:String(e)})}}})();
