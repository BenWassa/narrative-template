(function(){"use strict";async function g(n,t,s,r,c=!0){const o=await createImageBitmap(n),a=new OffscreenCanvas(t,s),e=a.getContext("2d");if(!e)throw new Error("Failed to get canvas context");e.drawImage(o,0,0,t,s);let i;try{if(c)i=await a.convertToBlob({type:"image/webp",quality:r});else throw new Error("WebP disabled")}catch{i=await a.convertToBlob({type:"image/jpeg",quality:r})}return o.close(),i}self.onmessage=async n=>{const{id:t,blob:s,width:r,height:c,quality:o,useWebP:a=!0}=n.data;try{const e=await g(s,r,c,o,a);self.postMessage({id:t,blob:e})}catch(e){self.postMessage({id:t,error:e instanceof Error?e.message:String(e)})}}})();
