(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))d(f);new MutationObserver(f=>{for(const p of f)if(p.type==="childList")for(const m of p.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&d(m)}).observe(document,{childList:!0,subtree:!0});function u(f){const p={};return f.integrity&&(p.integrity=f.integrity),f.referrerPolicy&&(p.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?p.credentials="include":f.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function d(f){if(f.ep)return;f.ep=!0;const p=u(f);fetch(f.href,p)}})();function op(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Uo={exports:{}},yl={},Bo={exports:{}},_e={};var zc;function ap(){if(zc)return _e;zc=1;var o=Symbol.for("react.element"),a=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),m=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),N=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),C=Symbol.iterator;function D(g){return g===null||typeof g!="object"?null:(g=C&&g[C]||g["@@iterator"],typeof g=="function"?g:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,O={};function U(g,E,A){this.props=g,this.context=E,this.refs=O,this.updater=A||M}U.prototype.isReactComponent={},U.prototype.setState=function(g,E){if(typeof g!="object"&&typeof g!="function"&&g!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,g,E,"setState")},U.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")};function H(){}H.prototype=U.prototype;function W(g,E,A){this.props=g,this.context=E,this.refs=O,this.updater=A||M}var se=W.prototype=new H;se.constructor=W,B(se,U.prototype),se.isPureReactComponent=!0;var R=Array.isArray,G=Object.prototype.hasOwnProperty,ee={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function te(g,E,A){var V,re={},ae=null,ge=null;if(E!=null)for(V in E.ref!==void 0&&(ge=E.ref),E.key!==void 0&&(ae=""+E.key),E)G.call(E,V)&&!T.hasOwnProperty(V)&&(re[V]=E[V]);var Se=arguments.length-2;if(Se===1)re.children=A;else if(1<Se){for(var J=Array(Se),Oe=0;Oe<Se;Oe++)J[Oe]=arguments[Oe+2];re.children=J}if(g&&g.defaultProps)for(V in Se=g.defaultProps,Se)re[V]===void 0&&(re[V]=Se[V]);return{$$typeof:o,type:g,key:ae,ref:ge,props:re,_owner:ee.current}}function q(g,E){return{$$typeof:o,type:g.type,key:E,ref:g.ref,props:g.props,_owner:g._owner}}function I(g){return typeof g=="object"&&g!==null&&g.$$typeof===o}function de(g){var E={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,function(A){return E[A]})}var z=/\/+/g;function fe(g,E){return typeof g=="object"&&g!==null&&g.key!=null?de(""+g.key):E.toString(36)}function ie(g,E,A,V,re){var ae=typeof g;(ae==="undefined"||ae==="boolean")&&(g=null);var ge=!1;if(g===null)ge=!0;else switch(ae){case"string":case"number":ge=!0;break;case"object":switch(g.$$typeof){case o:case a:ge=!0}}if(ge)return ge=g,re=re(ge),g=V===""?"."+fe(ge,0):V,R(re)?(A="",g!=null&&(A=g.replace(z,"$&/")+"/"),ie(re,E,A,"",function(Oe){return Oe})):re!=null&&(I(re)&&(re=q(re,A+(!re.key||ge&&ge.key===re.key?"":(""+re.key).replace(z,"$&/")+"/")+g)),E.push(re)),1;if(ge=0,V=V===""?".":V+":",R(g))for(var Se=0;Se<g.length;Se++){ae=g[Se];var J=V+fe(ae,Se);ge+=ie(ae,E,A,J,re)}else if(J=D(g),typeof J=="function")for(g=J.call(g),Se=0;!(ae=g.next()).done;)ae=ae.value,J=V+fe(ae,Se++),ge+=ie(ae,E,A,J,re);else if(ae==="object")throw E=String(g),Error("Objects are not valid as a React child (found: "+(E==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":E)+"). If you meant to render a collection of children, use an array instead.");return ge}function ce(g,E,A){if(g==null)return g;var V=[],re=0;return ie(g,V,"","",function(ae){return E.call(A,ae,re++)}),V}function le(g){if(g._status===-1){var E=g._result;E=E(),E.then(function(A){(g._status===0||g._status===-1)&&(g._status=1,g._result=A)},function(A){(g._status===0||g._status===-1)&&(g._status=2,g._result=A)}),g._status===-1&&(g._status=0,g._result=E)}if(g._status===1)return g._result.default;throw g._result}var $={current:null},h={transition:null},F={ReactCurrentDispatcher:$,ReactCurrentBatchConfig:h,ReactCurrentOwner:ee};function k(){throw Error("act(...) is not supported in production builds of React.")}return _e.Children={map:ce,forEach:function(g,E,A){ce(g,function(){E.apply(this,arguments)},A)},count:function(g){var E=0;return ce(g,function(){E++}),E},toArray:function(g){return ce(g,function(E){return E})||[]},only:function(g){if(!I(g))throw Error("React.Children.only expected to receive a single React element child.");return g}},_e.Component=U,_e.Fragment=u,_e.Profiler=f,_e.PureComponent=W,_e.StrictMode=d,_e.Suspense=x,_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,_e.act=k,_e.cloneElement=function(g,E,A){if(g==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+g+".");var V=B({},g.props),re=g.key,ae=g.ref,ge=g._owner;if(E!=null){if(E.ref!==void 0&&(ae=E.ref,ge=ee.current),E.key!==void 0&&(re=""+E.key),g.type&&g.type.defaultProps)var Se=g.type.defaultProps;for(J in E)G.call(E,J)&&!T.hasOwnProperty(J)&&(V[J]=E[J]===void 0&&Se!==void 0?Se[J]:E[J])}var J=arguments.length-2;if(J===1)V.children=A;else if(1<J){Se=Array(J);for(var Oe=0;Oe<J;Oe++)Se[Oe]=arguments[Oe+2];V.children=Se}return{$$typeof:o,type:g.type,key:re,ref:ae,props:V,_owner:ge}},_e.createContext=function(g){return g={$$typeof:m,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},g.Provider={$$typeof:p,_context:g},g.Consumer=g},_e.createElement=te,_e.createFactory=function(g){var E=te.bind(null,g);return E.type=g,E},_e.createRef=function(){return{current:null}},_e.forwardRef=function(g){return{$$typeof:y,render:g}},_e.isValidElement=I,_e.lazy=function(g){return{$$typeof:w,_payload:{_status:-1,_result:g},_init:le}},_e.memo=function(g,E){return{$$typeof:N,type:g,compare:E===void 0?null:E}},_e.startTransition=function(g){var E=h.transition;h.transition={};try{g()}finally{h.transition=E}},_e.unstable_act=k,_e.useCallback=function(g,E){return $.current.useCallback(g,E)},_e.useContext=function(g){return $.current.useContext(g)},_e.useDebugValue=function(){},_e.useDeferredValue=function(g){return $.current.useDeferredValue(g)},_e.useEffect=function(g,E){return $.current.useEffect(g,E)},_e.useId=function(){return $.current.useId()},_e.useImperativeHandle=function(g,E,A){return $.current.useImperativeHandle(g,E,A)},_e.useInsertionEffect=function(g,E){return $.current.useInsertionEffect(g,E)},_e.useLayoutEffect=function(g,E){return $.current.useLayoutEffect(g,E)},_e.useMemo=function(g,E){return $.current.useMemo(g,E)},_e.useReducer=function(g,E,A){return $.current.useReducer(g,E,A)},_e.useRef=function(g){return $.current.useRef(g)},_e.useState=function(g){return $.current.useState(g)},_e.useSyncExternalStore=function(g,E,A){return $.current.useSyncExternalStore(g,E,A)},_e.useTransition=function(){return $.current.useTransition()},_e.version="18.3.1",_e}var Ic;function oa(){return Ic||(Ic=1,Bo.exports=ap()),Bo.exports}var Mc;function up(){if(Mc)return yl;Mc=1;var o=oa(),a=Symbol.for("react.element"),u=Symbol.for("react.fragment"),d=Object.prototype.hasOwnProperty,f=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function m(y,x,N){var w,C={},D=null,M=null;N!==void 0&&(D=""+N),x.key!==void 0&&(D=""+x.key),x.ref!==void 0&&(M=x.ref);for(w in x)d.call(x,w)&&!p.hasOwnProperty(w)&&(C[w]=x[w]);if(y&&y.defaultProps)for(w in x=y.defaultProps,x)C[w]===void 0&&(C[w]=x[w]);return{$$typeof:a,type:y,key:D,ref:M,props:C,_owner:f.current}}return yl.Fragment=u,yl.jsx=m,yl.jsxs=m,yl}var Fc;function cp(){return Fc||(Fc=1,Uo.exports=up()),Uo.exports}var s=cp(),b=oa();const As=op(b);var Fs={},Ho={exports:{}},vt={},Vo={exports:{}},Wo={};var $c;function dp(){return $c||($c=1,(function(o){function a(h,F){var k=h.length;h.push(F);e:for(;0<k;){var g=k-1>>>1,E=h[g];if(0<f(E,F))h[g]=F,h[k]=E,k=g;else break e}}function u(h){return h.length===0?null:h[0]}function d(h){if(h.length===0)return null;var F=h[0],k=h.pop();if(k!==F){h[0]=k;e:for(var g=0,E=h.length,A=E>>>1;g<A;){var V=2*(g+1)-1,re=h[V],ae=V+1,ge=h[ae];if(0>f(re,k))ae<E&&0>f(ge,re)?(h[g]=ge,h[ae]=k,g=ae):(h[g]=re,h[V]=k,g=V);else if(ae<E&&0>f(ge,k))h[g]=ge,h[ae]=k,g=ae;else break e}}return F}function f(h,F){var k=h.sortIndex-F.sortIndex;return k!==0?k:h.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var p=performance;o.unstable_now=function(){return p.now()}}else{var m=Date,y=m.now();o.unstable_now=function(){return m.now()-y}}var x=[],N=[],w=1,C=null,D=3,M=!1,B=!1,O=!1,U=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(h){for(var F=u(N);F!==null;){if(F.callback===null)d(N);else if(F.startTime<=h)d(N),F.sortIndex=F.expirationTime,a(x,F);else break;F=u(N)}}function R(h){if(O=!1,se(h),!B)if(u(x)!==null)B=!0,le(G);else{var F=u(N);F!==null&&$(R,F.startTime-h)}}function G(h,F){B=!1,O&&(O=!1,H(te),te=-1),M=!0;var k=D;try{for(se(F),C=u(x);C!==null&&(!(C.expirationTime>F)||h&&!de());){var g=C.callback;if(typeof g=="function"){C.callback=null,D=C.priorityLevel;var E=g(C.expirationTime<=F);F=o.unstable_now(),typeof E=="function"?C.callback=E:C===u(x)&&d(x),se(F)}else d(x);C=u(x)}if(C!==null)var A=!0;else{var V=u(N);V!==null&&$(R,V.startTime-F),A=!1}return A}finally{C=null,D=k,M=!1}}var ee=!1,T=null,te=-1,q=5,I=-1;function de(){return!(o.unstable_now()-I<q)}function z(){if(T!==null){var h=o.unstable_now();I=h;var F=!0;try{F=T(!0,h)}finally{F?fe():(ee=!1,T=null)}}else ee=!1}var fe;if(typeof W=="function")fe=function(){W(z)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,ce=ie.port2;ie.port1.onmessage=z,fe=function(){ce.postMessage(null)}}else fe=function(){U(z,0)};function le(h){T=h,ee||(ee=!0,fe())}function $(h,F){te=U(function(){h(o.unstable_now())},F)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(h){h.callback=null},o.unstable_continueExecution=function(){B||M||(B=!0,le(G))},o.unstable_forceFrameRate=function(h){0>h||125<h?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<h?Math.floor(1e3/h):5},o.unstable_getCurrentPriorityLevel=function(){return D},o.unstable_getFirstCallbackNode=function(){return u(x)},o.unstable_next=function(h){switch(D){case 1:case 2:case 3:var F=3;break;default:F=D}var k=D;D=F;try{return h()}finally{D=k}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(h,F){switch(h){case 1:case 2:case 3:case 4:case 5:break;default:h=3}var k=D;D=h;try{return F()}finally{D=k}},o.unstable_scheduleCallback=function(h,F,k){var g=o.unstable_now();switch(typeof k=="object"&&k!==null?(k=k.delay,k=typeof k=="number"&&0<k?g+k:g):k=g,h){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=k+E,h={id:w++,callback:F,priorityLevel:h,startTime:k,expirationTime:E,sortIndex:-1},k>g?(h.sortIndex=k,a(N,h),u(x)===null&&h===u(N)&&(O?(H(te),te=-1):O=!0,$(R,k-g))):(h.sortIndex=E,a(x,h),B||M||(B=!0,le(G))),h},o.unstable_shouldYield=de,o.unstable_wrapCallback=function(h){var F=D;return function(){var k=D;D=F;try{return h.apply(this,arguments)}finally{D=k}}}})(Wo)),Wo}var Ac;function fp(){return Ac||(Ac=1,Vo.exports=dp()),Vo.exports}var Uc;function pp(){if(Uc)return vt;Uc=1;var o=oa(),a=fp();function u(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d=new Set,f={};function p(e,t){m(e,t),m(e+"Capture",t)}function m(e,t){for(f[e]=t,e=0;e<t.length;e++)d.add(t[e])}var y=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),x=Object.prototype.hasOwnProperty,N=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},C={};function D(e){return x.call(C,e)?!0:x.call(w,e)?!1:N.test(e)?C[e]=!0:(w[e]=!0,!1)}function M(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function B(e,t,n,r){if(t===null||typeof t>"u"||M(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function O(e,t,n,r,l,i,c){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=c}var U={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){U[e]=new O(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];U[t]=new O(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){U[e]=new O(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){U[e]=new O(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){U[e]=new O(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){U[e]=new O(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){U[e]=new O(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){U[e]=new O(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){U[e]=new O(e,5,!1,e.toLowerCase(),null,!1,!1)});var H=/[\-:]([a-z])/g;function W(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(H,W);U[t]=new O(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(H,W);U[t]=new O(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(H,W);U[t]=new O(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){U[e]=new O(e,1,!1,e.toLowerCase(),null,!1,!1)}),U.xlinkHref=new O("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){U[e]=new O(e,1,!1,e.toLowerCase(),null,!0,!0)});function se(e,t,n,r){var l=U.hasOwnProperty(t)?U[t]:null;(l!==null?l.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(B(t,n,l,r)&&(n=null),r||l===null?D(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):l.mustUseProperty?e[l.propertyName]=n===null?l.type===3?!1:"":n:(t=l.attributeName,r=l.attributeNamespace,n===null?e.removeAttribute(t):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var R=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,G=Symbol.for("react.element"),ee=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),te=Symbol.for("react.strict_mode"),q=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),de=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),fe=Symbol.for("react.suspense"),ie=Symbol.for("react.suspense_list"),ce=Symbol.for("react.memo"),le=Symbol.for("react.lazy"),$=Symbol.for("react.offscreen"),h=Symbol.iterator;function F(e){return e===null||typeof e!="object"?null:(e=h&&e[h]||e["@@iterator"],typeof e=="function"?e:null)}var k=Object.assign,g;function E(e){if(g===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);g=t&&t[1]||""}return`
`+g+e}var A=!1;function V(e,t){if(!e||A)return"";A=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(L){var r=L}Reflect.construct(e,[],t)}else{try{t.call()}catch(L){r=L}e.call(t.prototype)}else{try{throw Error()}catch(L){r=L}e()}}catch(L){if(L&&r&&typeof L.stack=="string"){for(var l=L.stack.split(`
`),i=r.stack.split(`
`),c=l.length-1,v=i.length-1;1<=c&&0<=v&&l[c]!==i[v];)v--;for(;1<=c&&0<=v;c--,v--)if(l[c]!==i[v]){if(c!==1||v!==1)do if(c--,v--,0>v||l[c]!==i[v]){var j=`
`+l[c].replace(" at new "," at ");return e.displayName&&j.includes("<anonymous>")&&(j=j.replace("<anonymous>",e.displayName)),j}while(1<=c&&0<=v);break}}}finally{A=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?E(e):""}function re(e){switch(e.tag){case 5:return E(e.type);case 16:return E("Lazy");case 13:return E("Suspense");case 19:return E("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1),e;case 11:return e=V(e.type.render,!1),e;case 1:return e=V(e.type,!0),e;default:return""}}function ae(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case T:return"Fragment";case ee:return"Portal";case q:return"Profiler";case te:return"StrictMode";case fe:return"Suspense";case ie:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case de:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case z:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ce:return t=e.displayName||null,t!==null?t:ae(e.type)||"Memo";case le:t=e._payload,e=e._init;try{return ae(e(t))}catch{}}return null}function ge(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ae(t);case 8:return t===te?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Se(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function J(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Oe(e){var t=J(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(c){r=""+c,i.call(this,c)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(c){r=""+c},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Q(e){e._valueTracker||(e._valueTracker=Oe(e))}function oe(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=J(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function he(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Z(e,t){var n=t.checked;return k({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function ye(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Se(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ve(e,t){t=t.checked,t!=null&&se(e,"checked",t,!1)}function Ee(e,t){ve(e,t);var n=Se(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?be(e,t.type,n):t.hasOwnProperty("defaultValue")&&be(e,t.type,Se(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Pe(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function be(e,t,n){(t!=="number"||he(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var De=Array.isArray;function Re(e,t,n,r){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Se(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,r&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function st(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(u(91));return k({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ct(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(u(92));if(De(n)){if(1<n.length)throw Error(u(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Se(n)}}function Xe(e,t){var n=Se(t.value),r=Se(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Ue(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Yt(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rn(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Yt(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var qn,wl=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,l){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,l)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(qn=qn||document.createElement("div"),qn.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qn.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Tn(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ln={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ei=["Webkit","ms","Moz","O"];Object.keys(Ln).forEach(function(e){ei.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ln[t]=Ln[e]})});function jl(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ln.hasOwnProperty(e)&&Ln[e]?(""+t).trim():t+"px"}function Nl(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,l=jl(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,l):e[n]=l}}var ti=k({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dr(e,t){if(t){if(ti[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(u(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(u(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(u(61))}if(t.style!=null&&typeof t.style!="object")throw Error(u(62))}}function _r(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Or=null;function Rr(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Tr=null,qt=null,Ut=null;function kl(e){if(e=nl(e)){if(typeof Tr!="function")throw Error(u(280));var t=e.stateNode;t&&(t=Zl(t),Tr(e.stateNode,e.type,t))}}function Sl(e){qt?Ut?Ut.push(e):Ut=[e]:qt=e}function bl(){if(qt){var e=qt,t=Ut;if(Ut=qt=null,kl(e),t)for(e=0;e<t.length;e++)kl(t[e])}}function Cl(e,t){return e(t)}function Jn(){}var Jt=!1;function El(e,t,n){if(Jt)return e(t,n);Jt=!0;try{return Cl(e,t,n)}finally{Jt=!1,(qt!==null||Ut!==null)&&(Jn(),bl())}}function Rt(e,t){var n=e.stateNode;if(n===null)return null;var r=Zl(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(u(231,t,typeof n));return n}var zn=!1;if(y)try{var cn={};Object.defineProperty(cn,"passive",{get:function(){zn=!0}}),window.addEventListener("test",cn,cn),window.removeEventListener("test",cn,cn)}catch{zn=!1}function ni(e,t,n,r,l,i,c,v,j){var L=Array.prototype.slice.call(arguments,3);try{t.apply(n,L)}catch(Y){this.onError(Y)}}var In=!1,Xn=null,Zn=!1,Lr=null,ri={onError:function(e){In=!0,Xn=e}};function Xt(e,t,n,r,l,i,c,v,j){In=!1,Xn=null,ni.apply(ri,arguments)}function zr(e,t,n,r,l,i,c,v,j){if(Xt.apply(this,arguments),In){if(In){var L=Xn;In=!1,Xn=null}else throw Error(u(198));Zn||(Zn=!0,Lr=L)}}function Zt(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Pl(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Dl(e){if(Zt(e)!==e)throw Error(u(188))}function li(e){var t=e.alternate;if(!t){if(t=Zt(e),t===null)throw Error(u(188));return t!==e?null:e}for(var n=e,r=t;;){var l=n.return;if(l===null)break;var i=l.alternate;if(i===null){if(r=l.return,r!==null){n=r;continue}break}if(l.child===i.child){for(i=l.child;i;){if(i===n)return Dl(l),e;if(i===r)return Dl(l),t;i=i.sibling}throw Error(u(188))}if(n.return!==r.return)n=l,r=i;else{for(var c=!1,v=l.child;v;){if(v===n){c=!0,n=l,r=i;break}if(v===r){c=!0,r=l,n=i;break}v=v.sibling}if(!c){for(v=i.child;v;){if(v===n){c=!0,n=i,r=l;break}if(v===r){c=!0,r=i,n=l;break}v=v.sibling}if(!c)throw Error(u(189))}}if(n.alternate!==r)throw Error(u(190))}if(n.tag!==3)throw Error(u(188));return n.stateNode.current===n?e:t}function _l(e){return e=li(e),e!==null?Ol(e):null}function Ol(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ol(e);if(t!==null)return t;e=e.sibling}return null}var Ir=a.unstable_scheduleCallback,Rl=a.unstable_cancelCallback,Mr=a.unstable_shouldYield,si=a.unstable_requestPaint,Be=a.unstable_now,ii=a.unstable_getCurrentPriorityLevel,je=a.unstable_ImmediatePriority,ze=a.unstable_UserBlockingPriority,Ve=a.unstable_NormalPriority,bt=a.unstable_LowPriority,Tl=a.unstable_IdlePriority,Ll=null,Bt=null;function jd(e){if(Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(Ll,e,void 0,(e.current.flags&128)===128)}catch{}}var Tt=Math.clz32?Math.clz32:Sd,Nd=Math.log,kd=Math.LN2;function Sd(e){return e>>>=0,e===0?32:31-(Nd(e)/kd|0)|0}var zl=64,Il=4194304;function Fr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ml(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,l=e.suspendedLanes,i=e.pingedLanes,c=n&268435455;if(c!==0){var v=c&~l;v!==0?r=Fr(v):(i&=c,i!==0&&(r=Fr(i)))}else c=n&~l,c!==0?r=Fr(c):i!==0&&(r=Fr(i));if(r===0)return 0;if(t!==0&&t!==r&&(t&l)===0&&(l=r&-r,i=t&-t,l>=i||l===16&&(i&4194240)!==0))return t;if((r&4)!==0&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Tt(t),l=1<<n,r|=e[n],t&=~l;return r}function bd(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cd(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,l=e.expirationTimes,i=e.pendingLanes;0<i;){var c=31-Tt(i),v=1<<c,j=l[c];j===-1?((v&n)===0||(v&r)!==0)&&(l[c]=bd(v,t)):j<=t&&(e.expiredLanes|=v),i&=~v}}function oi(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function fa(){var e=zl;return zl<<=1,(zl&4194240)===0&&(zl=64),e}function ai(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function $r(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Tt(t),e[t]=n}function Ed(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var l=31-Tt(n),i=1<<l;t[l]=0,r[l]=-1,e[l]=-1,n&=~i}}function ui(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Tt(n),l=1<<r;l&t|e[r]&t&&(e[r]|=t),n&=~l}}var Ie=0;function pa(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var ha,ci,ma,ga,ya,di=!1,Fl=[],dn=null,fn=null,pn=null,Ar=new Map,Ur=new Map,hn=[],Pd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function va(e,t){switch(e){case"focusin":case"focusout":dn=null;break;case"dragenter":case"dragleave":fn=null;break;case"mouseover":case"mouseout":pn=null;break;case"pointerover":case"pointerout":Ar.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ur.delete(t.pointerId)}}function Br(e,t,n,r,l,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[l]},t!==null&&(t=nl(t),t!==null&&ci(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function Dd(e,t,n,r,l){switch(t){case"focusin":return dn=Br(dn,e,t,n,r,l),!0;case"dragenter":return fn=Br(fn,e,t,n,r,l),!0;case"mouseover":return pn=Br(pn,e,t,n,r,l),!0;case"pointerover":var i=l.pointerId;return Ar.set(i,Br(Ar.get(i)||null,e,t,n,r,l)),!0;case"gotpointercapture":return i=l.pointerId,Ur.set(i,Br(Ur.get(i)||null,e,t,n,r,l)),!0}return!1}function xa(e){var t=Mn(e.target);if(t!==null){var n=Zt(t);if(n!==null){if(t=n.tag,t===13){if(t=Pl(n),t!==null){e.blockedOn=t,ya(e.priority,function(){ma(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $l(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=pi(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Or=r,n.target.dispatchEvent(r),Or=null}else return t=nl(n),t!==null&&ci(t),e.blockedOn=n,!1;t.shift()}return!0}function wa(e,t,n){$l(e)&&n.delete(t)}function _d(){di=!1,dn!==null&&$l(dn)&&(dn=null),fn!==null&&$l(fn)&&(fn=null),pn!==null&&$l(pn)&&(pn=null),Ar.forEach(wa),Ur.forEach(wa)}function Hr(e,t){e.blockedOn===t&&(e.blockedOn=null,di||(di=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,_d)))}function Vr(e){function t(l){return Hr(l,e)}if(0<Fl.length){Hr(Fl[0],e);for(var n=1;n<Fl.length;n++){var r=Fl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(dn!==null&&Hr(dn,e),fn!==null&&Hr(fn,e),pn!==null&&Hr(pn,e),Ar.forEach(t),Ur.forEach(t),n=0;n<hn.length;n++)r=hn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<hn.length&&(n=hn[0],n.blockedOn===null);)xa(n),n.blockedOn===null&&hn.shift()}var er=R.ReactCurrentBatchConfig,Al=!0;function Od(e,t,n,r){var l=Ie,i=er.transition;er.transition=null;try{Ie=1,fi(e,t,n,r)}finally{Ie=l,er.transition=i}}function Rd(e,t,n,r){var l=Ie,i=er.transition;er.transition=null;try{Ie=4,fi(e,t,n,r)}finally{Ie=l,er.transition=i}}function fi(e,t,n,r){if(Al){var l=pi(e,t,n,r);if(l===null)_i(e,t,r,Ul,n),va(e,r);else if(Dd(l,e,t,n,r))r.stopPropagation();else if(va(e,r),t&4&&-1<Pd.indexOf(e)){for(;l!==null;){var i=nl(l);if(i!==null&&ha(i),i=pi(e,t,n,r),i===null&&_i(e,t,r,Ul,n),i===l)break;l=i}l!==null&&r.stopPropagation()}else _i(e,t,r,null,n)}}var Ul=null;function pi(e,t,n,r){if(Ul=null,e=Rr(r),e=Mn(e),e!==null)if(t=Zt(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Pl(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ul=e,null}function ja(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ii()){case je:return 1;case ze:return 4;case Ve:case bt:return 16;case Tl:return 536870912;default:return 16}default:return 16}}var mn=null,hi=null,Bl=null;function Na(){if(Bl)return Bl;var e,t=hi,n=t.length,r,l="value"in mn?mn.value:mn.textContent,i=l.length;for(e=0;e<n&&t[e]===l[e];e++);var c=n-e;for(r=1;r<=c&&t[n-r]===l[i-r];r++);return Bl=l.slice(e,1<r?1-r:void 0)}function Hl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Vl(){return!0}function ka(){return!1}function jt(e){function t(n,r,l,i,c){this._reactName=n,this._targetInst=l,this.type=r,this.nativeEvent=i,this.target=c,this.currentTarget=null;for(var v in e)e.hasOwnProperty(v)&&(n=e[v],this[v]=n?n(i):i[v]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Vl:ka,this.isPropagationStopped=ka,this}return k(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Vl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Vl)},persist:function(){},isPersistent:Vl}),t}var tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mi=jt(tr),Wr=k({},tr,{view:0,detail:0}),Td=jt(Wr),gi,yi,Kr,Wl=k({},Wr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xi,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Kr&&(Kr&&e.type==="mousemove"?(gi=e.screenX-Kr.screenX,yi=e.screenY-Kr.screenY):yi=gi=0,Kr=e),gi)},movementY:function(e){return"movementY"in e?e.movementY:yi}}),Sa=jt(Wl),Ld=k({},Wl,{dataTransfer:0}),zd=jt(Ld),Id=k({},Wr,{relatedTarget:0}),vi=jt(Id),Md=k({},tr,{animationName:0,elapsedTime:0,pseudoElement:0}),Fd=jt(Md),$d=k({},tr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ad=jt($d),Ud=k({},tr,{data:0}),ba=jt(Ud),Bd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wd(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Vd[e])?!!t[e]:!1}function xi(){return Wd}var Kd=k({},Wr,{key:function(e){if(e.key){var t=Bd[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Hl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Hd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xi,charCode:function(e){return e.type==="keypress"?Hl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Hl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Gd=jt(Kd),Qd=k({},Wl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ca=jt(Qd),Yd=k({},Wr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xi}),qd=jt(Yd),Jd=k({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=jt(Jd),Zd=k({},Wl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ef=jt(Zd),tf=[9,13,27,32],wi=y&&"CompositionEvent"in window,Gr=null;y&&"documentMode"in document&&(Gr=document.documentMode);var nf=y&&"TextEvent"in window&&!Gr,Ea=y&&(!wi||Gr&&8<Gr&&11>=Gr),Pa=" ",Da=!1;function _a(e,t){switch(e){case"keyup":return tf.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Oa(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var nr=!1;function rf(e,t){switch(e){case"compositionend":return Oa(t);case"keypress":return t.which!==32?null:(Da=!0,Pa);case"textInput":return e=t.data,e===Pa&&Da?null:e;default:return null}}function lf(e,t){if(nr)return e==="compositionend"||!wi&&_a(e,t)?(e=Na(),Bl=hi=mn=null,nr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ea&&t.locale!=="ko"?null:t.data;default:return null}}var sf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ra(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!sf[e.type]:t==="textarea"}function Ta(e,t,n,r){Sl(r),t=ql(t,"onChange"),0<t.length&&(n=new mi("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Qr=null,Yr=null;function of(e){Ja(e,0)}function Kl(e){var t=or(e);if(oe(t))return e}function af(e,t){if(e==="change")return t}var La=!1;if(y){var ji;if(y){var Ni="oninput"in document;if(!Ni){var za=document.createElement("div");za.setAttribute("oninput","return;"),Ni=typeof za.oninput=="function"}ji=Ni}else ji=!1;La=ji&&(!document.documentMode||9<document.documentMode)}function Ia(){Qr&&(Qr.detachEvent("onpropertychange",Ma),Yr=Qr=null)}function Ma(e){if(e.propertyName==="value"&&Kl(Yr)){var t=[];Ta(t,Yr,e,Rr(e)),El(of,t)}}function uf(e,t,n){e==="focusin"?(Ia(),Qr=t,Yr=n,Qr.attachEvent("onpropertychange",Ma)):e==="focusout"&&Ia()}function cf(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Kl(Yr)}function df(e,t){if(e==="click")return Kl(t)}function ff(e,t){if(e==="input"||e==="change")return Kl(t)}function pf(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Lt=typeof Object.is=="function"?Object.is:pf;function qr(e,t){if(Lt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var l=n[r];if(!x.call(t,l)||!Lt(e[l],t[l]))return!1}return!0}function Fa(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $a(e,t){var n=Fa(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Fa(n)}}function Aa(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Aa(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ua(){for(var e=window,t=he();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=he(e.document)}return t}function ki(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function hf(e){var t=Ua(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Aa(n.ownerDocument.documentElement,n)){if(r!==null&&ki(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=n.textContent.length,i=Math.min(r.start,l);r=r.end===void 0?i:Math.min(r.end,l),!e.extend&&i>r&&(l=r,r=i,i=l),l=$a(n,i);var c=$a(n,r);l&&c&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==c.node||e.focusOffset!==c.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(c.node,c.offset)):(t.setEnd(c.node,c.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mf=y&&"documentMode"in document&&11>=document.documentMode,rr=null,Si=null,Jr=null,bi=!1;function Ba(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;bi||rr==null||rr!==he(r)||(r=rr,"selectionStart"in r&&ki(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Jr&&qr(Jr,r)||(Jr=r,r=ql(Si,"onSelect"),0<r.length&&(t=new mi("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function Gl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var lr={animationend:Gl("Animation","AnimationEnd"),animationiteration:Gl("Animation","AnimationIteration"),animationstart:Gl("Animation","AnimationStart"),transitionend:Gl("Transition","TransitionEnd")},Ci={},Ha={};y&&(Ha=document.createElement("div").style,"AnimationEvent"in window||(delete lr.animationend.animation,delete lr.animationiteration.animation,delete lr.animationstart.animation),"TransitionEvent"in window||delete lr.transitionend.transition);function Ql(e){if(Ci[e])return Ci[e];if(!lr[e])return e;var t=lr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ha)return Ci[e]=t[n];return e}var Va=Ql("animationend"),Wa=Ql("animationiteration"),Ka=Ql("animationstart"),Ga=Ql("transitionend"),Qa=new Map,Ya="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gn(e,t){Qa.set(e,t),p(t,[e])}for(var Ei=0;Ei<Ya.length;Ei++){var Pi=Ya[Ei],gf=Pi.toLowerCase(),yf=Pi[0].toUpperCase()+Pi.slice(1);gn(gf,"on"+yf)}gn(Va,"onAnimationEnd"),gn(Wa,"onAnimationIteration"),gn(Ka,"onAnimationStart"),gn("dblclick","onDoubleClick"),gn("focusin","onFocus"),gn("focusout","onBlur"),gn(Ga,"onTransitionEnd"),m("onMouseEnter",["mouseout","mouseover"]),m("onMouseLeave",["mouseout","mouseover"]),m("onPointerEnter",["pointerout","pointerover"]),m("onPointerLeave",["pointerout","pointerover"]),p("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),p("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),p("onBeforeInput",["compositionend","keypress","textInput","paste"]),p("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),p("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),p("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vf=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xr));function qa(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,zr(r,t,void 0,e),e.currentTarget=null}function Ja(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],l=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var c=r.length-1;0<=c;c--){var v=r[c],j=v.instance,L=v.currentTarget;if(v=v.listener,j!==i&&l.isPropagationStopped())break e;qa(l,v,L),i=j}else for(c=0;c<r.length;c++){if(v=r[c],j=v.instance,L=v.currentTarget,v=v.listener,j!==i&&l.isPropagationStopped())break e;qa(l,v,L),i=j}}}if(Zn)throw e=Lr,Zn=!1,Lr=null,e}function $e(e,t){var n=t[Ii];n===void 0&&(n=t[Ii]=new Set);var r=e+"__bubble";n.has(r)||(Xa(t,e,2,!1),n.add(r))}function Di(e,t,n){var r=0;t&&(r|=4),Xa(n,e,r,t)}var Yl="_reactListening"+Math.random().toString(36).slice(2);function Zr(e){if(!e[Yl]){e[Yl]=!0,d.forEach(function(n){n!=="selectionchange"&&(vf.has(n)||Di(n,!1,e),Di(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Yl]||(t[Yl]=!0,Di("selectionchange",!1,t))}}function Xa(e,t,n,r){switch(ja(t)){case 1:var l=Od;break;case 4:l=Rd;break;default:l=fi}n=l.bind(null,t,n,e),l=void 0,!zn||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),r?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function _i(e,t,n,r,l){var i=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var c=r.tag;if(c===3||c===4){var v=r.stateNode.containerInfo;if(v===l||v.nodeType===8&&v.parentNode===l)break;if(c===4)for(c=r.return;c!==null;){var j=c.tag;if((j===3||j===4)&&(j=c.stateNode.containerInfo,j===l||j.nodeType===8&&j.parentNode===l))return;c=c.return}for(;v!==null;){if(c=Mn(v),c===null)return;if(j=c.tag,j===5||j===6){r=i=c;continue e}v=v.parentNode}}r=r.return}El(function(){var L=i,Y=Rr(n),X=[];e:{var K=Qa.get(e);if(K!==void 0){var ue=mi,me=e;switch(e){case"keypress":if(Hl(n)===0)break e;case"keydown":case"keyup":ue=Gd;break;case"focusin":me="focus",ue=vi;break;case"focusout":me="blur",ue=vi;break;case"beforeblur":case"afterblur":ue=vi;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=Sa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=zd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=qd;break;case Va:case Wa:case Ka:ue=Fd;break;case Ga:ue=Xd;break;case"scroll":ue=Td;break;case"wheel":ue=ef;break;case"copy":case"cut":case"paste":ue=Ad;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=Ca}var xe=(t&4)!==0,Qe=!xe&&e==="scroll",P=xe?K!==null?K+"Capture":null:K;xe=[];for(var S=L,_;S!==null;){_=S;var ne=_.stateNode;if(_.tag===5&&ne!==null&&(_=ne,P!==null&&(ne=Rt(S,P),ne!=null&&xe.push(el(S,ne,_)))),Qe)break;S=S.return}0<xe.length&&(K=new ue(K,me,null,n,Y),X.push({event:K,listeners:xe}))}}if((t&7)===0){e:{if(K=e==="mouseover"||e==="pointerover",ue=e==="mouseout"||e==="pointerout",K&&n!==Or&&(me=n.relatedTarget||n.fromElement)&&(Mn(me)||me[en]))break e;if((ue||K)&&(K=Y.window===Y?Y:(K=Y.ownerDocument)?K.defaultView||K.parentWindow:window,ue?(me=n.relatedTarget||n.toElement,ue=L,me=me?Mn(me):null,me!==null&&(Qe=Zt(me),me!==Qe||me.tag!==5&&me.tag!==6)&&(me=null)):(ue=null,me=L),ue!==me)){if(xe=Sa,ne="onMouseLeave",P="onMouseEnter",S="mouse",(e==="pointerout"||e==="pointerover")&&(xe=Ca,ne="onPointerLeave",P="onPointerEnter",S="pointer"),Qe=ue==null?K:or(ue),_=me==null?K:or(me),K=new xe(ne,S+"leave",ue,n,Y),K.target=Qe,K.relatedTarget=_,ne=null,Mn(Y)===L&&(xe=new xe(P,S+"enter",me,n,Y),xe.target=_,xe.relatedTarget=Qe,ne=xe),Qe=ne,ue&&me)t:{for(xe=ue,P=me,S=0,_=xe;_;_=sr(_))S++;for(_=0,ne=P;ne;ne=sr(ne))_++;for(;0<S-_;)xe=sr(xe),S--;for(;0<_-S;)P=sr(P),_--;for(;S--;){if(xe===P||P!==null&&xe===P.alternate)break t;xe=sr(xe),P=sr(P)}xe=null}else xe=null;ue!==null&&Za(X,K,ue,xe,!1),me!==null&&Qe!==null&&Za(X,Qe,me,xe,!0)}}e:{if(K=L?or(L):window,ue=K.nodeName&&K.nodeName.toLowerCase(),ue==="select"||ue==="input"&&K.type==="file")var we=af;else if(Ra(K))if(La)we=ff;else{we=cf;var Ne=uf}else(ue=K.nodeName)&&ue.toLowerCase()==="input"&&(K.type==="checkbox"||K.type==="radio")&&(we=df);if(we&&(we=we(e,L))){Ta(X,we,n,Y);break e}Ne&&Ne(e,K,L),e==="focusout"&&(Ne=K._wrapperState)&&Ne.controlled&&K.type==="number"&&be(K,"number",K.value)}switch(Ne=L?or(L):window,e){case"focusin":(Ra(Ne)||Ne.contentEditable==="true")&&(rr=Ne,Si=L,Jr=null);break;case"focusout":Jr=Si=rr=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,Ba(X,n,Y);break;case"selectionchange":if(mf)break;case"keydown":case"keyup":Ba(X,n,Y)}var ke;if(wi)e:{switch(e){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else nr?_a(e,n)&&(Ce="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Ce="onCompositionStart");Ce&&(Ea&&n.locale!=="ko"&&(nr||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&nr&&(ke=Na()):(mn=Y,hi="value"in mn?mn.value:mn.textContent,nr=!0)),Ne=ql(L,Ce),0<Ne.length&&(Ce=new ba(Ce,e,null,n,Y),X.push({event:Ce,listeners:Ne}),ke?Ce.data=ke:(ke=Oa(n),ke!==null&&(Ce.data=ke)))),(ke=nf?rf(e,n):lf(e,n))&&(L=ql(L,"onBeforeInput"),0<L.length&&(Y=new ba("onBeforeInput","beforeinput",null,n,Y),X.push({event:Y,listeners:L}),Y.data=ke))}Ja(X,t)})}function el(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ql(e,t){for(var n=t+"Capture",r=[];e!==null;){var l=e,i=l.stateNode;l.tag===5&&i!==null&&(l=i,i=Rt(e,n),i!=null&&r.unshift(el(e,i,l)),i=Rt(e,t),i!=null&&r.push(el(e,i,l))),e=e.return}return r}function sr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Za(e,t,n,r,l){for(var i=t._reactName,c=[];n!==null&&n!==r;){var v=n,j=v.alternate,L=v.stateNode;if(j!==null&&j===r)break;v.tag===5&&L!==null&&(v=L,l?(j=Rt(n,i),j!=null&&c.unshift(el(n,j,v))):l||(j=Rt(n,i),j!=null&&c.push(el(n,j,v)))),n=n.return}c.length!==0&&e.push({event:t,listeners:c})}var xf=/\r\n?/g,wf=/\u0000|\uFFFD/g;function eu(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(wf,"")}function Jl(e,t,n){if(t=eu(t),eu(e)!==t&&n)throw Error(u(425))}function Xl(){}var Oi=null,Ri=null;function Ti(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Li=typeof setTimeout=="function"?setTimeout:void 0,jf=typeof clearTimeout=="function"?clearTimeout:void 0,tu=typeof Promise=="function"?Promise:void 0,Nf=typeof queueMicrotask=="function"?queueMicrotask:typeof tu<"u"?function(e){return tu.resolve(null).then(e).catch(kf)}:Li;function kf(e){setTimeout(function(){throw e})}function zi(e,t){var n=t,r=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(r===0){e.removeChild(l),Vr(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=l}while(n);Vr(t)}function yn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function nu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ir=Math.random().toString(36).slice(2),Ht="__reactFiber$"+ir,tl="__reactProps$"+ir,en="__reactContainer$"+ir,Ii="__reactEvents$"+ir,Sf="__reactListeners$"+ir,bf="__reactHandles$"+ir;function Mn(e){var t=e[Ht];if(t)return t;for(var n=e.parentNode;n;){if(t=n[en]||n[Ht]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=nu(e);e!==null;){if(n=e[Ht])return n;e=nu(e)}return t}e=n,n=e.parentNode}return null}function nl(e){return e=e[Ht]||e[en],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function or(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(u(33))}function Zl(e){return e[tl]||null}var Mi=[],ar=-1;function vn(e){return{current:e}}function Ae(e){0>ar||(e.current=Mi[ar],Mi[ar]=null,ar--)}function Fe(e,t){ar++,Mi[ar]=e.current,e.current=t}var xn={},it=vn(xn),pt=vn(!1),Fn=xn;function ur(e,t){var n=e.type.contextTypes;if(!n)return xn;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var l={},i;for(i in n)l[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function ht(e){return e=e.childContextTypes,e!=null}function es(){Ae(pt),Ae(it)}function ru(e,t,n){if(it.current!==xn)throw Error(u(168));Fe(it,t),Fe(pt,n)}function lu(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var l in r)if(!(l in t))throw Error(u(108,ge(e)||"Unknown",l));return k({},n,r)}function ts(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xn,Fn=it.current,Fe(it,e),Fe(pt,pt.current),!0}function su(e,t,n){var r=e.stateNode;if(!r)throw Error(u(169));n?(e=lu(e,t,Fn),r.__reactInternalMemoizedMergedChildContext=e,Ae(pt),Ae(it),Fe(it,e)):Ae(pt),Fe(pt,n)}var tn=null,ns=!1,Fi=!1;function iu(e){tn===null?tn=[e]:tn.push(e)}function Cf(e){ns=!0,iu(e)}function wn(){if(!Fi&&tn!==null){Fi=!0;var e=0,t=Ie;try{var n=tn;for(Ie=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}tn=null,ns=!1}catch(l){throw tn!==null&&(tn=tn.slice(e+1)),Ir(je,wn),l}finally{Ie=t,Fi=!1}}return null}var cr=[],dr=0,rs=null,ls=0,Ct=[],Et=0,$n=null,nn=1,rn="";function An(e,t){cr[dr++]=ls,cr[dr++]=rs,rs=e,ls=t}function ou(e,t,n){Ct[Et++]=nn,Ct[Et++]=rn,Ct[Et++]=$n,$n=e;var r=nn;e=rn;var l=32-Tt(r)-1;r&=~(1<<l),n+=1;var i=32-Tt(t)+l;if(30<i){var c=l-l%5;i=(r&(1<<c)-1).toString(32),r>>=c,l-=c,nn=1<<32-Tt(t)+l|n<<l|r,rn=i+e}else nn=1<<i|n<<l|r,rn=e}function $i(e){e.return!==null&&(An(e,1),ou(e,1,0))}function Ai(e){for(;e===rs;)rs=cr[--dr],cr[dr]=null,ls=cr[--dr],cr[dr]=null;for(;e===$n;)$n=Ct[--Et],Ct[Et]=null,rn=Ct[--Et],Ct[Et]=null,nn=Ct[--Et],Ct[Et]=null}var Nt=null,kt=null,He=!1,zt=null;function au(e,t){var n=Ot(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function uu(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Nt=e,kt=yn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Nt=e,kt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=$n!==null?{id:nn,overflow:rn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ot(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Nt=e,kt=null,!0):!1;default:return!1}}function Ui(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Bi(e){if(He){var t=kt;if(t){var n=t;if(!uu(e,t)){if(Ui(e))throw Error(u(418));t=yn(n.nextSibling);var r=Nt;t&&uu(e,t)?au(r,n):(e.flags=e.flags&-4097|2,He=!1,Nt=e)}}else{if(Ui(e))throw Error(u(418));e.flags=e.flags&-4097|2,He=!1,Nt=e}}}function cu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Nt=e}function ss(e){if(e!==Nt)return!1;if(!He)return cu(e),He=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ti(e.type,e.memoizedProps)),t&&(t=kt)){if(Ui(e))throw du(),Error(u(418));for(;t;)au(e,t),t=yn(t.nextSibling)}if(cu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(u(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){kt=yn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}kt=null}}else kt=Nt?yn(e.stateNode.nextSibling):null;return!0}function du(){for(var e=kt;e;)e=yn(e.nextSibling)}function fr(){kt=Nt=null,He=!1}function Hi(e){zt===null?zt=[e]:zt.push(e)}var Ef=R.ReactCurrentBatchConfig;function rl(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(u(309));var r=n.stateNode}if(!r)throw Error(u(147,e));var l=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(c){var v=l.refs;c===null?delete v[i]:v[i]=c},t._stringRef=i,t)}if(typeof e!="string")throw Error(u(284));if(!n._owner)throw Error(u(290,e))}return e}function is(e,t){throw e=Object.prototype.toString.call(t),Error(u(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fu(e){var t=e._init;return t(e._payload)}function pu(e){function t(P,S){if(e){var _=P.deletions;_===null?(P.deletions=[S],P.flags|=16):_.push(S)}}function n(P,S){if(!e)return null;for(;S!==null;)t(P,S),S=S.sibling;return null}function r(P,S){for(P=new Map;S!==null;)S.key!==null?P.set(S.key,S):P.set(S.index,S),S=S.sibling;return P}function l(P,S){return P=Pn(P,S),P.index=0,P.sibling=null,P}function i(P,S,_){return P.index=_,e?(_=P.alternate,_!==null?(_=_.index,_<S?(P.flags|=2,S):_):(P.flags|=2,S)):(P.flags|=1048576,S)}function c(P){return e&&P.alternate===null&&(P.flags|=2),P}function v(P,S,_,ne){return S===null||S.tag!==6?(S=zo(_,P.mode,ne),S.return=P,S):(S=l(S,_),S.return=P,S)}function j(P,S,_,ne){var we=_.type;return we===T?Y(P,S,_.props.children,ne,_.key):S!==null&&(S.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===le&&fu(we)===S.type)?(ne=l(S,_.props),ne.ref=rl(P,S,_),ne.return=P,ne):(ne=_s(_.type,_.key,_.props,null,P.mode,ne),ne.ref=rl(P,S,_),ne.return=P,ne)}function L(P,S,_,ne){return S===null||S.tag!==4||S.stateNode.containerInfo!==_.containerInfo||S.stateNode.implementation!==_.implementation?(S=Io(_,P.mode,ne),S.return=P,S):(S=l(S,_.children||[]),S.return=P,S)}function Y(P,S,_,ne,we){return S===null||S.tag!==7?(S=Qn(_,P.mode,ne,we),S.return=P,S):(S=l(S,_),S.return=P,S)}function X(P,S,_){if(typeof S=="string"&&S!==""||typeof S=="number")return S=zo(""+S,P.mode,_),S.return=P,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case G:return _=_s(S.type,S.key,S.props,null,P.mode,_),_.ref=rl(P,null,S),_.return=P,_;case ee:return S=Io(S,P.mode,_),S.return=P,S;case le:var ne=S._init;return X(P,ne(S._payload),_)}if(De(S)||F(S))return S=Qn(S,P.mode,_,null),S.return=P,S;is(P,S)}return null}function K(P,S,_,ne){var we=S!==null?S.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return we!==null?null:v(P,S,""+_,ne);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case G:return _.key===we?j(P,S,_,ne):null;case ee:return _.key===we?L(P,S,_,ne):null;case le:return we=_._init,K(P,S,we(_._payload),ne)}if(De(_)||F(_))return we!==null?null:Y(P,S,_,ne,null);is(P,_)}return null}function ue(P,S,_,ne,we){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return P=P.get(_)||null,v(S,P,""+ne,we);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case G:return P=P.get(ne.key===null?_:ne.key)||null,j(S,P,ne,we);case ee:return P=P.get(ne.key===null?_:ne.key)||null,L(S,P,ne,we);case le:var Ne=ne._init;return ue(P,S,_,Ne(ne._payload),we)}if(De(ne)||F(ne))return P=P.get(_)||null,Y(S,P,ne,we,null);is(S,ne)}return null}function me(P,S,_,ne){for(var we=null,Ne=null,ke=S,Ce=S=0,tt=null;ke!==null&&Ce<_.length;Ce++){ke.index>Ce?(tt=ke,ke=null):tt=ke.sibling;var Le=K(P,ke,_[Ce],ne);if(Le===null){ke===null&&(ke=tt);break}e&&ke&&Le.alternate===null&&t(P,ke),S=i(Le,S,Ce),Ne===null?we=Le:Ne.sibling=Le,Ne=Le,ke=tt}if(Ce===_.length)return n(P,ke),He&&An(P,Ce),we;if(ke===null){for(;Ce<_.length;Ce++)ke=X(P,_[Ce],ne),ke!==null&&(S=i(ke,S,Ce),Ne===null?we=ke:Ne.sibling=ke,Ne=ke);return He&&An(P,Ce),we}for(ke=r(P,ke);Ce<_.length;Ce++)tt=ue(ke,P,Ce,_[Ce],ne),tt!==null&&(e&&tt.alternate!==null&&ke.delete(tt.key===null?Ce:tt.key),S=i(tt,S,Ce),Ne===null?we=tt:Ne.sibling=tt,Ne=tt);return e&&ke.forEach(function(Dn){return t(P,Dn)}),He&&An(P,Ce),we}function xe(P,S,_,ne){var we=F(_);if(typeof we!="function")throw Error(u(150));if(_=we.call(_),_==null)throw Error(u(151));for(var Ne=we=null,ke=S,Ce=S=0,tt=null,Le=_.next();ke!==null&&!Le.done;Ce++,Le=_.next()){ke.index>Ce?(tt=ke,ke=null):tt=ke.sibling;var Dn=K(P,ke,Le.value,ne);if(Dn===null){ke===null&&(ke=tt);break}e&&ke&&Dn.alternate===null&&t(P,ke),S=i(Dn,S,Ce),Ne===null?we=Dn:Ne.sibling=Dn,Ne=Dn,ke=tt}if(Le.done)return n(P,ke),He&&An(P,Ce),we;if(ke===null){for(;!Le.done;Ce++,Le=_.next())Le=X(P,Le.value,ne),Le!==null&&(S=i(Le,S,Ce),Ne===null?we=Le:Ne.sibling=Le,Ne=Le);return He&&An(P,Ce),we}for(ke=r(P,ke);!Le.done;Ce++,Le=_.next())Le=ue(ke,P,Ce,Le.value,ne),Le!==null&&(e&&Le.alternate!==null&&ke.delete(Le.key===null?Ce:Le.key),S=i(Le,S,Ce),Ne===null?we=Le:Ne.sibling=Le,Ne=Le);return e&&ke.forEach(function(ip){return t(P,ip)}),He&&An(P,Ce),we}function Qe(P,S,_,ne){if(typeof _=="object"&&_!==null&&_.type===T&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case G:e:{for(var we=_.key,Ne=S;Ne!==null;){if(Ne.key===we){if(we=_.type,we===T){if(Ne.tag===7){n(P,Ne.sibling),S=l(Ne,_.props.children),S.return=P,P=S;break e}}else if(Ne.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===le&&fu(we)===Ne.type){n(P,Ne.sibling),S=l(Ne,_.props),S.ref=rl(P,Ne,_),S.return=P,P=S;break e}n(P,Ne);break}else t(P,Ne);Ne=Ne.sibling}_.type===T?(S=Qn(_.props.children,P.mode,ne,_.key),S.return=P,P=S):(ne=_s(_.type,_.key,_.props,null,P.mode,ne),ne.ref=rl(P,S,_),ne.return=P,P=ne)}return c(P);case ee:e:{for(Ne=_.key;S!==null;){if(S.key===Ne)if(S.tag===4&&S.stateNode.containerInfo===_.containerInfo&&S.stateNode.implementation===_.implementation){n(P,S.sibling),S=l(S,_.children||[]),S.return=P,P=S;break e}else{n(P,S);break}else t(P,S);S=S.sibling}S=Io(_,P.mode,ne),S.return=P,P=S}return c(P);case le:return Ne=_._init,Qe(P,S,Ne(_._payload),ne)}if(De(_))return me(P,S,_,ne);if(F(_))return xe(P,S,_,ne);is(P,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,S!==null&&S.tag===6?(n(P,S.sibling),S=l(S,_),S.return=P,P=S):(n(P,S),S=zo(_,P.mode,ne),S.return=P,P=S),c(P)):n(P,S)}return Qe}var pr=pu(!0),hu=pu(!1),os=vn(null),as=null,hr=null,Vi=null;function Wi(){Vi=hr=as=null}function Ki(e){var t=os.current;Ae(os),e._currentValue=t}function Gi(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function mr(e,t){as=e,Vi=hr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(mt=!0),e.firstContext=null)}function Pt(e){var t=e._currentValue;if(Vi!==e)if(e={context:e,memoizedValue:t,next:null},hr===null){if(as===null)throw Error(u(308));hr=e,as.dependencies={lanes:0,firstContext:e}}else hr=hr.next=e;return t}var Un=null;function Qi(e){Un===null?Un=[e]:Un.push(e)}function mu(e,t,n,r){var l=t.interleaved;return l===null?(n.next=n,Qi(t)):(n.next=l.next,l.next=n),t.interleaved=n,ln(e,r)}function ln(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var jn=!1;function Yi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gu(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function sn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Nn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(Te&2)!==0){var l=r.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),r.pending=t,ln(e,n)}return l=r.interleaved,l===null?(t.next=t,Qi(r)):(t.next=l.next,l.next=t),r.interleaved=t,ln(e,n)}function us(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ui(e,n)}}function yu(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var l=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var c={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?l=i=c:i=i.next=c,n=n.next}while(n!==null);i===null?l=i=t:i=i.next=t}else l=i=t;n={baseState:r.baseState,firstBaseUpdate:l,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function cs(e,t,n,r){var l=e.updateQueue;jn=!1;var i=l.firstBaseUpdate,c=l.lastBaseUpdate,v=l.shared.pending;if(v!==null){l.shared.pending=null;var j=v,L=j.next;j.next=null,c===null?i=L:c.next=L,c=j;var Y=e.alternate;Y!==null&&(Y=Y.updateQueue,v=Y.lastBaseUpdate,v!==c&&(v===null?Y.firstBaseUpdate=L:v.next=L,Y.lastBaseUpdate=j))}if(i!==null){var X=l.baseState;c=0,Y=L=j=null,v=i;do{var K=v.lane,ue=v.eventTime;if((r&K)===K){Y!==null&&(Y=Y.next={eventTime:ue,lane:0,tag:v.tag,payload:v.payload,callback:v.callback,next:null});e:{var me=e,xe=v;switch(K=t,ue=n,xe.tag){case 1:if(me=xe.payload,typeof me=="function"){X=me.call(ue,X,K);break e}X=me;break e;case 3:me.flags=me.flags&-65537|128;case 0:if(me=xe.payload,K=typeof me=="function"?me.call(ue,X,K):me,K==null)break e;X=k({},X,K);break e;case 2:jn=!0}}v.callback!==null&&v.lane!==0&&(e.flags|=64,K=l.effects,K===null?l.effects=[v]:K.push(v))}else ue={eventTime:ue,lane:K,tag:v.tag,payload:v.payload,callback:v.callback,next:null},Y===null?(L=Y=ue,j=X):Y=Y.next=ue,c|=K;if(v=v.next,v===null){if(v=l.shared.pending,v===null)break;K=v,v=K.next,K.next=null,l.lastBaseUpdate=K,l.shared.pending=null}}while(!0);if(Y===null&&(j=X),l.baseState=j,l.firstBaseUpdate=L,l.lastBaseUpdate=Y,t=l.shared.interleaved,t!==null){l=t;do c|=l.lane,l=l.next;while(l!==t)}else i===null&&(l.shared.lanes=0);Vn|=c,e.lanes=c,e.memoizedState=X}}function vu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],l=r.callback;if(l!==null){if(r.callback=null,r=n,typeof l!="function")throw Error(u(191,l));l.call(r)}}}var ll={},Vt=vn(ll),sl=vn(ll),il=vn(ll);function Bn(e){if(e===ll)throw Error(u(174));return e}function qi(e,t){switch(Fe(il,t),Fe(sl,e),Fe(Vt,ll),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Rn(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Rn(t,e)}Ae(Vt),Fe(Vt,t)}function gr(){Ae(Vt),Ae(sl),Ae(il)}function xu(e){Bn(il.current);var t=Bn(Vt.current),n=Rn(t,e.type);t!==n&&(Fe(sl,e),Fe(Vt,n))}function Ji(e){sl.current===e&&(Ae(Vt),Ae(sl))}var We=vn(0);function ds(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Xi=[];function Zi(){for(var e=0;e<Xi.length;e++)Xi[e]._workInProgressVersionPrimary=null;Xi.length=0}var fs=R.ReactCurrentDispatcher,eo=R.ReactCurrentBatchConfig,Hn=0,Ke=null,qe=null,Ze=null,ps=!1,ol=!1,al=0,Pf=0;function ot(){throw Error(u(321))}function to(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Lt(e[n],t[n]))return!1;return!0}function no(e,t,n,r,l,i){if(Hn=i,Ke=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fs.current=e===null||e.memoizedState===null?Rf:Tf,e=n(r,l),ol){i=0;do{if(ol=!1,al=0,25<=i)throw Error(u(301));i+=1,Ze=qe=null,t.updateQueue=null,fs.current=Lf,e=n(r,l)}while(ol)}if(fs.current=gs,t=qe!==null&&qe.next!==null,Hn=0,Ze=qe=Ke=null,ps=!1,t)throw Error(u(300));return e}function ro(){var e=al!==0;return al=0,e}function Wt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ze===null?Ke.memoizedState=Ze=e:Ze=Ze.next=e,Ze}function Dt(){if(qe===null){var e=Ke.alternate;e=e!==null?e.memoizedState:null}else e=qe.next;var t=Ze===null?Ke.memoizedState:Ze.next;if(t!==null)Ze=t,qe=e;else{if(e===null)throw Error(u(310));qe=e,e={memoizedState:qe.memoizedState,baseState:qe.baseState,baseQueue:qe.baseQueue,queue:qe.queue,next:null},Ze===null?Ke.memoizedState=Ze=e:Ze=Ze.next=e}return Ze}function ul(e,t){return typeof t=="function"?t(e):t}function lo(e){var t=Dt(),n=t.queue;if(n===null)throw Error(u(311));n.lastRenderedReducer=e;var r=qe,l=r.baseQueue,i=n.pending;if(i!==null){if(l!==null){var c=l.next;l.next=i.next,i.next=c}r.baseQueue=l=i,n.pending=null}if(l!==null){i=l.next,r=r.baseState;var v=c=null,j=null,L=i;do{var Y=L.lane;if((Hn&Y)===Y)j!==null&&(j=j.next={lane:0,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),r=L.hasEagerState?L.eagerState:e(r,L.action);else{var X={lane:Y,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null};j===null?(v=j=X,c=r):j=j.next=X,Ke.lanes|=Y,Vn|=Y}L=L.next}while(L!==null&&L!==i);j===null?c=r:j.next=v,Lt(r,t.memoizedState)||(mt=!0),t.memoizedState=r,t.baseState=c,t.baseQueue=j,n.lastRenderedState=r}if(e=n.interleaved,e!==null){l=e;do i=l.lane,Ke.lanes|=i,Vn|=i,l=l.next;while(l!==e)}else l===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function so(e){var t=Dt(),n=t.queue;if(n===null)throw Error(u(311));n.lastRenderedReducer=e;var r=n.dispatch,l=n.pending,i=t.memoizedState;if(l!==null){n.pending=null;var c=l=l.next;do i=e(i,c.action),c=c.next;while(c!==l);Lt(i,t.memoizedState)||(mt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function wu(){}function ju(e,t){var n=Ke,r=Dt(),l=t(),i=!Lt(r.memoizedState,l);if(i&&(r.memoizedState=l,mt=!0),r=r.queue,io(Su.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Ze!==null&&Ze.memoizedState.tag&1){if(n.flags|=2048,cl(9,ku.bind(null,n,r,l,t),void 0,null),et===null)throw Error(u(349));(Hn&30)!==0||Nu(n,t,l)}return l}function Nu(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function ku(e,t,n,r){t.value=n,t.getSnapshot=r,bu(t)&&Cu(e)}function Su(e,t,n){return n(function(){bu(t)&&Cu(e)})}function bu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Lt(e,n)}catch{return!0}}function Cu(e){var t=ln(e,1);t!==null&&$t(t,e,1,-1)}function Eu(e){var t=Wt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ul,lastRenderedState:e},t.queue=e,e=e.dispatch=Of.bind(null,Ke,e),[t.memoizedState,e]}function cl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Pu(){return Dt().memoizedState}function hs(e,t,n,r){var l=Wt();Ke.flags|=e,l.memoizedState=cl(1|t,n,void 0,r===void 0?null:r)}function ms(e,t,n,r){var l=Dt();r=r===void 0?null:r;var i=void 0;if(qe!==null){var c=qe.memoizedState;if(i=c.destroy,r!==null&&to(r,c.deps)){l.memoizedState=cl(t,n,i,r);return}}Ke.flags|=e,l.memoizedState=cl(1|t,n,i,r)}function Du(e,t){return hs(8390656,8,e,t)}function io(e,t){return ms(2048,8,e,t)}function _u(e,t){return ms(4,2,e,t)}function Ou(e,t){return ms(4,4,e,t)}function Ru(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Tu(e,t,n){return n=n!=null?n.concat([e]):null,ms(4,4,Ru.bind(null,t,e),n)}function oo(){}function Lu(e,t){var n=Dt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&to(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function zu(e,t){var n=Dt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&to(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Iu(e,t,n){return(Hn&21)===0?(e.baseState&&(e.baseState=!1,mt=!0),e.memoizedState=n):(Lt(n,t)||(n=fa(),Ke.lanes|=n,Vn|=n,e.baseState=!0),t)}function Df(e,t){var n=Ie;Ie=n!==0&&4>n?n:4,e(!0);var r=eo.transition;eo.transition={};try{e(!1),t()}finally{Ie=n,eo.transition=r}}function Mu(){return Dt().memoizedState}function _f(e,t,n){var r=Cn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Fu(e))$u(t,n);else if(n=mu(e,t,n,r),n!==null){var l=ft();$t(n,e,r,l),Au(n,t,r)}}function Of(e,t,n){var r=Cn(e),l={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Fu(e))$u(t,l);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var c=t.lastRenderedState,v=i(c,n);if(l.hasEagerState=!0,l.eagerState=v,Lt(v,c)){var j=t.interleaved;j===null?(l.next=l,Qi(t)):(l.next=j.next,j.next=l),t.interleaved=l;return}}catch{}n=mu(e,t,l,r),n!==null&&(l=ft(),$t(n,e,r,l),Au(n,t,r))}}function Fu(e){var t=e.alternate;return e===Ke||t!==null&&t===Ke}function $u(e,t){ol=ps=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Au(e,t,n){if((n&4194240)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ui(e,n)}}var gs={readContext:Pt,useCallback:ot,useContext:ot,useEffect:ot,useImperativeHandle:ot,useInsertionEffect:ot,useLayoutEffect:ot,useMemo:ot,useReducer:ot,useRef:ot,useState:ot,useDebugValue:ot,useDeferredValue:ot,useTransition:ot,useMutableSource:ot,useSyncExternalStore:ot,useId:ot,unstable_isNewReconciler:!1},Rf={readContext:Pt,useCallback:function(e,t){return Wt().memoizedState=[e,t===void 0?null:t],e},useContext:Pt,useEffect:Du,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,hs(4194308,4,Ru.bind(null,t,e),n)},useLayoutEffect:function(e,t){return hs(4194308,4,e,t)},useInsertionEffect:function(e,t){return hs(4,2,e,t)},useMemo:function(e,t){var n=Wt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Wt();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=_f.bind(null,Ke,e),[r.memoizedState,e]},useRef:function(e){var t=Wt();return e={current:e},t.memoizedState=e},useState:Eu,useDebugValue:oo,useDeferredValue:function(e){return Wt().memoizedState=e},useTransition:function(){var e=Eu(!1),t=e[0];return e=Df.bind(null,e[1]),Wt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ke,l=Wt();if(He){if(n===void 0)throw Error(u(407));n=n()}else{if(n=t(),et===null)throw Error(u(349));(Hn&30)!==0||Nu(r,t,n)}l.memoizedState=n;var i={value:n,getSnapshot:t};return l.queue=i,Du(Su.bind(null,r,i,e),[e]),r.flags|=2048,cl(9,ku.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Wt(),t=et.identifierPrefix;if(He){var n=rn,r=nn;n=(r&~(1<<32-Tt(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=al++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Pf++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Tf={readContext:Pt,useCallback:Lu,useContext:Pt,useEffect:io,useImperativeHandle:Tu,useInsertionEffect:_u,useLayoutEffect:Ou,useMemo:zu,useReducer:lo,useRef:Pu,useState:function(){return lo(ul)},useDebugValue:oo,useDeferredValue:function(e){var t=Dt();return Iu(t,qe.memoizedState,e)},useTransition:function(){var e=lo(ul)[0],t=Dt().memoizedState;return[e,t]},useMutableSource:wu,useSyncExternalStore:ju,useId:Mu,unstable_isNewReconciler:!1},Lf={readContext:Pt,useCallback:Lu,useContext:Pt,useEffect:io,useImperativeHandle:Tu,useInsertionEffect:_u,useLayoutEffect:Ou,useMemo:zu,useReducer:so,useRef:Pu,useState:function(){return so(ul)},useDebugValue:oo,useDeferredValue:function(e){var t=Dt();return qe===null?t.memoizedState=e:Iu(t,qe.memoizedState,e)},useTransition:function(){var e=so(ul)[0],t=Dt().memoizedState;return[e,t]},useMutableSource:wu,useSyncExternalStore:ju,useId:Mu,unstable_isNewReconciler:!1};function It(e,t){if(e&&e.defaultProps){t=k({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ao(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:k({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ys={isMounted:function(e){return(e=e._reactInternals)?Zt(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ft(),l=Cn(e),i=sn(r,l);i.payload=t,n!=null&&(i.callback=n),t=Nn(e,i,l),t!==null&&($t(t,e,l,r),us(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ft(),l=Cn(e),i=sn(r,l);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Nn(e,i,l),t!==null&&($t(t,e,l,r),us(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ft(),r=Cn(e),l=sn(n,r);l.tag=2,t!=null&&(l.callback=t),t=Nn(e,l,r),t!==null&&($t(t,e,r,n),us(t,e,r))}};function Uu(e,t,n,r,l,i,c){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,c):t.prototype&&t.prototype.isPureReactComponent?!qr(n,r)||!qr(l,i):!0}function Bu(e,t,n){var r=!1,l=xn,i=t.contextType;return typeof i=="object"&&i!==null?i=Pt(i):(l=ht(t)?Fn:it.current,r=t.contextTypes,i=(r=r!=null)?ur(e,l):xn),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ys,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=i),t}function Hu(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ys.enqueueReplaceState(t,t.state,null)}function uo(e,t,n,r){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs={},Yi(e);var i=t.contextType;typeof i=="object"&&i!==null?l.context=Pt(i):(i=ht(t)?Fn:it.current,l.context=ur(e,i)),l.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(ao(e,t,i,n),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&ys.enqueueReplaceState(l,l.state,null),cs(e,n,l,r),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function yr(e,t){try{var n="",r=t;do n+=re(r),r=r.return;while(r);var l=n}catch(i){l=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:l,digest:null}}function co(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function fo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var zf=typeof WeakMap=="function"?WeakMap:Map;function Vu(e,t,n){n=sn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ss||(Ss=!0,Eo=r),fo(e,t)},n}function Wu(e,t,n){n=sn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var l=t.value;n.payload=function(){return r(l)},n.callback=function(){fo(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){fo(e,t),typeof r!="function"&&(Sn===null?Sn=new Set([this]):Sn.add(this));var c=t.stack;this.componentDidCatch(t.value,{componentStack:c!==null?c:""})}),n}function Ku(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new zf;var l=new Set;r.set(t,l)}else l=r.get(t),l===void 0&&(l=new Set,r.set(t,l));l.has(n)||(l.add(n),e=Yf.bind(null,e,t,n),t.then(e,e))}function Gu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Qu(e,t,n,r,l){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=sn(-1,1),t.tag=2,Nn(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=l,e)}var If=R.ReactCurrentOwner,mt=!1;function dt(e,t,n,r){t.child=e===null?hu(t,null,n,r):pr(t,e.child,n,r)}function Yu(e,t,n,r,l){n=n.render;var i=t.ref;return mr(t,l),r=no(e,t,n,r,i,l),n=ro(),e!==null&&!mt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,on(e,t,l)):(He&&n&&$i(t),t.flags|=1,dt(e,t,r,l),t.child)}function qu(e,t,n,r,l){if(e===null){var i=n.type;return typeof i=="function"&&!Lo(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Ju(e,t,i,r,l)):(e=_s(n.type,null,r,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,(e.lanes&l)===0){var c=i.memoizedProps;if(n=n.compare,n=n!==null?n:qr,n(c,r)&&e.ref===t.ref)return on(e,t,l)}return t.flags|=1,e=Pn(i,r),e.ref=t.ref,e.return=t,t.child=e}function Ju(e,t,n,r,l){if(e!==null){var i=e.memoizedProps;if(qr(i,r)&&e.ref===t.ref)if(mt=!1,t.pendingProps=r=i,(e.lanes&l)!==0)(e.flags&131072)!==0&&(mt=!0);else return t.lanes=e.lanes,on(e,t,l)}return po(e,t,n,r,l)}function Xu(e,t,n){var r=t.pendingProps,l=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(xr,St),St|=n;else{if((n&1073741824)===0)return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Fe(xr,St),St|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Fe(xr,St),St|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Fe(xr,St),St|=r;return dt(e,t,l,n),t.child}function Zu(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function po(e,t,n,r,l){var i=ht(n)?Fn:it.current;return i=ur(t,i),mr(t,l),n=no(e,t,n,r,i,l),r=ro(),e!==null&&!mt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,on(e,t,l)):(He&&r&&$i(t),t.flags|=1,dt(e,t,n,l),t.child)}function ec(e,t,n,r,l){if(ht(n)){var i=!0;ts(t)}else i=!1;if(mr(t,l),t.stateNode===null)xs(e,t),Bu(t,n,r),uo(t,n,r,l),r=!0;else if(e===null){var c=t.stateNode,v=t.memoizedProps;c.props=v;var j=c.context,L=n.contextType;typeof L=="object"&&L!==null?L=Pt(L):(L=ht(n)?Fn:it.current,L=ur(t,L));var Y=n.getDerivedStateFromProps,X=typeof Y=="function"||typeof c.getSnapshotBeforeUpdate=="function";X||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(v!==r||j!==L)&&Hu(t,c,r,L),jn=!1;var K=t.memoizedState;c.state=K,cs(t,r,c,l),j=t.memoizedState,v!==r||K!==j||pt.current||jn?(typeof Y=="function"&&(ao(t,n,Y,r),j=t.memoizedState),(v=jn||Uu(t,n,v,r,K,j,L))?(X||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=j),c.props=r,c.state=j,c.context=L,r=v):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{c=t.stateNode,gu(e,t),v=t.memoizedProps,L=t.type===t.elementType?v:It(t.type,v),c.props=L,X=t.pendingProps,K=c.context,j=n.contextType,typeof j=="object"&&j!==null?j=Pt(j):(j=ht(n)?Fn:it.current,j=ur(t,j));var ue=n.getDerivedStateFromProps;(Y=typeof ue=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(v!==X||K!==j)&&Hu(t,c,r,j),jn=!1,K=t.memoizedState,c.state=K,cs(t,r,c,l);var me=t.memoizedState;v!==X||K!==me||pt.current||jn?(typeof ue=="function"&&(ao(t,n,ue,r),me=t.memoizedState),(L=jn||Uu(t,n,L,r,K,me,j)||!1)?(Y||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(r,me,j),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(r,me,j)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||v===e.memoizedProps&&K===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&K===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=me),c.props=r,c.state=me,c.context=j,r=L):(typeof c.componentDidUpdate!="function"||v===e.memoizedProps&&K===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&K===e.memoizedState||(t.flags|=1024),r=!1)}return ho(e,t,n,r,i,l)}function ho(e,t,n,r,l,i){Zu(e,t);var c=(t.flags&128)!==0;if(!r&&!c)return l&&su(t,n,!1),on(e,t,i);r=t.stateNode,If.current=t;var v=c&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&c?(t.child=pr(t,e.child,null,i),t.child=pr(t,null,v,i)):dt(e,t,v,i),t.memoizedState=r.state,l&&su(t,n,!0),t.child}function tc(e){var t=e.stateNode;t.pendingContext?ru(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ru(e,t.context,!1),qi(e,t.containerInfo)}function nc(e,t,n,r,l){return fr(),Hi(l),t.flags|=256,dt(e,t,n,r),t.child}var mo={dehydrated:null,treeContext:null,retryLane:0};function go(e){return{baseLanes:e,cachePool:null,transitions:null}}function rc(e,t,n){var r=t.pendingProps,l=We.current,i=!1,c=(t.flags&128)!==0,v;if((v=c)||(v=e!==null&&e.memoizedState===null?!1:(l&2)!==0),v?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),Fe(We,l&1),e===null)return Bi(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(c=r.children,e=r.fallback,i?(r=t.mode,i=t.child,c={mode:"hidden",children:c},(r&1)===0&&i!==null?(i.childLanes=0,i.pendingProps=c):i=Os(c,r,0,null),e=Qn(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=go(n),t.memoizedState=mo,e):yo(t,c));if(l=e.memoizedState,l!==null&&(v=l.dehydrated,v!==null))return Mf(e,t,c,r,v,l,n);if(i){i=r.fallback,c=t.mode,l=e.child,v=l.sibling;var j={mode:"hidden",children:r.children};return(c&1)===0&&t.child!==l?(r=t.child,r.childLanes=0,r.pendingProps=j,t.deletions=null):(r=Pn(l,j),r.subtreeFlags=l.subtreeFlags&14680064),v!==null?i=Pn(v,i):(i=Qn(i,c,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,c=e.child.memoizedState,c=c===null?go(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},i.memoizedState=c,i.childLanes=e.childLanes&~n,t.memoizedState=mo,r}return i=e.child,e=i.sibling,r=Pn(i,{mode:"visible",children:r.children}),(t.mode&1)===0&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function yo(e,t){return t=Os({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function vs(e,t,n,r){return r!==null&&Hi(r),pr(t,e.child,null,n),e=yo(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Mf(e,t,n,r,l,i,c){if(n)return t.flags&256?(t.flags&=-257,r=co(Error(u(422))),vs(e,t,c,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,l=t.mode,r=Os({mode:"visible",children:r.children},l,0,null),i=Qn(i,l,c,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,(t.mode&1)!==0&&pr(t,e.child,null,c),t.child.memoizedState=go(c),t.memoizedState=mo,i);if((t.mode&1)===0)return vs(e,t,c,null);if(l.data==="$!"){if(r=l.nextSibling&&l.nextSibling.dataset,r)var v=r.dgst;return r=v,i=Error(u(419)),r=co(i,r,void 0),vs(e,t,c,r)}if(v=(c&e.childLanes)!==0,mt||v){if(r=et,r!==null){switch(c&-c){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=(l&(r.suspendedLanes|c))!==0?0:l,l!==0&&l!==i.retryLane&&(i.retryLane=l,ln(e,l),$t(r,e,l,-1))}return To(),r=co(Error(u(421))),vs(e,t,c,r)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=qf.bind(null,e),l._reactRetry=t,null):(e=i.treeContext,kt=yn(l.nextSibling),Nt=t,He=!0,zt=null,e!==null&&(Ct[Et++]=nn,Ct[Et++]=rn,Ct[Et++]=$n,nn=e.id,rn=e.overflow,$n=t),t=yo(t,r.children),t.flags|=4096,t)}function lc(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Gi(e.return,t,n)}function vo(e,t,n,r,l){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:l}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=l)}function sc(e,t,n){var r=t.pendingProps,l=r.revealOrder,i=r.tail;if(dt(e,t,r.children,n),r=We.current,(r&2)!==0)r=r&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&lc(e,n,t);else if(e.tag===19)lc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Fe(We,r),(t.mode&1)===0)t.memoizedState=null;else switch(l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&ds(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),vo(t,!1,l,n,i);break;case"backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&ds(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}vo(t,!0,n,null,i);break;case"together":vo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function xs(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function on(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Vn|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(u(153));if(t.child!==null){for(e=t.child,n=Pn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Pn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Ff(e,t,n){switch(t.tag){case 3:tc(t),fr();break;case 5:xu(t);break;case 1:ht(t.type)&&ts(t);break;case 4:qi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,l=t.memoizedProps.value;Fe(os,r._currentValue),r._currentValue=l;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Fe(We,We.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?rc(e,t,n):(Fe(We,We.current&1),e=on(e,t,n),e!==null?e.sibling:null);Fe(We,We.current&1);break;case 19:if(r=(n&t.childLanes)!==0,(e.flags&128)!==0){if(r)return sc(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Fe(We,We.current),r)break;return null;case 22:case 23:return t.lanes=0,Xu(e,t,n)}return on(e,t,n)}var ic,xo,oc,ac;ic=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},xo=function(){},oc=function(e,t,n,r){var l=e.memoizedProps;if(l!==r){e=t.stateNode,Bn(Vt.current);var i=null;switch(n){case"input":l=Z(e,l),r=Z(e,r),i=[];break;case"select":l=k({},l,{value:void 0}),r=k({},r,{value:void 0}),i=[];break;case"textarea":l=st(e,l),r=st(e,r),i=[];break;default:typeof l.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Xl)}Dr(n,r);var c;n=null;for(L in l)if(!r.hasOwnProperty(L)&&l.hasOwnProperty(L)&&l[L]!=null)if(L==="style"){var v=l[L];for(c in v)v.hasOwnProperty(c)&&(n||(n={}),n[c]="")}else L!=="dangerouslySetInnerHTML"&&L!=="children"&&L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&L!=="autoFocus"&&(f.hasOwnProperty(L)?i||(i=[]):(i=i||[]).push(L,null));for(L in r){var j=r[L];if(v=l?.[L],r.hasOwnProperty(L)&&j!==v&&(j!=null||v!=null))if(L==="style")if(v){for(c in v)!v.hasOwnProperty(c)||j&&j.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in j)j.hasOwnProperty(c)&&v[c]!==j[c]&&(n||(n={}),n[c]=j[c])}else n||(i||(i=[]),i.push(L,n)),n=j;else L==="dangerouslySetInnerHTML"?(j=j?j.__html:void 0,v=v?v.__html:void 0,j!=null&&v!==j&&(i=i||[]).push(L,j)):L==="children"?typeof j!="string"&&typeof j!="number"||(i=i||[]).push(L,""+j):L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&(f.hasOwnProperty(L)?(j!=null&&L==="onScroll"&&$e("scroll",e),i||v===j||(i=[])):(i=i||[]).push(L,j))}n&&(i=i||[]).push("style",n);var L=i;(t.updateQueue=L)&&(t.flags|=4)}},ac=function(e,t,n,r){n!==r&&(t.flags|=4)};function dl(e,t){if(!He)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function at(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags&14680064,r|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags,r|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function $f(e,t,n){var r=t.pendingProps;switch(Ai(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return at(t),null;case 1:return ht(t.type)&&es(),at(t),null;case 3:return r=t.stateNode,gr(),Ae(pt),Ae(it),Zi(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ss(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,zt!==null&&(_o(zt),zt=null))),xo(e,t),at(t),null;case 5:Ji(t);var l=Bn(il.current);if(n=t.type,e!==null&&t.stateNode!=null)oc(e,t,n,r,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(u(166));return at(t),null}if(e=Bn(Vt.current),ss(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Ht]=t,r[tl]=i,e=(t.mode&1)!==0,n){case"dialog":$e("cancel",r),$e("close",r);break;case"iframe":case"object":case"embed":$e("load",r);break;case"video":case"audio":for(l=0;l<Xr.length;l++)$e(Xr[l],r);break;case"source":$e("error",r);break;case"img":case"image":case"link":$e("error",r),$e("load",r);break;case"details":$e("toggle",r);break;case"input":ye(r,i),$e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},$e("invalid",r);break;case"textarea":ct(r,i),$e("invalid",r)}Dr(n,i),l=null;for(var c in i)if(i.hasOwnProperty(c)){var v=i[c];c==="children"?typeof v=="string"?r.textContent!==v&&(i.suppressHydrationWarning!==!0&&Jl(r.textContent,v,e),l=["children",v]):typeof v=="number"&&r.textContent!==""+v&&(i.suppressHydrationWarning!==!0&&Jl(r.textContent,v,e),l=["children",""+v]):f.hasOwnProperty(c)&&v!=null&&c==="onScroll"&&$e("scroll",r)}switch(n){case"input":Q(r),Pe(r,i,!0);break;case"textarea":Q(r),Ue(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Xl)}r=l,t.updateQueue=r,r!==null&&(t.flags|=4)}else{c=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Yt(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),n==="select"&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[Ht]=t,e[tl]=r,ic(e,t,!1,!1),t.stateNode=e;e:{switch(c=_r(n,r),n){case"dialog":$e("cancel",e),$e("close",e),l=r;break;case"iframe":case"object":case"embed":$e("load",e),l=r;break;case"video":case"audio":for(l=0;l<Xr.length;l++)$e(Xr[l],e);l=r;break;case"source":$e("error",e),l=r;break;case"img":case"image":case"link":$e("error",e),$e("load",e),l=r;break;case"details":$e("toggle",e),l=r;break;case"input":ye(e,r),l=Z(e,r),$e("invalid",e);break;case"option":l=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=k({},r,{value:void 0}),$e("invalid",e);break;case"textarea":ct(e,r),l=st(e,r),$e("invalid",e);break;default:l=r}Dr(n,l),v=l;for(i in v)if(v.hasOwnProperty(i)){var j=v[i];i==="style"?Nl(e,j):i==="dangerouslySetInnerHTML"?(j=j?j.__html:void 0,j!=null&&wl(e,j)):i==="children"?typeof j=="string"?(n!=="textarea"||j!=="")&&Tn(e,j):typeof j=="number"&&Tn(e,""+j):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(f.hasOwnProperty(i)?j!=null&&i==="onScroll"&&$e("scroll",e):j!=null&&se(e,i,j,c))}switch(n){case"input":Q(e),Pe(e,r,!1);break;case"textarea":Q(e),Ue(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Se(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Re(e,!!r.multiple,i,!1):r.defaultValue!=null&&Re(e,!!r.multiple,r.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=Xl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return at(t),null;case 6:if(e&&t.stateNode!=null)ac(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(u(166));if(n=Bn(il.current),Bn(Vt.current),ss(t)){if(r=t.stateNode,n=t.memoizedProps,r[Ht]=t,(i=r.nodeValue!==n)&&(e=Nt,e!==null))switch(e.tag){case 3:Jl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Jl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ht]=t,t.stateNode=r}return at(t),null;case 13:if(Ae(We),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(He&&kt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)du(),fr(),t.flags|=98560,i=!1;else if(i=ss(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(u(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(u(317));i[Ht]=t}else fr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;at(t),i=!1}else zt!==null&&(_o(zt),zt=null),i=!0;if(!i)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(We.current&1)!==0?Je===0&&(Je=3):To())),t.updateQueue!==null&&(t.flags|=4),at(t),null);case 4:return gr(),xo(e,t),e===null&&Zr(t.stateNode.containerInfo),at(t),null;case 10:return Ki(t.type._context),at(t),null;case 17:return ht(t.type)&&es(),at(t),null;case 19:if(Ae(We),i=t.memoizedState,i===null)return at(t),null;if(r=(t.flags&128)!==0,c=i.rendering,c===null)if(r)dl(i,!1);else{if(Je!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(c=ds(e),c!==null){for(t.flags|=128,dl(i,!1),r=c.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,c=i.alternate,c===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,e=c.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Fe(We,We.current&1|2),t.child}e=e.sibling}i.tail!==null&&Be()>wr&&(t.flags|=128,r=!0,dl(i,!1),t.lanes=4194304)}else{if(!r)if(e=ds(c),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),dl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!c.alternate&&!He)return at(t),null}else 2*Be()-i.renderingStartTime>wr&&n!==1073741824&&(t.flags|=128,r=!0,dl(i,!1),t.lanes=4194304);i.isBackwards?(c.sibling=t.child,t.child=c):(n=i.last,n!==null?n.sibling=c:t.child=c,i.last=c)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Be(),t.sibling=null,n=We.current,Fe(We,r?n&1|2:n&1),t):(at(t),null);case 22:case 23:return Ro(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&(t.mode&1)!==0?(St&1073741824)!==0&&(at(t),t.subtreeFlags&6&&(t.flags|=8192)):at(t),null;case 24:return null;case 25:return null}throw Error(u(156,t.tag))}function Af(e,t){switch(Ai(t),t.tag){case 1:return ht(t.type)&&es(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return gr(),Ae(pt),Ae(it),Zi(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Ji(t),null;case 13:if(Ae(We),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(u(340));fr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ae(We),null;case 4:return gr(),null;case 10:return Ki(t.type._context),null;case 22:case 23:return Ro(),null;case 24:return null;default:return null}}var ws=!1,ut=!1,Uf=typeof WeakSet=="function"?WeakSet:Set,pe=null;function vr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ge(e,t,r)}else n.current=null}function wo(e,t,n){try{n()}catch(r){Ge(e,t,r)}}var uc=!1;function Bf(e,t){if(Oi=Al,e=Ua(),ki(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var l=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var c=0,v=-1,j=-1,L=0,Y=0,X=e,K=null;t:for(;;){for(var ue;X!==n||l!==0&&X.nodeType!==3||(v=c+l),X!==i||r!==0&&X.nodeType!==3||(j=c+r),X.nodeType===3&&(c+=X.nodeValue.length),(ue=X.firstChild)!==null;)K=X,X=ue;for(;;){if(X===e)break t;if(K===n&&++L===l&&(v=c),K===i&&++Y===r&&(j=c),(ue=X.nextSibling)!==null)break;X=K,K=X.parentNode}X=ue}n=v===-1||j===-1?null:{start:v,end:j}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ri={focusedElem:e,selectionRange:n},Al=!1,pe=t;pe!==null;)if(t=pe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,pe=e;else for(;pe!==null;){t=pe;try{var me=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(me!==null){var xe=me.memoizedProps,Qe=me.memoizedState,P=t.stateNode,S=P.getSnapshotBeforeUpdate(t.elementType===t.type?xe:It(t.type,xe),Qe);P.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(u(163))}}catch(ne){Ge(t,t.return,ne)}if(e=t.sibling,e!==null){e.return=t.return,pe=e;break}pe=t.return}return me=uc,uc=!1,me}function fl(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&e)===e){var i=l.destroy;l.destroy=void 0,i!==void 0&&wo(t,n,i)}l=l.next}while(l!==r)}}function js(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function jo(e){var t=e.ref;if(t!==null){var n=e.stateNode;e.tag,e=n,typeof t=="function"?t(e):t.current=e}}function cc(e){var t=e.alternate;t!==null&&(e.alternate=null,cc(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ht],delete t[tl],delete t[Ii],delete t[Sf],delete t[bf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dc(e){return e.tag===5||e.tag===3||e.tag===4}function fc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function No(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Xl));else if(r!==4&&(e=e.child,e!==null))for(No(e,t,n),e=e.sibling;e!==null;)No(e,t,n),e=e.sibling}function ko(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(ko(e,t,n),e=e.sibling;e!==null;)ko(e,t,n),e=e.sibling}var nt=null,Mt=!1;function kn(e,t,n){for(n=n.child;n!==null;)pc(e,t,n),n=n.sibling}function pc(e,t,n){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(Ll,n)}catch{}switch(n.tag){case 5:ut||vr(n,t);case 6:var r=nt,l=Mt;nt=null,kn(e,t,n),nt=r,Mt=l,nt!==null&&(Mt?(e=nt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):nt.removeChild(n.stateNode));break;case 18:nt!==null&&(Mt?(e=nt,n=n.stateNode,e.nodeType===8?zi(e.parentNode,n):e.nodeType===1&&zi(e,n),Vr(e)):zi(nt,n.stateNode));break;case 4:r=nt,l=Mt,nt=n.stateNode.containerInfo,Mt=!0,kn(e,t,n),nt=r,Mt=l;break;case 0:case 11:case 14:case 15:if(!ut&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){l=r=r.next;do{var i=l,c=i.destroy;i=i.tag,c!==void 0&&((i&2)!==0||(i&4)!==0)&&wo(n,t,c),l=l.next}while(l!==r)}kn(e,t,n);break;case 1:if(!ut&&(vr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(v){Ge(n,t,v)}kn(e,t,n);break;case 21:kn(e,t,n);break;case 22:n.mode&1?(ut=(r=ut)||n.memoizedState!==null,kn(e,t,n),ut=r):kn(e,t,n);break;default:kn(e,t,n)}}function hc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Uf),t.forEach(function(r){var l=Jf.bind(null,e,r);n.has(r)||(n.add(r),r.then(l,l))})}}function Ft(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var l=n[r];try{var i=e,c=t,v=c;e:for(;v!==null;){switch(v.tag){case 5:nt=v.stateNode,Mt=!1;break e;case 3:nt=v.stateNode.containerInfo,Mt=!0;break e;case 4:nt=v.stateNode.containerInfo,Mt=!0;break e}v=v.return}if(nt===null)throw Error(u(160));pc(i,c,l),nt=null,Mt=!1;var j=l.alternate;j!==null&&(j.return=null),l.return=null}catch(L){Ge(l,t,L)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)mc(t,e),t=t.sibling}function mc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ft(t,e),Kt(e),r&4){try{fl(3,e,e.return),js(3,e)}catch(xe){Ge(e,e.return,xe)}try{fl(5,e,e.return)}catch(xe){Ge(e,e.return,xe)}}break;case 1:Ft(t,e),Kt(e),r&512&&n!==null&&vr(n,n.return);break;case 5:if(Ft(t,e),Kt(e),r&512&&n!==null&&vr(n,n.return),e.flags&32){var l=e.stateNode;try{Tn(l,"")}catch(xe){Ge(e,e.return,xe)}}if(r&4&&(l=e.stateNode,l!=null)){var i=e.memoizedProps,c=n!==null?n.memoizedProps:i,v=e.type,j=e.updateQueue;if(e.updateQueue=null,j!==null)try{v==="input"&&i.type==="radio"&&i.name!=null&&ve(l,i),_r(v,c);var L=_r(v,i);for(c=0;c<j.length;c+=2){var Y=j[c],X=j[c+1];Y==="style"?Nl(l,X):Y==="dangerouslySetInnerHTML"?wl(l,X):Y==="children"?Tn(l,X):se(l,Y,X,L)}switch(v){case"input":Ee(l,i);break;case"textarea":Xe(l,i);break;case"select":var K=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!i.multiple;var ue=i.value;ue!=null?Re(l,!!i.multiple,ue,!1):K!==!!i.multiple&&(i.defaultValue!=null?Re(l,!!i.multiple,i.defaultValue,!0):Re(l,!!i.multiple,i.multiple?[]:"",!1))}l[tl]=i}catch(xe){Ge(e,e.return,xe)}}break;case 6:if(Ft(t,e),Kt(e),r&4){if(e.stateNode===null)throw Error(u(162));l=e.stateNode,i=e.memoizedProps;try{l.nodeValue=i}catch(xe){Ge(e,e.return,xe)}}break;case 3:if(Ft(t,e),Kt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Vr(t.containerInfo)}catch(xe){Ge(e,e.return,xe)}break;case 4:Ft(t,e),Kt(e);break;case 13:Ft(t,e),Kt(e),l=e.child,l.flags&8192&&(i=l.memoizedState!==null,l.stateNode.isHidden=i,!i||l.alternate!==null&&l.alternate.memoizedState!==null||(Co=Be())),r&4&&hc(e);break;case 22:if(Y=n!==null&&n.memoizedState!==null,e.mode&1?(ut=(L=ut)||Y,Ft(t,e),ut=L):Ft(t,e),Kt(e),r&8192){if(L=e.memoizedState!==null,(e.stateNode.isHidden=L)&&!Y&&(e.mode&1)!==0)for(pe=e,Y=e.child;Y!==null;){for(X=pe=Y;pe!==null;){switch(K=pe,ue=K.child,K.tag){case 0:case 11:case 14:case 15:fl(4,K,K.return);break;case 1:vr(K,K.return);var me=K.stateNode;if(typeof me.componentWillUnmount=="function"){r=K,n=K.return;try{t=r,me.props=t.memoizedProps,me.state=t.memoizedState,me.componentWillUnmount()}catch(xe){Ge(r,n,xe)}}break;case 5:vr(K,K.return);break;case 22:if(K.memoizedState!==null){vc(X);continue}}ue!==null?(ue.return=K,pe=ue):vc(X)}Y=Y.sibling}e:for(Y=null,X=e;;){if(X.tag===5){if(Y===null){Y=X;try{l=X.stateNode,L?(i=l.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(v=X.stateNode,j=X.memoizedProps.style,c=j!=null&&j.hasOwnProperty("display")?j.display:null,v.style.display=jl("display",c))}catch(xe){Ge(e,e.return,xe)}}}else if(X.tag===6){if(Y===null)try{X.stateNode.nodeValue=L?"":X.memoizedProps}catch(xe){Ge(e,e.return,xe)}}else if((X.tag!==22&&X.tag!==23||X.memoizedState===null||X===e)&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===e)break e;for(;X.sibling===null;){if(X.return===null||X.return===e)break e;Y===X&&(Y=null),X=X.return}Y===X&&(Y=null),X.sibling.return=X.return,X=X.sibling}}break;case 19:Ft(t,e),Kt(e),r&4&&hc(e);break;case 21:break;default:Ft(t,e),Kt(e)}}function Kt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(dc(n)){var r=n;break e}n=n.return}throw Error(u(160))}switch(r.tag){case 5:var l=r.stateNode;r.flags&32&&(Tn(l,""),r.flags&=-33);var i=fc(e);ko(e,i,l);break;case 3:case 4:var c=r.stateNode.containerInfo,v=fc(e);No(e,v,c);break;default:throw Error(u(161))}}catch(j){Ge(e,e.return,j)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Hf(e,t,n){pe=e,gc(e)}function gc(e,t,n){for(var r=(e.mode&1)!==0;pe!==null;){var l=pe,i=l.child;if(l.tag===22&&r){var c=l.memoizedState!==null||ws;if(!c){var v=l.alternate,j=v!==null&&v.memoizedState!==null||ut;v=ws;var L=ut;if(ws=c,(ut=j)&&!L)for(pe=l;pe!==null;)c=pe,j=c.child,c.tag===22&&c.memoizedState!==null?xc(l):j!==null?(j.return=c,pe=j):xc(l);for(;i!==null;)pe=i,gc(i),i=i.sibling;pe=l,ws=v,ut=L}yc(e)}else(l.subtreeFlags&8772)!==0&&i!==null?(i.return=l,pe=i):yc(e)}}function yc(e){for(;pe!==null;){var t=pe;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:ut||js(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!ut)if(n===null)r.componentDidMount();else{var l=t.elementType===t.type?n.memoizedProps:It(t.type,n.memoizedProps);r.componentDidUpdate(l,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&vu(t,i,r);break;case 3:var c=t.updateQueue;if(c!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}vu(t,c,n)}break;case 5:var v=t.stateNode;if(n===null&&t.flags&4){n=v;var j=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":j.autoFocus&&n.focus();break;case"img":j.src&&(n.src=j.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var L=t.alternate;if(L!==null){var Y=L.memoizedState;if(Y!==null){var X=Y.dehydrated;X!==null&&Vr(X)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(u(163))}ut||t.flags&512&&jo(t)}catch(K){Ge(t,t.return,K)}}if(t===e){pe=null;break}if(n=t.sibling,n!==null){n.return=t.return,pe=n;break}pe=t.return}}function vc(e){for(;pe!==null;){var t=pe;if(t===e){pe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,pe=n;break}pe=t.return}}function xc(e){for(;pe!==null;){var t=pe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{js(4,t)}catch(j){Ge(t,n,j)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var l=t.return;try{r.componentDidMount()}catch(j){Ge(t,l,j)}}var i=t.return;try{jo(t)}catch(j){Ge(t,i,j)}break;case 5:var c=t.return;try{jo(t)}catch(j){Ge(t,c,j)}}}catch(j){Ge(t,t.return,j)}if(t===e){pe=null;break}var v=t.sibling;if(v!==null){v.return=t.return,pe=v;break}pe=t.return}}var Vf=Math.ceil,Ns=R.ReactCurrentDispatcher,So=R.ReactCurrentOwner,_t=R.ReactCurrentBatchConfig,Te=0,et=null,Ye=null,rt=0,St=0,xr=vn(0),Je=0,pl=null,Vn=0,ks=0,bo=0,hl=null,gt=null,Co=0,wr=1/0,an=null,Ss=!1,Eo=null,Sn=null,bs=!1,bn=null,Cs=0,ml=0,Po=null,Es=-1,Ps=0;function ft(){return(Te&6)!==0?Be():Es!==-1?Es:Es=Be()}function Cn(e){return(e.mode&1)===0?1:(Te&2)!==0&&rt!==0?rt&-rt:Ef.transition!==null?(Ps===0&&(Ps=fa()),Ps):(e=Ie,e!==0||(e=window.event,e=e===void 0?16:ja(e.type)),e)}function $t(e,t,n,r){if(50<ml)throw ml=0,Po=null,Error(u(185));$r(e,n,r),((Te&2)===0||e!==et)&&(e===et&&((Te&2)===0&&(ks|=n),Je===4&&En(e,rt)),yt(e,r),n===1&&Te===0&&(t.mode&1)===0&&(wr=Be()+500,ns&&wn()))}function yt(e,t){var n=e.callbackNode;Cd(e,t);var r=Ml(e,e===et?rt:0);if(r===0)n!==null&&Rl(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Rl(n),t===1)e.tag===0?Cf(jc.bind(null,e)):iu(jc.bind(null,e)),Nf(function(){(Te&6)===0&&wn()}),n=null;else{switch(pa(r)){case 1:n=je;break;case 4:n=ze;break;case 16:n=Ve;break;case 536870912:n=Tl;break;default:n=Ve}n=Dc(n,wc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function wc(e,t){if(Es=-1,Ps=0,(Te&6)!==0)throw Error(u(327));var n=e.callbackNode;if(jr()&&e.callbackNode!==n)return null;var r=Ml(e,e===et?rt:0);if(r===0)return null;if((r&30)!==0||(r&e.expiredLanes)!==0||t)t=Ds(e,r);else{t=r;var l=Te;Te|=2;var i=kc();(et!==e||rt!==t)&&(an=null,wr=Be()+500,Kn(e,t));do try{Gf();break}catch(v){Nc(e,v)}while(!0);Wi(),Ns.current=i,Te=l,Ye!==null?t=0:(et=null,rt=0,t=Je)}if(t!==0){if(t===2&&(l=oi(e),l!==0&&(r=l,t=Do(e,l))),t===1)throw n=pl,Kn(e,0),En(e,r),yt(e,Be()),n;if(t===6)En(e,r);else{if(l=e.current.alternate,(r&30)===0&&!Wf(l)&&(t=Ds(e,r),t===2&&(i=oi(e),i!==0&&(r=i,t=Do(e,i))),t===1))throw n=pl,Kn(e,0),En(e,r),yt(e,Be()),n;switch(e.finishedWork=l,e.finishedLanes=r,t){case 0:case 1:throw Error(u(345));case 2:Gn(e,gt,an);break;case 3:if(En(e,r),(r&130023424)===r&&(t=Co+500-Be(),10<t)){if(Ml(e,0)!==0)break;if(l=e.suspendedLanes,(l&r)!==r){ft(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=Li(Gn.bind(null,e,gt,an),t);break}Gn(e,gt,an);break;case 4:if(En(e,r),(r&4194240)===r)break;for(t=e.eventTimes,l=-1;0<r;){var c=31-Tt(r);i=1<<c,c=t[c],c>l&&(l=c),r&=~i}if(r=l,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Vf(r/1960))-r,10<r){e.timeoutHandle=Li(Gn.bind(null,e,gt,an),r);break}Gn(e,gt,an);break;case 5:Gn(e,gt,an);break;default:throw Error(u(329))}}}return yt(e,Be()),e.callbackNode===n?wc.bind(null,e):null}function Do(e,t){var n=hl;return e.current.memoizedState.isDehydrated&&(Kn(e,t).flags|=256),e=Ds(e,t),e!==2&&(t=gt,gt=n,t!==null&&_o(t)),e}function _o(e){gt===null?gt=e:gt.push.apply(gt,e)}function Wf(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var l=n[r],i=l.getSnapshot;l=l.value;try{if(!Lt(i(),l))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function En(e,t){for(t&=~bo,t&=~ks,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Tt(t),r=1<<n;e[n]=-1,t&=~r}}function jc(e){if((Te&6)!==0)throw Error(u(327));jr();var t=Ml(e,0);if((t&1)===0)return yt(e,Be()),null;var n=Ds(e,t);if(e.tag!==0&&n===2){var r=oi(e);r!==0&&(t=r,n=Do(e,r))}if(n===1)throw n=pl,Kn(e,0),En(e,t),yt(e,Be()),n;if(n===6)throw Error(u(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Gn(e,gt,an),yt(e,Be()),null}function Oo(e,t){var n=Te;Te|=1;try{return e(t)}finally{Te=n,Te===0&&(wr=Be()+500,ns&&wn())}}function Wn(e){bn!==null&&bn.tag===0&&(Te&6)===0&&jr();var t=Te;Te|=1;var n=_t.transition,r=Ie;try{if(_t.transition=null,Ie=1,e)return e()}finally{Ie=r,_t.transition=n,Te=t,(Te&6)===0&&wn()}}function Ro(){St=xr.current,Ae(xr)}function Kn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,jf(n)),Ye!==null)for(n=Ye.return;n!==null;){var r=n;switch(Ai(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&es();break;case 3:gr(),Ae(pt),Ae(it),Zi();break;case 5:Ji(r);break;case 4:gr();break;case 13:Ae(We);break;case 19:Ae(We);break;case 10:Ki(r.type._context);break;case 22:case 23:Ro()}n=n.return}if(et=e,Ye=e=Pn(e.current,null),rt=St=t,Je=0,pl=null,bo=ks=Vn=0,gt=hl=null,Un!==null){for(t=0;t<Un.length;t++)if(n=Un[t],r=n.interleaved,r!==null){n.interleaved=null;var l=r.next,i=n.pending;if(i!==null){var c=i.next;i.next=l,r.next=c}n.pending=r}Un=null}return e}function Nc(e,t){do{var n=Ye;try{if(Wi(),fs.current=gs,ps){for(var r=Ke.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}ps=!1}if(Hn=0,Ze=qe=Ke=null,ol=!1,al=0,So.current=null,n===null||n.return===null){Je=1,pl=t,Ye=null;break}e:{var i=e,c=n.return,v=n,j=t;if(t=rt,v.flags|=32768,j!==null&&typeof j=="object"&&typeof j.then=="function"){var L=j,Y=v,X=Y.tag;if((Y.mode&1)===0&&(X===0||X===11||X===15)){var K=Y.alternate;K?(Y.updateQueue=K.updateQueue,Y.memoizedState=K.memoizedState,Y.lanes=K.lanes):(Y.updateQueue=null,Y.memoizedState=null)}var ue=Gu(c);if(ue!==null){ue.flags&=-257,Qu(ue,c,v,i,t),ue.mode&1&&Ku(i,L,t),t=ue,j=L;var me=t.updateQueue;if(me===null){var xe=new Set;xe.add(j),t.updateQueue=xe}else me.add(j);break e}else{if((t&1)===0){Ku(i,L,t),To();break e}j=Error(u(426))}}else if(He&&v.mode&1){var Qe=Gu(c);if(Qe!==null){(Qe.flags&65536)===0&&(Qe.flags|=256),Qu(Qe,c,v,i,t),Hi(yr(j,v));break e}}i=j=yr(j,v),Je!==4&&(Je=2),hl===null?hl=[i]:hl.push(i),i=c;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var P=Vu(i,j,t);yu(i,P);break e;case 1:v=j;var S=i.type,_=i.stateNode;if((i.flags&128)===0&&(typeof S.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Sn===null||!Sn.has(_)))){i.flags|=65536,t&=-t,i.lanes|=t;var ne=Wu(i,v,t);yu(i,ne);break e}}i=i.return}while(i!==null)}bc(n)}catch(we){t=we,Ye===n&&n!==null&&(Ye=n=n.return);continue}break}while(!0)}function kc(){var e=Ns.current;return Ns.current=gs,e===null?gs:e}function To(){(Je===0||Je===3||Je===2)&&(Je=4),et===null||(Vn&268435455)===0&&(ks&268435455)===0||En(et,rt)}function Ds(e,t){var n=Te;Te|=2;var r=kc();(et!==e||rt!==t)&&(an=null,Kn(e,t));do try{Kf();break}catch(l){Nc(e,l)}while(!0);if(Wi(),Te=n,Ns.current=r,Ye!==null)throw Error(u(261));return et=null,rt=0,Je}function Kf(){for(;Ye!==null;)Sc(Ye)}function Gf(){for(;Ye!==null&&!Mr();)Sc(Ye)}function Sc(e){var t=Pc(e.alternate,e,St);e.memoizedProps=e.pendingProps,t===null?bc(e):Ye=t,So.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=$f(n,t,St),n!==null){Ye=n;return}}else{if(n=Af(n,t),n!==null){n.flags&=32767,Ye=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Je=6,Ye=null;return}}if(t=t.sibling,t!==null){Ye=t;return}Ye=t=e}while(t!==null);Je===0&&(Je=5)}function Gn(e,t,n){var r=Ie,l=_t.transition;try{_t.transition=null,Ie=1,Qf(e,t,n,r)}finally{_t.transition=l,Ie=r}return null}function Qf(e,t,n,r){do jr();while(bn!==null);if((Te&6)!==0)throw Error(u(327));n=e.finishedWork;var l=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(u(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Ed(e,i),e===et&&(Ye=et=null,rt=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||bs||(bs=!0,Dc(Ve,function(){return jr(),null})),i=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||i){i=_t.transition,_t.transition=null;var c=Ie;Ie=1;var v=Te;Te|=4,So.current=null,Bf(e,n),mc(n,e),hf(Ri),Al=!!Oi,Ri=Oi=null,e.current=n,Hf(n),si(),Te=v,Ie=c,_t.transition=i}else e.current=n;if(bs&&(bs=!1,bn=e,Cs=l),i=e.pendingLanes,i===0&&(Sn=null),jd(n.stateNode),yt(e,Be()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)l=t[n],r(l.value,{componentStack:l.stack,digest:l.digest});if(Ss)throw Ss=!1,e=Eo,Eo=null,e;return(Cs&1)!==0&&e.tag!==0&&jr(),i=e.pendingLanes,(i&1)!==0?e===Po?ml++:(ml=0,Po=e):ml=0,wn(),null}function jr(){if(bn!==null){var e=pa(Cs),t=_t.transition,n=Ie;try{if(_t.transition=null,Ie=16>e?16:e,bn===null)var r=!1;else{if(e=bn,bn=null,Cs=0,(Te&6)!==0)throw Error(u(331));var l=Te;for(Te|=4,pe=e.current;pe!==null;){var i=pe,c=i.child;if((pe.flags&16)!==0){var v=i.deletions;if(v!==null){for(var j=0;j<v.length;j++){var L=v[j];for(pe=L;pe!==null;){var Y=pe;switch(Y.tag){case 0:case 11:case 15:fl(8,Y,i)}var X=Y.child;if(X!==null)X.return=Y,pe=X;else for(;pe!==null;){Y=pe;var K=Y.sibling,ue=Y.return;if(cc(Y),Y===L){pe=null;break}if(K!==null){K.return=ue,pe=K;break}pe=ue}}}var me=i.alternate;if(me!==null){var xe=me.child;if(xe!==null){me.child=null;do{var Qe=xe.sibling;xe.sibling=null,xe=Qe}while(xe!==null)}}pe=i}}if((i.subtreeFlags&2064)!==0&&c!==null)c.return=i,pe=c;else e:for(;pe!==null;){if(i=pe,(i.flags&2048)!==0)switch(i.tag){case 0:case 11:case 15:fl(9,i,i.return)}var P=i.sibling;if(P!==null){P.return=i.return,pe=P;break e}pe=i.return}}var S=e.current;for(pe=S;pe!==null;){c=pe;var _=c.child;if((c.subtreeFlags&2064)!==0&&_!==null)_.return=c,pe=_;else e:for(c=S;pe!==null;){if(v=pe,(v.flags&2048)!==0)try{switch(v.tag){case 0:case 11:case 15:js(9,v)}}catch(we){Ge(v,v.return,we)}if(v===c){pe=null;break e}var ne=v.sibling;if(ne!==null){ne.return=v.return,pe=ne;break e}pe=v.return}}if(Te=l,wn(),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(Ll,e)}catch{}r=!0}return r}finally{Ie=n,_t.transition=t}}return!1}function Cc(e,t,n){t=yr(n,t),t=Vu(e,t,1),e=Nn(e,t,1),t=ft(),e!==null&&($r(e,1,t),yt(e,t))}function Ge(e,t,n){if(e.tag===3)Cc(e,e,n);else for(;t!==null;){if(t.tag===3){Cc(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Sn===null||!Sn.has(r))){e=yr(n,e),e=Wu(t,e,1),t=Nn(t,e,1),e=ft(),t!==null&&($r(t,1,e),yt(t,e));break}}t=t.return}}function Yf(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=ft(),e.pingedLanes|=e.suspendedLanes&n,et===e&&(rt&n)===n&&(Je===4||Je===3&&(rt&130023424)===rt&&500>Be()-Co?Kn(e,0):bo|=n),yt(e,t)}function Ec(e,t){t===0&&((e.mode&1)===0?t=1:(t=Il,Il<<=1,(Il&130023424)===0&&(Il=4194304)));var n=ft();e=ln(e,t),e!==null&&($r(e,t,n),yt(e,n))}function qf(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Ec(e,n)}function Jf(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(u(314))}r!==null&&r.delete(t),Ec(e,n)}var Pc;Pc=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||pt.current)mt=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return mt=!1,Ff(e,t,n);mt=(e.flags&131072)!==0}else mt=!1,He&&(t.flags&1048576)!==0&&ou(t,ls,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;xs(e,t),e=t.pendingProps;var l=ur(t,it.current);mr(t,n),l=no(null,t,r,e,l,n);var i=ro();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ht(r)?(i=!0,ts(t)):i=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,Yi(t),l.updater=ys,t.stateNode=l,l._reactInternals=t,uo(t,r,e,n),t=ho(null,t,r,!0,i,n)):(t.tag=0,He&&i&&$i(t),dt(null,t,l,n),t=t.child),t;case 16:r=t.elementType;e:{switch(xs(e,t),e=t.pendingProps,l=r._init,r=l(r._payload),t.type=r,l=t.tag=Zf(r),e=It(r,e),l){case 0:t=po(null,t,r,e,n);break e;case 1:t=ec(null,t,r,e,n);break e;case 11:t=Yu(null,t,r,e,n);break e;case 14:t=qu(null,t,r,It(r.type,e),n);break e}throw Error(u(306,r,""))}return t;case 0:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:It(r,l),po(e,t,r,l,n);case 1:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:It(r,l),ec(e,t,r,l,n);case 3:e:{if(tc(t),e===null)throw Error(u(387));r=t.pendingProps,i=t.memoizedState,l=i.element,gu(e,t),cs(t,r,null,n);var c=t.memoizedState;if(r=c.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){l=yr(Error(u(423)),t),t=nc(e,t,r,n,l);break e}else if(r!==l){l=yr(Error(u(424)),t),t=nc(e,t,r,n,l);break e}else for(kt=yn(t.stateNode.containerInfo.firstChild),Nt=t,He=!0,zt=null,n=hu(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fr(),r===l){t=on(e,t,n);break e}dt(e,t,r,n)}t=t.child}return t;case 5:return xu(t),e===null&&Bi(t),r=t.type,l=t.pendingProps,i=e!==null?e.memoizedProps:null,c=l.children,Ti(r,l)?c=null:i!==null&&Ti(r,i)&&(t.flags|=32),Zu(e,t),dt(e,t,c,n),t.child;case 6:return e===null&&Bi(t),null;case 13:return rc(e,t,n);case 4:return qi(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=pr(t,null,r,n):dt(e,t,r,n),t.child;case 11:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:It(r,l),Yu(e,t,r,l,n);case 7:return dt(e,t,t.pendingProps,n),t.child;case 8:return dt(e,t,t.pendingProps.children,n),t.child;case 12:return dt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,l=t.pendingProps,i=t.memoizedProps,c=l.value,Fe(os,r._currentValue),r._currentValue=c,i!==null)if(Lt(i.value,c)){if(i.children===l.children&&!pt.current){t=on(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var v=i.dependencies;if(v!==null){c=i.child;for(var j=v.firstContext;j!==null;){if(j.context===r){if(i.tag===1){j=sn(-1,n&-n),j.tag=2;var L=i.updateQueue;if(L!==null){L=L.shared;var Y=L.pending;Y===null?j.next=j:(j.next=Y.next,Y.next=j),L.pending=j}}i.lanes|=n,j=i.alternate,j!==null&&(j.lanes|=n),Gi(i.return,n,t),v.lanes|=n;break}j=j.next}}else if(i.tag===10)c=i.type===t.type?null:i.child;else if(i.tag===18){if(c=i.return,c===null)throw Error(u(341));c.lanes|=n,v=c.alternate,v!==null&&(v.lanes|=n),Gi(c,n,t),c=i.sibling}else c=i.child;if(c!==null)c.return=i;else for(c=i;c!==null;){if(c===t){c=null;break}if(i=c.sibling,i!==null){i.return=c.return,c=i;break}c=c.return}i=c}dt(e,t,l.children,n),t=t.child}return t;case 9:return l=t.type,r=t.pendingProps.children,mr(t,n),l=Pt(l),r=r(l),t.flags|=1,dt(e,t,r,n),t.child;case 14:return r=t.type,l=It(r,t.pendingProps),l=It(r.type,l),qu(e,t,r,l,n);case 15:return Ju(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:It(r,l),xs(e,t),t.tag=1,ht(r)?(e=!0,ts(t)):e=!1,mr(t,n),Bu(t,r,l),uo(t,r,l,n),ho(null,t,r,!0,e,n);case 19:return sc(e,t,n);case 22:return Xu(e,t,n)}throw Error(u(156,t.tag))};function Dc(e,t){return Ir(e,t)}function Xf(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ot(e,t,n,r){return new Xf(e,t,n,r)}function Lo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zf(e){if(typeof e=="function")return Lo(e)?1:0;if(e!=null){if(e=e.$$typeof,e===z)return 11;if(e===ce)return 14}return 2}function Pn(e,t){var n=e.alternate;return n===null?(n=Ot(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function _s(e,t,n,r,l,i){var c=2;if(r=e,typeof e=="function")Lo(e)&&(c=1);else if(typeof e=="string")c=5;else e:switch(e){case T:return Qn(n.children,l,i,t);case te:c=8,l|=8;break;case q:return e=Ot(12,n,t,l|2),e.elementType=q,e.lanes=i,e;case fe:return e=Ot(13,n,t,l),e.elementType=fe,e.lanes=i,e;case ie:return e=Ot(19,n,t,l),e.elementType=ie,e.lanes=i,e;case $:return Os(n,l,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case I:c=10;break e;case de:c=9;break e;case z:c=11;break e;case ce:c=14;break e;case le:c=16,r=null;break e}throw Error(u(130,e==null?e:typeof e,""))}return t=Ot(c,n,t,l),t.elementType=e,t.type=r,t.lanes=i,t}function Qn(e,t,n,r){return e=Ot(7,e,r,t),e.lanes=n,e}function Os(e,t,n,r){return e=Ot(22,e,r,t),e.elementType=$,e.lanes=n,e.stateNode={isHidden:!1},e}function zo(e,t,n){return e=Ot(6,e,null,t),e.lanes=n,e}function Io(e,t,n){return t=Ot(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ep(e,t,n,r,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ai(0),this.expirationTimes=ai(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ai(0),this.identifierPrefix=r,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Mo(e,t,n,r,l,i,c,v,j){return e=new ep(e,t,n,v,j),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ot(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yi(i),e}function tp(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ee,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function _c(e){if(!e)return xn;e=e._reactInternals;e:{if(Zt(e)!==e||e.tag!==1)throw Error(u(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ht(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(u(171))}if(e.tag===1){var n=e.type;if(ht(n))return lu(e,n,t)}return t}function Oc(e,t,n,r,l,i,c,v,j){return e=Mo(n,r,!0,e,l,i,c,v,j),e.context=_c(null),n=e.current,r=ft(),l=Cn(n),i=sn(r,l),i.callback=t??null,Nn(n,i,l),e.current.lanes=l,$r(e,l,r),yt(e,r),e}function Rs(e,t,n,r){var l=t.current,i=ft(),c=Cn(l);return n=_c(n),t.context===null?t.context=n:t.pendingContext=n,t=sn(i,c),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Nn(l,t,c),e!==null&&($t(e,l,c,i),us(e,l,c)),c}function Ts(e){return e=e.current,e.child?(e.child.tag===5,e.child.stateNode):null}function Rc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Fo(e,t){Rc(e,t),(e=e.alternate)&&Rc(e,t)}function np(){return null}var Tc=typeof reportError=="function"?reportError:function(e){console.error(e)};function $o(e){this._internalRoot=e}Ls.prototype.render=$o.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(u(409));Rs(e,t,null,null)},Ls.prototype.unmount=$o.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Wn(function(){Rs(null,e,null,null)}),t[en]=null}};function Ls(e){this._internalRoot=e}Ls.prototype.unstable_scheduleHydration=function(e){if(e){var t=ga();e={blockedOn:null,target:e,priority:t};for(var n=0;n<hn.length&&t!==0&&t<hn[n].priority;n++);hn.splice(n,0,e),n===0&&xa(e)}};function Ao(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function zs(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Lc(){}function rp(e,t,n,r,l){if(l){if(typeof r=="function"){var i=r;r=function(){var L=Ts(c);i.call(L)}}var c=Oc(t,r,e,0,null,!1,!1,"",Lc);return e._reactRootContainer=c,e[en]=c.current,Zr(e.nodeType===8?e.parentNode:e),Wn(),c}for(;l=e.lastChild;)e.removeChild(l);if(typeof r=="function"){var v=r;r=function(){var L=Ts(j);v.call(L)}}var j=Mo(e,0,!1,null,null,!1,!1,"",Lc);return e._reactRootContainer=j,e[en]=j.current,Zr(e.nodeType===8?e.parentNode:e),Wn(function(){Rs(t,j,n,r)}),j}function Is(e,t,n,r,l){var i=n._reactRootContainer;if(i){var c=i;if(typeof l=="function"){var v=l;l=function(){var j=Ts(c);v.call(j)}}Rs(t,c,e,l)}else c=rp(n,t,e,l,r);return Ts(c)}ha=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Fr(t.pendingLanes);n!==0&&(ui(t,n|1),yt(t,Be()),(Te&6)===0&&(wr=Be()+500,wn()))}break;case 13:Wn(function(){var r=ln(e,1);if(r!==null){var l=ft();$t(r,e,1,l)}}),Fo(e,1)}},ci=function(e){if(e.tag===13){var t=ln(e,134217728);if(t!==null){var n=ft();$t(t,e,134217728,n)}Fo(e,134217728)}},ma=function(e){if(e.tag===13){var t=Cn(e),n=ln(e,t);if(n!==null){var r=ft();$t(n,e,t,r)}Fo(e,t)}},ga=function(){return Ie},ya=function(e,t){var n=Ie;try{return Ie=e,t()}finally{Ie=n}},Tr=function(e,t,n){switch(t){case"input":if(Ee(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var l=Zl(r);if(!l)throw Error(u(90));oe(r),Ee(r,l)}}}break;case"textarea":Xe(e,n);break;case"select":t=n.value,t!=null&&Re(e,!!n.multiple,t,!1)}},Cl=Oo,Jn=Wn;var lp={usingClientEntryPoint:!1,Events:[nl,or,Zl,Sl,bl,Oo]},gl={findFiberByHostInstance:Mn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sp={bundleType:gl.bundleType,version:gl.version,rendererPackageName:gl.rendererPackageName,rendererConfig:gl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=_l(e),e===null?null:e.stateNode},findFiberByHostInstance:gl.findFiberByHostInstance||np,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ms=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ms.isDisabled&&Ms.supportsFiber)try{Ll=Ms.inject(sp),Bt=Ms}catch{}}return vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lp,vt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ao(t))throw Error(u(200));return tp(e,t,null,n)},vt.createRoot=function(e,t){if(!Ao(e))throw Error(u(299));var n=!1,r="",l=Tc;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=Mo(e,1,!1,null,null,n,!1,r,l),e[en]=t.current,Zr(e.nodeType===8?e.parentNode:e),new $o(t)},vt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(u(188)):(e=Object.keys(e).join(","),Error(u(268,e)));return e=_l(t),e=e===null?null:e.stateNode,e},vt.flushSync=function(e){return Wn(e)},vt.hydrate=function(e,t,n){if(!zs(t))throw Error(u(200));return Is(null,e,t,!0,n)},vt.hydrateRoot=function(e,t,n){if(!Ao(e))throw Error(u(405));var r=n!=null&&n.hydratedSources||null,l=!1,i="",c=Tc;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),t=Oc(t,null,e,1,n??null,l,!1,i,c),e[en]=t.current,Zr(e),r)for(e=0;e<r.length;e++)n=r[e],l=n._getVersion,l=l(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,l]:t.mutableSourceEagerHydrationData.push(n,l);return new Ls(t)},vt.render=function(e,t,n){if(!zs(t))throw Error(u(200));return Is(null,e,t,!1,n)},vt.unmountComponentAtNode=function(e){if(!zs(e))throw Error(u(40));return e._reactRootContainer?(Wn(function(){Is(null,null,e,!1,function(){e._reactRootContainer=null,e[en]=null})}),!0):!1},vt.unstable_batchedUpdates=Oo,vt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!zs(n))throw Error(u(200));if(e==null||e._reactInternals===void 0)throw Error(u(38));return Is(e,t,n,!1,r)},vt.version="18.3.1-next-f1338f8080-20240426",vt}var Bc;function hp(){if(Bc)return Ho.exports;Bc=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),Ho.exports=pp(),Ho.exports}var Hc;function mp(){if(Hc)return Fs;Hc=1;var o=hp();return Fs.createRoot=o.createRoot,Fs.hydrateRoot=o.hydrateRoot,Fs}var gp=mp();const Me={get(o){try{return localStorage.getItem(o)}catch(a){return console.warn("safeLocalStorage.get failed",a),null}},set(o,a){try{if(localStorage.setItem(o,a),localStorage.getItem(o)!==a)throw new Error("Failed to verify localStorage write")}catch(u){throw console.error("safeLocalStorage.set failed",u),u}},remove(o){try{localStorage.removeItem(o)}catch(a){console.warn("safeLocalStorage.remove failed",a)}}};var yp={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const vp=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),lt=(o,a)=>{const u=b.forwardRef(({color:d="currentColor",size:f=24,strokeWidth:p=2,absoluteStrokeWidth:m,children:y,...x},N)=>b.createElement("svg",{ref:N,...yp,width:f,height:f,stroke:d,strokeWidth:m?Number(p)*24/Number(f):p,className:`lucide lucide-${vp(o)}`,...x},[...a.map(([w,C])=>b.createElement(w,C)),...(Array.isArray(y)?y:[y])||[]]));return u.displayName=`${o}`,u},Vc=lt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),xp=lt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),id=lt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Us=lt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),od=lt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),wp=lt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),jp=lt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),aa=lt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),qo=lt("FolderOpen",[["path",{d:"m6 14 1.45-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.55 6a2 2 0 0 1-1.94 1.5H4a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2h3.93a2 2 0 0 1 1.66.9l.82 1.2a2 2 0 0 0 1.66.9H18a2 2 0 0 1 2 2v2",key:"1nmvlm"}]]),Bs=lt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Np=lt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Ys=lt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),Jo=lt("Pencil",[["line",{x1:"18",x2:"22",y1:"2",y2:"6",key:"1e96e7"}],["path",{d:"M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z",key:"12iwkt"}]]),kp=lt("Plus",[["line",{x1:"12",x2:"12",y1:"5",y2:"19",key:"pwfkuu"}],["line",{x1:"5",x2:"19",y1:"12",y2:"12",key:"13b5wn"}]]),Xo=lt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Sp=lt("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),Gt=lt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),bp=/^(?:day|d)[\s_-]?(\d{1,2})(?:[^\d]|$)/i,Cp=/(\d{4})-(\d{2})-(\d{2})/,Ep=/(\d{4})_(\d{2})_(\d{2})/,Pp=/^(\d{1,2})[\s_-]/,Sr="[\\s_\\-]";function Dp(){const o=["Establishing","People",`Culture(?:${Sr}?Detail)?`,"Detail",`Action(?:${Sr}?Moment)?`,"Moment","Transition",`(?:Mood${Sr}?Food|Food${Sr}?Mood)`,"Mood","Food","Archive"],a=`^([A-MX])(?:${Sr}+)(${o.join("|")})$`;return new RegExp(a,"i")}const _p=Dp(),Op=/^([A-MX])$/i,Rp=new RegExp(`^([A-MX])(?:${Sr}+)(.+)$`,"i"),Tp=/^(0[1-6])$/,Wc={"01":"A","02":"B","03":"C","04":"D","05":"E","06":"M"};function Kc(o,a){try{const u=new Date(o),d=a?new Date(a):u;if(isNaN(u.getTime())||isNaN(d.getTime()))return null;const f=u.getTime()-d.getTime();return Math.floor(f/(1e3*60*60*24))+1}catch{return null}}function Hs(o,a){const u=o.match(bp);if(u){const p=parseInt(u[1],10);if(p>=1&&p<=31)return{day:p,pattern:"day_prefix",confidence:"high"}}let d=o.match(Cp);if(d){const p=`${d[1]}-${d[2]}-${d[3]}`,m=Kc(p,a);if(m!==null)return{day:m,pattern:"iso_date",confidence:a?"high":"medium"}}if(d=o.match(Ep),d){const p=`${d[1]}-${d[2]}-${d[3]}`,m=Kc(p,a);if(m!==null)return{day:m,pattern:"iso_date",confidence:a?"high":"medium"}}const f=o.match(Pp);if(f){const p=parseInt(f[1],10);if(p>=1&&p<=31)return{day:p,pattern:"numeric_prefix",confidence:"medium"}}return null}function Pr(o,a){return Hs(o,a)?.day??null}function Zo(o){const a=o.match(_p);if(a)return{bucket:a[1].toUpperCase(),confidence:"high",pattern:"standard"};const u=o.match(Op);if(u)return{bucket:u[1].toUpperCase(),confidence:"high",pattern:"letter"};const d=o.match(Rp);if(d)return{bucket:d[1].toUpperCase(),confidence:"medium",pattern:"custom"};const f=o.match(Tp);return f&&Wc[f[1]]?{bucket:Wc[f[1]],confidence:"low",pattern:"numeric"}:null}function Lp(o,a){const u="01_DAYS",d=o.split(/[\\/]/).filter(Boolean),f=d.length>0?d.slice(0,-1):[];let p=null,m=null,y="none",x="none";const N=f.findIndex(D=>{const M=D.toLowerCase();return M===u.toLowerCase()||M==="01_days"||M==="days"});if(N!==-1&&N<f.length-1){const D=f[N+1],M=Hs(D);if(M&&(p=M.day,y=M.confidence,N+2<f.length)){const B=f[N+2],O=Zo(B);O&&(m=O.bucket,x=O.confidence)}}else for(let D=0;D<f.length;D++){const M=f[D],B=Hs(M);if(B){if(p=B.day,y=B.confidence==="high"?"medium":"low",D+1<f.length){const O=f[D+1],U=Zo(O);U&&(m=U.bucket,x=U.confidence)}break}}const w=p!==null&&m!==null;let C="none";return w?y==="high"&&x==="high"?C="high":y!=="none"&&x!=="none"?C="medium":C="low":p!==null&&(C=y),{detectedDay:p,detectedBucket:m,isPreOrganized:w,confidence:C,pathSegments:f}}async function Gc(o){const a=[],u=["jpg","jpeg","png","heic","webp","mp4","mov","webm","avi","mkv"];try{for await(const[d,f]of o.entries()){if(f.kind!=="directory")continue;const p=Zo(d);if(!p)continue;let m=0;for await(const[y,x]of f.entries()){if(x.kind!=="file")continue;const N=y.split(".").pop()?.toLowerCase()||"";u.includes(N)&&(m+=1)}a.push({bucketLetter:p.bucket,folderName:d,photoCount:m,confidence:p.confidence,patternMatched:p.pattern})}}catch(d){console.warn("Failed to scan for buckets:",d)}return a.sort((d,f)=>d.bucketLetter.localeCompare(f.bucketLetter))}function Qc(o){return o===null?"Unsorted":`Day ${String(o).padStart(2,"0")}`}function zp(o){return[/^\..*/,/^unsorted$/i,/^inbox$/i,/^miscellaneous$/i,/^metadata$/i,/^_meta$/i].some(u=>u.test(o))}function Yc(o,a){const{photoCountMap:u=new Map,projectName:d="",tripStart:f}=a||{},p=[];for(const m of o){if(zp(m)||d&&m.toLowerCase()===d.toLowerCase())continue;const y=u.get(m)||0,x=Hs(m,f);x?p.push({folder:m,folderPath:m,detectedDay:x.day,confidence:x.confidence,patternMatched:x.pattern,suggestedName:Qc(x.day),manual:!1,photoCount:y}):p.push({folder:m,folderPath:m,detectedDay:null,confidence:"undetected",patternMatched:"none",suggestedName:Qc(null),manual:!1,photoCount:y})}return p.sort((m,y)=>m.detectedDay===null&&y.detectedDay===null?m.folder.localeCompare(y.folder):m.detectedDay===null?1:y.detectedDay===null?-1:m.detectedDay-y.detectedDay),p}function ad({isOpen:o,onClose:a,onComplete:u,recentProjects:d=[],onSelectRecent:f}){const[p,m]=b.useState("select"),[y,x]=b.useState(""),[N,w]=b.useState(""),[C,D]=b.useState(null),[M,B]=b.useState(null),[O,U]=b.useState([]),[H,W]=b.useState(!1),se=As.useRef(null),R=b.useCallback(async()=>{if(!y.trim()){D("Please enter a project name");return}if(!M){D("Please choose a folder");return}D(null),W(!0);try{const T=["jpg","jpeg","png","heic","webp","mp4","mov","webm","avi","mkv"],te=$=>{const h=$.toLowerCase().replace(/[^a-z0-9]+/g,"");return h==="01days"||h==="days"},q=async $=>{let h=0;for await(const[,F]of $.entries())if(F.kind==="directory")h+=await q(F);else if(F.kind==="file"){const k=F.name.split(".").pop()?.toLowerCase()||"";T.includes(k)&&(h+=1)}return h},I=new Map,de=[],z=new Map;for await(const[$,h]of M.entries()){if(h.kind!=="directory")continue;de.push($),z.set($,h);let F=0;for await(const[,k]of h.entries()){if(k.kind!=="file")continue;const g=k.name.split(".").pop()?.toLowerCase()||"";T.includes(g)&&(F+=1)}I.set($,F)}const fe=de.find($=>te($))||null;if(fe){const $=z.get(fe);if($){const h=[],F=new Map,k=new Map;for await(const[V,re]of $.entries()){if(re.kind!=="directory")continue;h.push(V),F.set(V,re);const ae=await q(re);k.set(V,ae)}const g=Yc(h,{photoCountMap:k,projectName:y}).map(V=>({...V,folderPath:`${fe}/${V.folder}`})),A=(await Promise.all(g.map(async V=>{const re=F.get(V.folder);if(!re||V.confidence==="undetected")return V;const ae=await Gc(re);return{...V,detectedBuckets:ae,isOrganizedStructure:ae.length>0,bucketConfidence:ae.length>0?ae.every(ge=>ge.confidence==="high")?"high":"medium":"none"}}))).map(V=>({...V,skip:V.confidence==="undetected"?!0:V.skip??!1}));U(A),m("preview");return}}const ie=Yc(de,{photoCountMap:I,projectName:y}),le=(await Promise.all(ie.map(async $=>{const h=z.get($.folder);if(!h||$.confidence==="undetected")return $;const F=await Gc(h);return{...$,detectedBuckets:F,isOrganizedStructure:F.length>0,bucketConfidence:F.length>0?F.every(k=>k.confidence==="high")?"high":"medium":"none"}}))).map($=>({...$,skip:$.confidence==="undetected"?!0:$.skip??!1}));U(le),m("preview")}catch(T){D(T instanceof Error?T.message:"Failed to detect folder structure")}finally{W(!1)}},[M,y]),G=b.useCallback((T,te,q)=>{U(I=>{const de=[...I];return te==="detectedDay"?(de[T].detectedDay=q===""?null:parseInt(q,10),de[T].manual=!0):te==="skip"?de[T].skip=q:de[T][te]=q,de})},[]),ee=b.useCallback(()=>{if(!y.trim()){D("Please enter a project name");return}if(!M){D("Please choose a folder");return}const T=N.trim()||M.name,te=d.find(q=>q.rootPath.toLowerCase()===T.toLowerCase());if(te){D(`This folder is already being used by project "${te.projectName}". Opening the same folder twice could cause conflicts. Open the existing project instead or choose a different folder.`);return}D(null),u({projectName:y.trim(),rootPath:T,dirHandle:M,mappings:O}),a()},[M,O,a,u,y,N,d]);return o?s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-start justify-center z-50 pt-12",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full mx-6 max-h-[88vh] overflow-y-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-8 py-6 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-extrabold text-gray-900",children:p==="select"?"Create Project":"Review Folder Structure"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:p==="select"?"Add a project name and choose the folder that contains your photos.":"Confirm how your existing folders map to days."})]}),s.jsx("button",{onClick:a,className:"text-gray-600 hover:text-gray-800 rounded-md px-2 py-1","aria-label":"Close",children:s.jsx(Gt,{size:20})})]}),s.jsxs("div",{className:"px-8 py-6 space-y-6",children:[C&&s.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800",children:C}),p==="select"&&d.length>0&&s.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-200 bg-gray-50 p-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Recent Projects"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Open a recent project instead of creating a new one."})]}),s.jsx("div",{className:"space-y-2",children:d.map(T=>s.jsxs("button",{onClick:()=>{f?.(T.projectId),a()},className:"w-full text-left rounded-lg border border-gray-200 bg-white px-3 py-2 hover:border-blue-300 hover:bg-blue-50",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.projectName}),s.jsx("div",{className:"text-xs text-gray-600 truncate",children:T.rootPath})]},T.projectId))})]}),p==="select"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Name"}),s.jsx("input",{type:"text",value:y,onChange:T=>x(T.target.value),placeholder:"e.g., Mexico 2025",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder:text-gray-600 text-gray-900"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Folder Path"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:N,onChange:T=>w(T.target.value),placeholder:"/Users/you/trips/mexico",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder:text-gray-600 text-gray-900"}),s.jsx("input",{ref:se,type:"file",webkitdirectory:"true",as:!0,any:!0,directory:"true",mozdirectory:"true",className:"hidden",onChange:T=>{const te=T.currentTarget.files;if(!te||te.length===0)return;const q=te[0],de=(q.webkitRelativePath||q.name).split("/")[0];w(de),B(null),T.currentTarget.value=""}}),s.jsxs("button",{onClick:async()=>{if("showDirectoryPicker"in window){const T=await window.showDirectoryPicker();B(T),w(T?.name||"");return}se.current?.click()},className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 flex items-center gap-2",children:[s.jsx(qo,{size:18}),"Browse"]})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Use the folder picker to grant access. If the picker is unavailable, paste the full path (the app will ask again on first open)."})]})]}),p==="preview"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Review the detected folders and adjust the day numbers if needed."}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[s.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Folder"}),s.jsx("th",{className:"text-center px-3 py-2 font-medium text-gray-700",children:"Day #"}),s.jsx("th",{className:"text-left px-3 py-2 font-medium text-gray-700",children:"Buckets"}),s.jsx("th",{className:"text-center px-3 py-2 font-medium text-gray-700",children:"Photos"}),s.jsx("th",{className:"text-center px-3 py-2 font-medium text-gray-700",children:"Action"})]})}),s.jsxs("tbody",{children:[O.map((T,te)=>s.jsxs("tr",{className:`border-b border-gray-200 ${T.skip?"bg-gray-100 opacity-60":"hover:bg-blue-50"}`,children:[s.jsx("td",{className:"px-3 py-3 text-gray-900",children:T.folder}),s.jsx("td",{className:"px-3 py-3 text-center",children:s.jsx("input",{type:"number",min:"1",max:"31",value:T.detectedDay??"",onChange:q=>G(te,"detectedDay",q.target.value),disabled:T.skip,className:"w-12 px-2 py-1 border border-gray-300 rounded text-center focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900",placeholder:""})}),s.jsx("td",{className:"px-3 py-3",children:T.detectedBuckets&&T.detectedBuckets.length>0?s.jsx("div",{className:"flex flex-wrap gap-1",children:T.detectedBuckets.map(q=>s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",title:`${q.folderName} (${q.photoCount} photos)`,children:[q.bucketLetter,s.jsxs("span",{className:"ml-1 text-green-600",children:["(",q.photoCount,")"]})]},q.bucketLetter))}):s.jsx("span",{className:"text-xs text-gray-400 italic",children:"None detected"})}),s.jsx("td",{className:"px-3 py-3 text-center text-gray-600",children:T.photoCount}),s.jsx("td",{className:"px-3 py-3 text-center",children:s.jsx("button",{onClick:()=>G(te,"skip",!T.skip),className:`px-3 py-1 rounded text-sm font-medium ${T.skip?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:T.skip?"Skip":"Map"})})]},T.folder)),O.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"px-3 py-4 text-sm text-gray-600 text-center",children:"No subfolders detected. You can still continue and sort manually."})})]})]})})]})]}),s.jsx("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4 flex justify-between gap-3",children:p==="select"?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 font-medium",children:"Cancel"}),s.jsx("button",{onClick:R,disabled:!y.trim()||!M||H,"aria-disabled":!y.trim()||!M||H,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium disabled:bg-gray-200 disabled:text-gray-500 disabled:cursor-not-allowed",children:H?"Detecting":"Next"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>m("select"),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 font-medium",children:"Back"}),s.jsx("button",{onClick:ee,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Create Project"})]})})]})}):null}const Ip="narrative-covers",Mp=1,On="covers",wt="metadata";let $s=null;async function qs(){return $s||new Promise((o,a)=>{const u=indexedDB.open(Ip,Mp);u.onerror=()=>a(u.error),u.onsuccess=()=>{$s=u.result,o($s)},u.onupgradeneeded=d=>{const f=d.target.result;f.objectStoreNames.contains(On)||f.createObjectStore(On,{keyPath:"coverKey"}),f.objectStoreNames.contains(wt)||f.createObjectStore(wt,{keyPath:"projectId"}).createIndex("lastUsed","lastUsed",{unique:!1})}})}async function Fp(o,a,u=120,d=90){const f=await qs(),p=`cover-${o}-${Date.now()}`,m=a.size,y=f.transaction([On],"readwrite").objectStore(On).put({coverKey:p,blob:a});await new Promise((w,C)=>{y.onsuccess=()=>w(),y.onerror=()=>C(y.error)});const x={projectId:o,coverKey:p,lastUsed:Date.now(),width:u,height:d,sizeBytes:m},N=f.transaction([wt],"readwrite").objectStore(wt).put(x);return await new Promise((w,C)=>{N.onsuccess=()=>w(),N.onerror=()=>C(N.error)}),p}async function $p(o){const a=await qs(),u=a.transaction([wt],"readonly").objectStore(wt).get(o),d=await new Promise((y,x)=>{u.onsuccess=()=>y(u.result),u.onerror=()=>x(u.error)});if(!d)return null;const f=a.transaction([wt],"readwrite").objectStore(wt).put({...d,lastUsed:Date.now()});await new Promise((y,x)=>{f.onsuccess=()=>y(),f.onerror=()=>x(f.error)});const p=a.transaction([On],"readonly").objectStore(On).get(d.coverKey);return(await new Promise((y,x)=>{p.onsuccess=()=>y(p.result),p.onerror=()=>x(p.error)}))?.blob||null}async function Ap(o){const a=await $p(o);return a?URL.createObjectURL(a):null}async function Up(o){const a=await qs(),u=a.transaction([wt],"readonly").objectStore(wt).get(o),d=await new Promise((m,y)=>{u.onsuccess=()=>m(u.result),u.onerror=()=>y(u.error)});if(!d)return;const f=a.transaction([On],"readwrite").objectStore(On).delete(d.coverKey);await new Promise((m,y)=>{f.onsuccess=()=>m(),f.onerror=()=>y(f.error)});const p=a.transaction([wt],"readwrite").objectStore(wt).delete(o);await new Promise((m,y)=>{p.onsuccess=()=>m(),p.onerror=()=>y(p.error)})}async function Bp(){const a=(await qs()).transaction([wt],"readonly").objectStore(wt).index("lastUsed");return await new Promise((d,f)=>{const p=a.getAll();p.onsuccess=()=>d(p.result),p.onerror=()=>f(p.error)})}async function Hp(o=10){const a=await Bp(),u=[];if(a.length>o){const d=a.slice(0,a.length-o);for(const f of d)await Up(f.projectId),u.push(f.projectId)}return u}function Vp({project:o,onOpen:a}){const[u,d]=b.useState(null);return b.useEffect(()=>(o.coverKey?Ap(o.projectId).then(f=>d(f)).catch(f=>{console.warn(`Failed to load cover for ${o.projectId}:`,f),o.coverUrl&&d(o.coverUrl)}):o.coverUrl&&d(o.coverUrl),()=>{u&&u.startsWith("blob:")&&URL.revokeObjectURL(u)}),[o,o.coverKey,o.coverUrl]),s.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-gray-800 bg-gray-950 hover:border-blue-500 transition-colors group cursor-pointer",children:[s.jsx("button",{onClick:()=>a(o.projectId),className:"w-full block text-left","aria-label":`Open project ${o.projectName}`,children:s.jsx("div",{className:"aspect-video overflow-hidden bg-gray-900 relative",children:u?s.jsx("img",{src:u,alt:o.projectName,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):s.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center text-sm text-gray-400",children:s.jsx("div",{className:"text-center",children:s.jsx("div",{className:"text-xs font-medium text-gray-500",children:"No cover"})})})})}),s.jsxs("div",{className:"p-3 space-y-1",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-200 truncate",children:o.projectName}),typeof o.totalPhotos=="number"&&s.jsx("div",{className:"text-xs text-gray-500",children:`${o.totalPhotos} ${o.totalPhotos===1?"photo":"photos"}`}),s.jsx("div",{className:"text-xs text-gray-600 truncate",children:o.rootPath})]})]})}const Wp="4.1.3";class br{static instance;version;constructor(){this.version=Wp}static getInstance(){return br.instance||(br.instance=new br),br.instance}getVersion(){return this.version}getDisplayVersion(){return`v${this.version}`}isValidVersion(a){return/^\d+\.\d+\.\d+$/.test(a)}isCurrentVersionValid(){return this.isValidVersion(this.version)}getVersionComponents(){const[a,u,d]=this.version.split(".").map(Number);return{major:a,minor:u,patch:d}}compareVersions(a,u){const d=a.split(".").map(Number),f=u.split(".").map(Number);for(let p=0;p<3;p++){if(d[p]<f[p])return-1;if(d[p]>f[p])return 1}return 0}async fetchRuntimeVersion(){try{return null}catch(a){return console.warn("Error fetching runtime version:",a),null}}async getCurrentVersion(){return this.version}}const Vs=br.getInstance();function Kp({isOpen:o,onClose:a,onCreateComplete:u,onOpenProject:d,recentProjects:f=[],canClose:p=!1,errorMessage:m=null}){const[y,x]=b.useState(!1),[N,w]=b.useState(Vs.getDisplayVersion());b.useEffect(()=>{(async()=>{try{const O=await Vs.getCurrentVersion();w(`v${O}`)}catch(O){console.warn("Failed to fetch runtime version:",O)}})()},[]);const C=typeof globalThis<"u"&&(globalThis.vitest||globalThis.__APP_VERSION__==="0.0.0"),D="showDirectoryPicker"in window,M="indexedDB"in window;return!C&&(!D||!M)?s.jsx("div",{className:"h-screen bg-gray-950 text-gray-100 flex items-center justify-center",children:s.jsxs("div",{className:"max-w-md mx-auto text-center p-6",children:[s.jsx("div",{className:"text-red-400 text-6xl mb-4",children:""}),s.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Browser Not Supported"}),s.jsx("p",{className:"text-gray-400 mb-4",children:"This app requires a modern browser with support for the File System Access API and IndexedDB."}),s.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[!D&&s.jsx("div",{children:" File System Access API not available"}),!M&&s.jsx("div",{children:" IndexedDB not available"})]}),s.jsx("p",{className:"text-gray-400 text-sm mt-4",children:"Please use a recent version of Chrome, Edge, or another supported browser."})]})}):s.jsxs("div",{className:"h-screen bg-gray-950 text-gray-100 flex flex-col",children:[s.jsx("div",{className:"border-b border-gray-800 bg-gray-900/50 backdrop-blur-sm",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:"/Narrative/assets/Narrative_icon.png",alt:"Narrative",className:"w-8 h-8 rounded"}),s.jsx("h1",{className:"text-xl font-bold",children:"Narrative"})]}),s.jsx("div",{className:"px-3 py-1 bg-gray-800 text-gray-300 rounded-md text-xs font-medium tracking-wide",children:s.jsx("span",{className:"uppercase",children:N})})]})}),s.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:s.jsxs("div",{className:"w-full max-w-7xl",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Projects"}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Create a new project or open a recent one"})]}),m&&s.jsx("div",{className:"rounded-lg border border-red-800 bg-red-950/60 px-4 py-3 text-sm text-red-200 mb-6",children:m}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 auto-rows-max",children:[s.jsxs("div",{className:"relative rounded-lg overflow-hidden border-2 border-dashed border-gray-700 bg-gray-950 hover:border-blue-500 transition-colors group cursor-pointer",children:[s.jsx("button",{onClick:()=>x(!0),className:"w-full block text-left","aria-label":"Create new project",children:s.jsx("div",{className:"aspect-video overflow-hidden bg-gray-900 relative",children:s.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center group-hover:from-gray-700 group-hover:to-gray-800 transition-colors",children:s.jsx("div",{className:"w-14 h-14 rounded-full bg-gray-700 group-hover:bg-blue-500/20 flex items-center justify-center mb-2 transition-colors",children:s.jsx(kp,{className:"w-7 h-7 text-blue-400"})})})})}),s.jsxs("div",{className:"p-3 space-y-1",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-200",children:"New Project"}),s.jsx("div",{className:"text-xs text-gray-500",children:"Start organizing photos"})]})]}),f.map(B=>s.jsx(Vp,{project:B,onOpen:d},B.projectId))]}),f.length===0&&s.jsx("div",{className:"text-center py-12 text-gray-500",children:s.jsx("p",{className:"text-sm",children:"No recent projects. Create one to get started."})})]})}),s.jsx(ad,{isOpen:y,onClose:()=>x(!1),onComplete:B=>{x(!1),u(B)},recentProjects:f,onSelectRecent:d})]})}function Gp({isOpen:o,title:a="Loading Project",message:u="Please wait while we load your project...",progress:d=0,showProgressBar:f=!0}){const[p,m]=b.useState(0);return b.useEffect(()=>{if(d!==p){const y=setTimeout(()=>{m(d)},100);return()=>clearTimeout(y)}},[d,p]),o?s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-gray-900 rounded-lg shadow-2xl p-8 max-w-md w-full mx-4 border border-gray-800",children:[s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 bg-blue-500 rounded-full blur-lg opacity-20"}),s.jsx(Ys,{className:"w-12 h-12 text-blue-400 animate-spin relative"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:a}),s.jsx("p",{className:"text-gray-400 text-sm",children:u})]})]}),f&&s.jsxs("div",{className:"mt-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-400",children:"Progress"}),s.jsxs("span",{className:"text-xs font-bold text-blue-400",children:[Math.round(p),"%"]})]}),s.jsx("div",{className:"w-full bg-gray-800 rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-400 h-full rounded-full transition-all duration-300 ease-out",style:{width:`${p}%`}})})]}),s.jsx("div",{className:"mt-6 text-center",children:s.jsx("p",{className:"text-xs text-gray-500 animate-pulse",children:p===100?"Almost done...":"Loading..."})})]})}):null}const Qp="modulepreload",Yp=function(o){return"/narrative-template/"+o},qc={},qp=function(a,u,d){let f=Promise.resolve();if(u&&u.length>0){let x=function(N){return Promise.all(N.map(w=>Promise.resolve(w).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),y=m?.nonce||m?.getAttribute("nonce");f=x(u.map(N=>{if(N=Yp(N),N in qc)return;qc[N]=!0;const w=N.endsWith(".css"),C=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${N}"]${C}`))return;const D=document.createElement("link");if(D.rel=w?"stylesheet":Qp,w||(D.as="script"),D.crossOrigin="",D.href=N,y&&D.setAttribute("nonce",y),document.head.appendChild(D),w)return new Promise((M,B)=>{D.addEventListener("load",M),D.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${N}`)))})}))}function p(m){const y=new Event("vite:preloadError",{cancelable:!0});if(y.payload=m,window.dispatchEvent(y),!y.defaultPrevented)throw m}return f.then(m=>{for(const y of m||[])y.status==="rejected"&&p(y.reason);return a().catch(p)})},ea=(o,a)=>a.some(u=>o instanceof u);let Jc,Xc;function Jp(){return Jc||(Jc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Xp(){return Xc||(Xc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ta=new WeakMap,Ko=new WeakMap,Js=new WeakMap;function Zp(o){const a=new Promise((u,d)=>{const f=()=>{o.removeEventListener("success",p),o.removeEventListener("error",m)},p=()=>{u(Yn(o.result)),f()},m=()=>{d(o.error),f()};o.addEventListener("success",p),o.addEventListener("error",m)});return Js.set(a,o),a}function eh(o){if(ta.has(o))return;const a=new Promise((u,d)=>{const f=()=>{o.removeEventListener("complete",p),o.removeEventListener("error",m),o.removeEventListener("abort",m)},p=()=>{u(),f()},m=()=>{d(o.error||new DOMException("AbortError","AbortError")),f()};o.addEventListener("complete",p),o.addEventListener("error",m),o.addEventListener("abort",m)});ta.set(o,a)}let na={get(o,a,u){if(o instanceof IDBTransaction){if(a==="done")return ta.get(o);if(a==="store")return u.objectStoreNames[1]?void 0:u.objectStore(u.objectStoreNames[0])}return Yn(o[a])},set(o,a,u){return o[a]=u,!0},has(o,a){return o instanceof IDBTransaction&&(a==="done"||a==="store")?!0:a in o}};function ud(o){na=o(na)}function th(o){return Xp().includes(o)?function(...a){return o.apply(ra(this),a),Yn(this.request)}:function(...a){return Yn(o.apply(ra(this),a))}}function nh(o){return typeof o=="function"?th(o):(o instanceof IDBTransaction&&eh(o),ea(o,Jp())?new Proxy(o,na):o)}function Yn(o){if(o instanceof IDBRequest)return Zp(o);if(Ko.has(o))return Ko.get(o);const a=nh(o);return a!==o&&(Ko.set(o,a),Js.set(a,o)),a}const ra=o=>Js.get(o);function rh(o,a,{blocked:u,upgrade:d,blocking:f,terminated:p}={}){const m=indexedDB.open(o,a),y=Yn(m);return d&&m.addEventListener("upgradeneeded",x=>{d(Yn(m.result),x.oldVersion,x.newVersion,Yn(m.transaction),x)}),u&&m.addEventListener("blocked",x=>u(x.oldVersion,x.newVersion,x)),y.then(x=>{p&&x.addEventListener("close",()=>p()),f&&x.addEventListener("versionchange",N=>f(N.oldVersion,N.newVersion,N))}).catch(()=>{}),y}const lh=["get","getKey","getAll","getAllKeys","count"],sh=["put","add","delete","clear"],Go=new Map;function Zc(o,a){if(!(o instanceof IDBDatabase&&!(a in o)&&typeof a=="string"))return;if(Go.get(a))return Go.get(a);const u=a.replace(/FromIndex$/,""),d=a!==u,f=sh.includes(u);if(!(u in(d?IDBIndex:IDBObjectStore).prototype)||!(f||lh.includes(u)))return;const p=async function(m,...y){const x=this.transaction(m,f?"readwrite":"readonly");let N=x.store;return d&&(N=N.index(y.shift())),(await Promise.all([N[u](...y),f&&x.done]))[0]};return Go.set(a,p),p}ud(o=>({...o,get:(a,u,d)=>Zc(a,u)||o.get(a,u,d),has:(a,u)=>!!Zc(a,u)||o.has(a,u)}));const ih=["continue","continuePrimaryKey","advance"],ed={},la=new WeakMap,cd=new WeakMap,oh={get(o,a){if(!ih.includes(a))return o[a];let u=ed[a];return u||(u=ed[a]=function(...d){la.set(this,cd.get(this)[a](...d))}),u}};async function*ah(...o){let a=this;if(a instanceof IDBCursor||(a=await a.openCursor(...o)),!a)return;a=a;const u=new Proxy(a,oh);for(cd.set(u,a),Js.set(u,ra(a));a;)yield u,a=await(la.get(u)||a.continue()),la.delete(u)}function td(o,a){return a===Symbol.asyncIterator&&ea(o,[IDBIndex,IDBObjectStore,IDBCursor])||a==="iterate"&&ea(o,[IDBIndex,IDBObjectStore])}ud(o=>({...o,get(a,u,d){return td(a,u)?ah:o.get(a,u,d)},has(a,u){return td(a,u)||o.has(a,u)}}));class uh{db=null;objectUrls=new Map;async init(){this.db||(this.db=await rh("narrative-thumbnails",1,{upgrade(a){a.objectStoreNames.contains("thumbnails")||a.createObjectStore("thumbnails",{keyPath:"id"})}}))}async get(a){if(this.objectUrls.has(a))return this.objectUrls.get(a);await this.init();const u=await this.db.get("thumbnails",a);if(!u?.blob)return null;const d=URL.createObjectURL(u.blob);return this.objectUrls.set(a,d),d}async set(a,u){await this.init();const d=this.objectUrls.get(a);if(d){try{URL.revokeObjectURL(d)}catch{}this.objectUrls.delete(a)}await this.db.put("thumbnails",{id:a,blob:u,timestamp:Date.now()})}async clear(){await this.init(),await this.db.clear("thumbnails"),this.objectUrls.forEach(a=>{try{URL.revokeObjectURL(a)}catch{}}),this.objectUrls.clear()}}const nd=new uh,ch=["jpg","jpeg","png","heic","webp","mp4","mov","webm","avi","mkv"],Xs="narrative:projectState:",dh="narrative:handles",Qt="projects",Ws={autoDay:!0,folderStructure:{daysFolder:"01_DAYS",archiveFolder:"98_ARCHIVE",favoritesFolder:"FAV",metaFolder:"_meta"}};function dd(){return`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`}const fh=1e4;async function Zs(){if(!window.indexedDB)throw new Error("IndexedDB is not available in this environment.");return new Promise((o,a)=>{let u=!1;const d=m=>{u||(u=!0,m())},f=window.setTimeout(()=>{d(()=>a(new Error("IndexedDB open timed out.")))},fh),p=indexedDB.open(dh,1);p.onupgradeneeded=()=>{const m=p.result;m.objectStoreNames.contains(Qt)||m.createObjectStore(Qt)},p.onsuccess=()=>{window.clearTimeout(f),d(()=>o(p.result))},p.onerror=()=>{window.clearTimeout(f),d(()=>a(p.error))},p.onblocked=()=>{window.clearTimeout(f),d(()=>a(new Error("IndexedDB open was blocked. Please close other Narrative tabs and retry.")))}})}async function ua(o,a){const u=await Zs();return new Promise((d,f)=>{const p=u.transaction(Qt,"readwrite");p.objectStore(Qt).put(a,o),p.oncomplete=()=>d(),p.onerror=()=>f(p.error)})}async function Ks(o){const a=await Zs();return new Promise((u,d)=>{const p=a.transaction(Qt,"readonly").objectStore(Qt).get(o);p.onsuccess=()=>u(p.result||null),p.onerror=()=>d(p.error)})}async function ph(o){const a=await Zs();return new Promise((u,d)=>{const f=a.transaction(Qt,"readwrite");f.objectStore(Qt).delete(o),f.oncomplete=()=>u(),f.onerror=()=>d(f.error)})}function hh(o){const a=o.split(".").pop()?.toLowerCase()||"";return ch.includes(a)}function mh(o){const a=o.toLowerCase();return o.startsWith(".")||o.startsWith("._")||a==="thumbs.db"||a==="desktop.ini"}async function fd(o,a=""){const u=[];for await(const[d,f]of o.entries())if(f.kind==="directory"){if(d.startsWith("."))continue;const p=await fd(f,a?`${a}/${d}`:d);u.push(...p)}else if(f.kind==="file"){if(mh(d)||!hh(d))continue;const p=a?`${a}/${d}`:d;u.push({handle:f,path:p})}return u}async function gh(o){try{if(typeof createImageBitmap<"u")return(await createImageBitmap(o)).close(),o}catch{}try{const d=(await qp(async()=>{const{default:f}=await import("./heic2any-BIQbFzET.js").then(p=>p.h);return{default:f}},[])).default;try{return await d({blob:o,toType:"image/jpeg",quality:.8})}catch(f){if(f?.message?.includes("already browser readable")||f?.message?.includes("ERR_USER")||f?.code===1)return o;console.warn(`heic2any conversion failed for ${o.name}:`,f)}}catch{console.warn("heic2any library not available, trying fallbacks")}const a=document.createElement("canvas"),u=a.getContext("2d");if(!u)return new Blob([""],{type:"image/jpeg"});try{if(typeof createImageBitmap<"u")try{const d=await createImageBitmap(o);a.width=d.width||400,a.height=d.height||300;try{u.drawImage(d,0,0)}catch{}return new Promise((f,p)=>{try{if(typeof a.toBlob=="function")a.toBlob(m=>{if(m){f(m);return}try{const x=a.toDataURL("image/jpeg",.8).split(","),N=x[0].match(/:(.*?);/),w=x[1];let C;if(typeof atob=="function"){const D=atob(w);let M=D.length;for(C=new Uint8Array(M);M--;)C[M]=D.charCodeAt(M)}else if(typeof Buffer<"u"){const D=Buffer.from(w,"base64");C=new Uint8Array(D.buffer,D.byteOffset,D.byteLength)}else throw new Error("No base64 decoder available");f(new Blob([C],{type:N&&N[1]||"image/jpeg"}))}catch{f(new Blob([""],{type:"image/jpeg"}))}},"image/jpeg",.8);else{const y=a.toDataURL("image/jpeg",.8).split(","),x=y[0].match(/:(.*?);/),N=y[1];let w;if(typeof atob=="function"){const C=atob(N);let D=C.length;for(w=new Uint8Array(D);D--;)w[D]=C.charCodeAt(D)}else if(typeof Buffer<"u"){const C=Buffer.from(N,"base64");w=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)}else return f(new Blob([""],{type:"image/jpeg"}));f(new Blob([w],{type:x&&x[1]||"image/jpeg"}))}}catch{f(new Blob([""],{type:"image/jpeg"}))}})}catch{}try{const d=new Image,f=URL.createObjectURL(o);return d.crossOrigin="Anonymous",await new Promise((p,m)=>{d.onload=()=>p(),d.onerror=()=>m(new Error("Image load failed")),d.src=f}),a.width=d.naturalWidth||d.width||400,a.height=d.naturalHeight||d.height||300,u.drawImage(d,0,0),URL.revokeObjectURL(f),new Promise((p,m)=>{a.toBlob(y=>{if(y){p(y);return}try{const N=a.toDataURL("image/jpeg",.8).split(","),w=N[0].match(/:(.*?);/),C=N[1];let D;if(typeof atob=="function"){const M=atob(C);let B=M.length;for(D=new Uint8Array(B);B--;)D[B]=M.charCodeAt(B)}else if(typeof Buffer<"u"){const M=Buffer.from(C,"base64");D=new Uint8Array(M.buffer,M.byteOffset,M.byteLength)}else{p(new Blob([""],{type:"image/jpeg"}));return}p(new Blob([D],{type:w&&w[1]||"image/jpeg"}))}catch{p(new Blob([""],{type:"image/jpeg"}))}},"image/jpeg",.8)})}catch{}return a.width=400,a.height=300,u.fillStyle="#e5e5e5",u.fillRect(0,0,400,300),u.fillStyle="#666666",u.font="bold 16px sans-serif",u.textAlign="center",u.textBaseline="middle",u.fillText("HEIC",200,140),u.font="12px sans-serif",u.fillText("Preview not available",200,165),new Promise(d=>{a.toBlob(f=>{if(f){d(f);return}d(new Blob([""],{type:"image/jpeg"}))},"image/jpeg",.8)})}catch{return new Blob([""],{type:"image/jpeg"})}}async function ca(o,a){const u=await fd(o),d=[],f=new Set;for(let p=0;p<u.length;p++){const m=u[p],y=Math.round((p+1)/u.length*100);a?.(y,`Processing ${m.handle.name}...`);const x=await m.handle.getFile(),N=x.lastModified,w=x.name,C=`${w}|${N}|${x.size}`;if(f.has(C))continue;f.add(C);const D=dd(),M=x.name.split(".").pop()?.toLowerCase()||"",B=M==="heic"||M==="heif"||x.type.toLowerCase().includes("heic");let O="";if(B)try{const ee=m.path,T=await nd.get(ee);if(T)O=T;else{const te=await gh(x);te&&(O=URL.createObjectURL(te),await nd.set(ee,te))}}catch(ee){console.warn(`Failed to generate preview for ${w}:`,ee)}else try{O=URL.createObjectURL(x)}catch(ee){console.warn(`Failed to create object URL for ${w}:`,ee)}const U=Lp(m.path),H=m.path.split(/[\\/]/).filter(Boolean),W=H.length>1?H.slice(0,-1):[],se=W[W.length-1]||"root";let R=null,G=null;U.isPreOrganized&&(U.confidence==="high"||U.confidence==="medium")&&(R=U.detectedDay,G=U.detectedBucket),d.push({id:D,originalName:w,currentName:w,timestamp:N,day:R,bucket:G,sequence:null,favorite:!1,rating:0,archived:!1,thumbnail:O,mimeType:x.type||(B?"image/heic":""),fileHandle:m.handle,filePath:m.path,sourceFolder:se,folderHierarchy:W,detectedDay:U.detectedDay,detectedBucket:U.detectedBucket,isPreOrganized:U.isPreOrganized,organizationConfidence:U.confidence})}return d.sort((p,m)=>p.timestamp-m.timestamp)}function yh(o){const a={};if(o.length===0)return a;let u=1,d=o[0].timestamp;const f=360*60*1e3;return a[u]=[],o.forEach(p=>{p.timestamp-d>f&&(u+=1,a[u]=[]),a[u].push(p.id),d=p.timestamp}),a}function pd(o){const a=o.photos.map(u=>({filePath:u.filePath,day:u.day,bucket:u.bucket,sequence:u.sequence,favorite:u.favorite,rating:u.rating,archived:u.archived,currentName:u.currentName,sourceFolder:u.sourceFolder,folderHierarchy:u.folderHierarchy,detectedDay:u.detectedDay,detectedBucket:u.detectedBucket,isPreOrganized:u.isPreOrganized,organizationConfidence:u.organizationConfidence,subfolderOverride:u.subfolderOverride}));return{projectName:o.projectName,rootPath:o.rootPath,settings:o.settings,dayLabels:o.dayLabels||{},dayContainers:o.dayContainers||[],lastModified:o.lastModified??Date.now(),edits:a}}function vh(o,a){const u=o.toLowerCase(),d=u.replace(/[^a-z0-9]+/g," ").trim(),f=a.toLowerCase();return!!(f&&u===f||u==="archive"||u==="archives"||u.endsWith("_archive")||u.endsWith("-archive")||u.includes("archive")||d.includes("archive"))}function hd(o,a){return a?o.map(u=>u.filePath&&u.filePath.split(/[\\/]/).filter(Boolean).some(f=>vh(f,a))?{...u,archived:!0,bucket:"X"}:u):o}async function xh(o){const{dirHandle:a,projectName:u,rootLabel:d,onProgress:f}=o;if(!("requestPermission"in a))throw new Error("File System Access API is not available or supported in this environment.");let p;try{p=await a.requestPermission({mode:"read"})}catch(w){throw console.warn("Permission request failed:",w),new Error("Unable to request folder access. Please try again.")}if(p!=="granted")throw new Error("Folder access was not granted. Please allow access to create the project.");f?.(5,"Scanning folder structure...");const m=dd();f?.(10,"Collecting image files...");const y=hd(await ca(a,(w,C)=>{const D=10+w*.6;f?.(D,C)}),Ws.folderStructure.archiveFolder);f?.(75,"Analyzing photo timestamps...");const x=yh(y);f?.(85,"Saving project data...");const N={projectName:u?.trim()||a.name,rootPath:d||a.name,photos:y,settings:Ws,lastModified:Date.now()};return await ua(m,a),Me.set(`${Xs}${m}`,JSON.stringify(pd(N))),f?.(95,"Project initialized successfully"),{projectId:m,photos:y,suggestedDays:x}}async function wh(o){const a=await Ks(o);if(!a)throw new Error("Project folder access not available. Please reselect the folder.");if(!("requestPermission"in a))throw new Error("File System Access API is not available or supported in this environment.");let u;try{u=await a.requestPermission({mode:"read"})}catch(N){throw console.warn("Permission request failed, removing stale handle:",N),await ph(o),new Error("Project folder access has expired. Please click the project again to reselect the folder.")}if(u!=="granted")throw new Error("Folder access was not granted. Please allow access to continue.");const d=Me.get(`${Xs}${o}`),f=d?JSON.parse(d):{},p=await ca(a);if(p.length===0)throw new Error("Project folder access is no longer available. Please reselect the folder.");let m=p;if(f.edits){const N=new Map;f.edits.forEach(w=>{w?.filePath&&N.set(w.filePath,w)}),m=p.map(w=>{const C=w.filePath?N.get(w.filePath):null;return C?{...w,day:C.day,bucket:C.bucket||w.bucket,sequence:C.sequence,favorite:C.favorite,rating:C.rating,archived:C.archived,currentName:C.currentName,subfolderOverride:C.subfolderOverride}:w})}const y=f.settings||Ws,x=hd(m,y.folderStructure?.archiveFolder||Ws.folderStructure.archiveFolder);return{projectName:f.projectName||a.name,rootPath:f.rootPath||a.name,photos:x,settings:y,dayLabels:f.dayLabels||{},dayContainers:f.dayContainers||[],lastModified:f.lastModified}}async function md(o,a){Me.set(`${Xs}${o}`,JSON.stringify(pd(a)))}async function jh(o){try{Me.remove(`${Xs}${o}`)}catch{}try{const a=await Zs();await new Promise((u,d)=>{const f=a.transaction(Qt,"readwrite");f.objectStore(Qt).delete(o),f.oncomplete=()=>u(),f.onerror=()=>d(f.error)})}catch{}}const xt="narrative:recentProjects",un="narrative:activeProject",vl=[{key:"A",label:"Establishing",color:"bg-blue-500",description:"Wide shots, landscapes"},{key:"B",label:"People",color:"bg-purple-500",description:"Portraits, groups"},{key:"C",label:"Culture/Detail",color:"bg-green-500",description:"Local life, close-ups"},{key:"D",label:"Action/Moment",color:"bg-orange-500",description:"Events, activities"},{key:"E",label:"Transition",color:"bg-yellow-500",description:"Travel, movement"},{key:"M",label:"Mood/Food",color:"bg-indigo-500",description:"Food, mood"},{key:"X",label:"Archive",color:"bg-gray-500",description:"Unwanted shots"}],Nh=new Set(vl.map(o=>o.key)),gd={A:"Establishing",B:"People",C:"Culture-Detail",D:"Action-Moment",E:"Transition",M:"Mood-Food",X:"Archive"};Object.values(gd).flatMap(o=>o.split("-").map(a=>a.trim()));const kh=o=>{const u=o.trim().split(/[\s_-]+/)[0]||"";return Nh.has(u.toUpperCase())};function Sh({photos:o,setPhotos:a,projectRootPath:u,projectName:d,projectFolderLabel:f,projectSettings:p,dayLabels:m,prevThumbnailsRef:y}){const[x,N]=b.useState([]),[w,C]=b.useState(-1),D=b.useCallback(U=>{if(!u)return;md(u,{projectName:d,rootPath:f||u,photos:U??o,settings:p,dayLabels:m}).catch(()=>{})},[u,d,f,o,p,m]),M=b.useCallback(U=>{const H=o.map(R=>({id:R.id,filePath:R.filePath,day:R.day,bucket:R.bucket,sequence:R.sequence,favorite:R.favorite,rating:R.rating,archived:R.archived,currentName:R.currentName,originalName:R.originalName,timestamp:R.timestamp,subfolderOverride:R.subfolderOverride})),W=x.slice(0,w+1);W.push(H);const se=W.slice(-30);N(se),C(se.length-1);try{const R=U.map(G=>G.thumbnail).filter(Boolean);y.current.forEach(G=>{if(G&&!R.includes(G)&&G.startsWith("blob:"))try{URL.revokeObjectURL(G)}catch{}}),y.current=R}catch{}a(U),D(U)},[x,w,o,D,y,a]),B=b.useCallback(()=>{if(w>0){const U=x[w-1],H=o.map(W=>{const se=U.find(R=>R.id===W.id);return se?{...W,...se}:W});C(w-1),a(H),D(H)}},[x,w,D,o,a]),O=b.useCallback(()=>{if(w<x.length-1){const U=x[w+1],H=o.map(W=>{const se=U.find(R=>R.id===W.id);return se?{...W,...se}:W});C(w+1),a(H),D(H)}},[x,w,D,o,a]);return{history:x,historyIndex:w,setHistory:N,setHistoryIndex:C,persistState:D,saveToHistory:M,undo:B,redo:O}}function bh({filteredPhotos:o,coverSelectionMode:a,setCoverForPhotoId:u,setCoverSelectionMode:d}){const[f,p]=b.useState(new Set),[m,y]=b.useState(null),[x,N]=b.useState(null),w=b.useRef(null),C=b.useCallback(()=>{p(new Set),y(null),N(null),w.current=null},[]),D=b.useCallback(async(M,B,O,U=o)=>{if(M.shiftKey&&w.current!==null&&w.current!==void 0){const H=Math.min(w.current,O),W=Math.max(w.current,O),se=U.slice(H,W+1).map(R=>R.id);p(new Set(se)),y(B),N(O),w.current=O;return}if(M.metaKey||M.ctrlKey){const H=new Set(f);H.has(B)?H.delete(B):H.add(B),p(H),y(B),N(O),w.current=O;return}p(new Set([B])),y(B),N(O),w.current=O,a&&(await u(B),d(!1))},[a,o,f,u,d]);return{selectedPhotos:f,setSelectedPhotos:p,focusedPhoto:m,setFocusedPhoto:y,lastSelectedIndex:x,setLastSelectedIndex:N,lastSelectedIndexRef:w,resetSelection:C,handleSelectPhoto:D}}const yd="narrative-template-demo",vd="Narrative Demo",sa="Narrative Demo Photos",Ch={autoDay:!0,folderStructure:{daysFolder:"01_DAYS",archiveFolder:"98_ARCHIVE",favoritesFolder:"FAV",metaFolder:"_meta"}},Eh=[{id:"OTHER-archive-ARCHIVE_IMG_20230830_05.jpg",originalName:"ARCHIVE_IMG_20230830_05.jpg",currentName:"ARCHIVE_IMG_20230830_05.jpg",timestamp:16933968e5,day:null,bucket:"X",sequence:1,favorite:!1,rating:0,archived:!0,thumbnail:new URL("/narrative-template/assets/ARCHIVE_IMG_20230830_05-B26EskU4.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"OTHER/archive/ARCHIVE_IMG_20230830_05.jpg",sourceFolder:"OTHER/archive",folderHierarchy:["OTHER","archive"],detectedDay:null,detectedBucket:"X",isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"OTHER-archive-ARCHIVE_IMG_20230912_04.jpg",originalName:"ARCHIVE_IMG_20230912_04.jpg",currentName:"ARCHIVE_IMG_20230912_04.jpg",timestamp:169452e7,day:null,bucket:"X",sequence:2,favorite:!1,rating:0,archived:!0,thumbnail:new URL("/narrative-template/assets/misc_004-DFTgQ_hd.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"OTHER/archive/ARCHIVE_IMG_20230912_04.jpg",sourceFolder:"OTHER/archive",folderHierarchy:["OTHER","archive"],detectedDay:null,detectedBucket:"X",isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"OTHER-archive-ARCHIVE_IMG_20231005_03.jpg",originalName:"ARCHIVE_IMG_20231005_03.jpg",currentName:"ARCHIVE_IMG_20231005_03.jpg",timestamp:16965072e5,day:null,bucket:"X",sequence:3,favorite:!1,rating:0,archived:!0,thumbnail:new URL("/narrative-template/assets/misc_003-cieQayo7.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"OTHER/archive/ARCHIVE_IMG_20231005_03.jpg",sourceFolder:"OTHER/archive",folderHierarchy:["OTHER","archive"],detectedDay:null,detectedBucket:"X",isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"OTHER-archive-ARCHIVE_IMG_20231120_02.jpg",originalName:"ARCHIVE_IMG_20231120_02.jpg",currentName:"ARCHIVE_IMG_20231120_02.jpg",timestamp:17004816e5,day:null,bucket:"X",sequence:4,favorite:!1,rating:0,archived:!0,thumbnail:new URL("/narrative-template/assets/misc_002-8M73c77c.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"OTHER/archive/ARCHIVE_IMG_20231120_02.jpg",sourceFolder:"OTHER/archive",folderHierarchy:["OTHER","archive"],detectedDay:null,detectedBucket:"X",isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"OTHER-archive-ARCHIVE_IMG_20231215_01.jpg",originalName:"ARCHIVE_IMG_20231215_01.jpg",currentName:"ARCHIVE_IMG_20231215_01.jpg",timestamp:17026416e5,day:null,bucket:"X",sequence:5,favorite:!1,rating:0,archived:!0,thumbnail:new URL("/narrative-template/assets/misc_001-D3EUaxHp.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"OTHER/archive/ARCHIVE_IMG_20231215_01.jpg",sourceFolder:"OTHER/archive",folderHierarchy:["OTHER","archive"],detectedDay:null,detectedBucket:"X",isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"OTHER-misc_001.jpg",originalName:"misc_001.jpg",currentName:"misc_001.jpg",timestamp:17052408e5,day:null,bucket:null,sequence:1,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/misc_001-D3EUaxHp.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"OTHER/misc_001.jpg",sourceFolder:"OTHER",folderHierarchy:["OTHER"],detectedDay:null,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"OTHER-misc_002.jpg",originalName:"misc_002.jpg",currentName:"misc_002.jpg",timestamp:17052444e5,day:null,bucket:null,sequence:2,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/misc_002-8M73c77c.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"OTHER/misc_002.jpg",sourceFolder:"OTHER",folderHierarchy:["OTHER"],detectedDay:null,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"OTHER-misc_003.jpg",originalName:"misc_003.jpg",currentName:"misc_003.jpg",timestamp:1705248e6,day:null,bucket:null,sequence:3,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/misc_003-cieQayo7.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"OTHER/misc_003.jpg",sourceFolder:"OTHER",folderHierarchy:["OTHER"],detectedDay:null,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"OTHER-misc_004.jpg",originalName:"misc_004.jpg",currentName:"misc_004.jpg",timestamp:17052516e5,day:null,bucket:null,sequence:4,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/misc_004-DFTgQ_hd.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"OTHER/misc_004.jpg",sourceFolder:"OTHER",folderHierarchy:["OTHER"],detectedDay:null,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"Day 1-action.jpg",originalName:"action.jpg",currentName:"action.jpg",timestamp:1770051024647,day:1,bucket:null,sequence:1,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/action-Brgb0oLJ.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 1/action.jpg",sourceFolder:"Day 1",folderHierarchy:["Day 1"],detectedDay:1,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"Day 1-detail.jpg",originalName:"detail.jpg",currentName:"detail.jpg",timestamp:1770051024654,day:1,bucket:null,sequence:2,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/detail-uAHSoAT1.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 1/detail.jpg",sourceFolder:"Day 1",folderHierarchy:["Day 1"],detectedDay:1,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"Day 1-detail_2.jpg",originalName:"detail_2.jpg",currentName:"detail_2.jpg",timestamp:1770051024659,day:1,bucket:null,sequence:3,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/detail_2-Cv0YEruh.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 1/detail_2.jpg",sourceFolder:"Day 1",folderHierarchy:["Day 1"],detectedDay:1,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"Day 1-food.jpg",originalName:"food.jpg",currentName:"food.jpg",timestamp:1770051024664,day:1,bucket:null,sequence:4,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/food-Da0qLuJJ.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 1/food.jpg",sourceFolder:"Day 1",folderHierarchy:["Day 1"],detectedDay:1,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"Day 1-food_2.jpg",originalName:"food_2.jpg",currentName:"food_2.jpg",timestamp:1770051024670,day:1,bucket:null,sequence:5,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/food_2-CfR-s6yh.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 1/food_2.jpg",sourceFolder:"Day 1",folderHierarchy:["Day 1"],detectedDay:1,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"Day 1-people.jpg",originalName:"people.jpg",currentName:"people.jpg",timestamp:1770051024676,day:1,bucket:null,sequence:6,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/people-CwFKBk1e.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 1/people.jpg",sourceFolder:"Day 1",folderHierarchy:["Day 1"],detectedDay:1,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"Day 1-transition.jpg",originalName:"transition.jpg",currentName:"transition.jpg",timestamp:1770051024682,day:1,bucket:null,sequence:7,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/transition-ozCJ6kyj.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 1/transition.jpg",sourceFolder:"Day 1",folderHierarchy:["Day 1"],detectedDay:1,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"Day 2-action.jpg",originalName:"action.jpg",currentName:"action.jpg",timestamp:1770051024686,day:2,bucket:"D",sequence:1,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/action-Brgb0oLJ.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 2/action.jpg",sourceFolder:"Day 2",folderHierarchy:["Day 2"],detectedDay:2,detectedBucket:"D",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 2-detail.jpg",originalName:"detail.jpg",currentName:"detail.jpg",timestamp:1770051024692,day:2,bucket:"C",sequence:2,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/detail-uAHSoAT1.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 2/detail.jpg",sourceFolder:"Day 2",folderHierarchy:["Day 2"],detectedDay:2,detectedBucket:"C",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 2-detail_2.jpg",originalName:"detail_2.jpg",currentName:"detail_2.jpg",timestamp:1770051024696,day:2,bucket:"C",sequence:3,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/detail_2-Cv0YEruh.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 2/detail_2.jpg",sourceFolder:"Day 2",folderHierarchy:["Day 2"],detectedDay:2,detectedBucket:"C",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 2-food.jpg",originalName:"food.jpg",currentName:"food.jpg",timestamp:1770051024700,day:2,bucket:"M",sequence:4,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/food-Da0qLuJJ.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 2/food.jpg",sourceFolder:"Day 2",folderHierarchy:["Day 2"],detectedDay:2,detectedBucket:"M",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 2-food_2.jpg",originalName:"food_2.jpg",currentName:"food_2.jpg",timestamp:1770051024704,day:2,bucket:"M",sequence:5,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/food_2-CfR-s6yh.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 2/food_2.jpg",sourceFolder:"Day 2",folderHierarchy:["Day 2"],detectedDay:2,detectedBucket:"M",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 2-people.jpg",originalName:"people.jpg",currentName:"people.jpg",timestamp:1770051024709,day:2,bucket:"B",sequence:6,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/people-CwFKBk1e.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 2/people.jpg",sourceFolder:"Day 2",folderHierarchy:["Day 2"],detectedDay:2,detectedBucket:"B",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 2-transition.jpg",originalName:"transition.jpg",currentName:"transition.jpg",timestamp:1770051024715,day:2,bucket:"E",sequence:7,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/transition-ozCJ6kyj.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 2/transition.jpg",sourceFolder:"Day 2",folderHierarchy:["Day 2"],detectedDay:2,detectedBucket:"E",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 3-action.jpg",originalName:"action.jpg",currentName:"action.jpg",timestamp:1770051024719,day:3,bucket:"D",sequence:1,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/action-Brgb0oLJ.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 3/action.jpg",sourceFolder:"Day 3",folderHierarchy:["Day 3"],detectedDay:3,detectedBucket:"D",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 3-detail.jpg",originalName:"detail.jpg",currentName:"detail.jpg",timestamp:1770051024725,day:3,bucket:"C",sequence:2,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/detail-uAHSoAT1.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 3/detail.jpg",sourceFolder:"Day 3",folderHierarchy:["Day 3"],detectedDay:3,detectedBucket:"C",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 3-detail_2.jpg",originalName:"detail_2.jpg",currentName:"detail_2.jpg",timestamp:1770051024729,day:3,bucket:null,sequence:3,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/detail_2-Cv0YEruh.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 3/detail_2.jpg",sourceFolder:"Day 3",folderHierarchy:["Day 3"],detectedDay:3,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"Day 3-food.jpg",originalName:"food.jpg",currentName:"food.jpg",timestamp:1770051024734,day:3,bucket:"M",sequence:4,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/food-Da0qLuJJ.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 3/food.jpg",sourceFolder:"Day 3",folderHierarchy:["Day 3"],detectedDay:3,detectedBucket:"M",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 3-food_2.jpg",originalName:"food_2.jpg",currentName:"food_2.jpg",timestamp:1770051024739,day:3,bucket:null,sequence:5,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/food_2-CfR-s6yh.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 3/food_2.jpg",sourceFolder:"Day 3",folderHierarchy:["Day 3"],detectedDay:3,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null},{id:"Day 3-people.jpg",originalName:"people.jpg",currentName:"people.jpg",timestamp:1770051024744,day:3,bucket:"B",sequence:6,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/people-CwFKBk1e.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 3/people.jpg",sourceFolder:"Day 3",folderHierarchy:["Day 3"],detectedDay:3,detectedBucket:"B",isPreOrganized:!0,organizationConfidence:"high",subfolderOverride:null},{id:"Day 3-transition.jpg",originalName:"transition.jpg",currentName:"transition.jpg",timestamp:1770051024749,day:3,bucket:null,sequence:7,favorite:!1,rating:0,archived:!1,thumbnail:new URL("/narrative-template/assets/transition-ozCJ6kyj.jpg",import.meta.url).href,mimeType:"image/jpeg",filePath:"Day 3/transition.jpg",sourceFolder:"Day 3",folderHierarchy:["Day 3"],detectedDay:3,detectedBucket:null,isPreOrganized:!1,organizationConfidence:"low",subfolderOverride:null}],Cr={settings:Ch,photos:Eh,dayLabels:{1:"Day 1",2:"Day 2",3:"Day 3"},dayContainers:[]},Nr={autoDay:!0,folderStructure:{daysFolder:"01_DAYS",archiveFolder:"98_ARCHIVE",favoritesFolder:"FAV",metaFolder:"_meta"}},Ph="narrative:projectState:";function Dh(){const o=Cr.photos[0]?.thumbnail;return{projectId:yd,projectName:vd,rootPath:sa,lastOpened:Date.now(),totalPhotos:Cr.photos.length,...o?{coverUrl:o}:{}}}function _h(o){const a=o.findIndex(f=>f.projectId===yd);if(a===0)return o;const u=a===-1?Dh():{...o[a],lastOpened:Date.now()},d=o.filter((f,p)=>p!==a);return[u,...d].slice(0,20)}function Oh({debugEnabled:o,showToast:a,prevThumbnailsRef:u}){const[d,f]=b.useState([]),[p,m]=b.useState("No Project"),[y,x]=b.useState(null),[N,w]=b.useState(null),[C,D]=b.useState(Nr),[M,B]=b.useState([]),[O,U]=b.useState(!1),[H,W]=b.useState(()=>!Me.get(un)),[se,R]=b.useState(null),[G,ee]=b.useState(null),[T,te]=b.useState(null),[q,I]=b.useState(!1),[de,z]=b.useState(0),[fe,ie]=b.useState("Loading project..."),[ce,le]=b.useState({}),[$,h]=b.useState([]),F=b.useRef(!1),k=b.useRef(!1),g=b.useCallback(()=>{k.current||(k.current=!0,f(Cr.photos),m(vd),x(sa),w(sa),D(Cr.settings||Nr),le(Cr.dayLabels||{}),h(Cr.dayContainers||[]),U(!1),W(!1),R(null),ee(null),te(null),Me.remove(un))},[]),E=b.useCallback(Q=>{const oe=Q.split(/[/\\]/).filter(Boolean);return oe[oe.length-1]||"Untitled Project"},[]),A=b.useCallback((Q,oe)=>{if(!oe)return Q;const he=new Map;return Object.entries(oe).forEach(([Z,ye])=>{const ve=Number.parseInt(Z,10);Number.isNaN(ve)||ye.forEach(Ee=>he.set(Ee,ve))}),Q.map(Z=>({...Z,day:he.get(Z.id)??Z.day}))},[]),V=b.useCallback(Q=>{try{const oe=(Q.photos||[]).map(he=>he.thumbnail).filter(Boolean);u.current.forEach(he=>{if(he&&!oe.includes(he)&&he.startsWith("blob:"))try{URL.revokeObjectURL(he)}catch{}}),u.current=oe}catch{}f(Q.photos||[]),m(Q.projectName||"No Project"),w(Q.rootPath||null),D(Q.settings||Nr),le(Q.dayLabels||{}),h(Q.dayContainers||[])},[u]),re=b.useCallback(Q=>{try{const oe=Me.get(xt),Z=(oe?JSON.parse(oe):[]).map(De=>({...De,projectId:De.projectId||De.rootPath}));let ye=Z.findIndex(De=>De.projectId===Q.projectId);ye===-1&&(ye=Z.findIndex(De=>De.rootPath===Q.rootPath));const Ee={...ye!==-1?Z[ye]:{},...Q},Pe=Z.filter((De,Re)=>Re!==ye),be=[Ee,...Pe].slice(0,20);Me.set(xt,JSON.stringify(be)),B(be)}catch(oe){if(oe instanceof Error&&oe.name==="QuotaExceededError")try{const he=[Q,...M].map((Z,ye)=>{if(ye>=3&&Z.coverUrl){const{coverUrl:ve,...Ee}=Z;return Ee}return Z}).slice(0,20);Me.set(xt,JSON.stringify(he)),B(he),a("Storage limit reached. Kept covers for 3 most recent projects.","info")}catch{try{const Z=[Q,...M.slice(0,9)].map((ye,ve)=>{if(ve>0&&ye.coverUrl){const{coverUrl:Ee,...Pe}=ye;return Pe}return ye});Me.set(xt,JSON.stringify(Z)),B(Z),a("Storage critically low. Removed older project covers.","error")}catch{try{const ye=[{...Q,coverUrl:void 0}];Me.set(xt,JSON.stringify(ye)),B(ye),a("Storage full. Reset to current project only.","error")}catch{Me.remove(xt),B([]),a("Storage exhausted. Unable to save projects.","error")}}}else a("Failed to persist recent project updates. Changes may not be saved.","error")}},[M,a]),ae=b.useCallback((Q,oe)=>{const he=new Map;return oe.forEach(Z=>he.set(Z.folderPath||Z.folder,Z)),Q.map(Z=>{if(!Z.filePath||Z.isPreOrganized&&Z.day!=null&&Z.bucket!=null)return Z;const ye=Z.filePath.split(/[\\/]/),ve=ye.join("/");if(ye.length>1){const Pe=ye[1].match(/^D(\d{1,2})/i);if(Pe){const be=parseInt(Pe[1],10);if(!Number.isNaN(be))return{...Z,day:be}}}for(const[Ee,Pe]of he.entries()){if(!Pe||Pe.skip||Pe.detectedDay==null)continue;const be=Ee.split(/[\\/]/).join("/");if(ve===be||ve.startsWith(`${be}/`))return{...Z,day:Pe.detectedDay}}return Z.day!=null?Z:{...Z,day:null}})},[]),ge=b.useCallback((Q,oe)=>{const he=new Map;return oe.forEach((Z,ye)=>{const ve=Pr(Z);ve!=null&&he.set(Z,ve)}),Q.map(Z=>{if(!Z.filePath||Z.isPreOrganized&&Z.day!=null)return Z;const ye=Z.filePath.split(/[\\/]/),ve=ye.join("/"),Ee=ye[0],Pe=he.get(Ee);if(Pe!=null)return{...Z,day:Pe};for(const[be,De]of he.entries()){const Re=be.split(/[\\/]/).join("/");if(ve===Re||ve.startsWith(`${Re}/`))return{...Z,day:De}}if(ye.length>1){const De=ye[1].match(/^D(\d{1,2})/i);if(De){const Re=parseInt(De[1],10);if(!Number.isNaN(Re))return{...Z,day:Re}}}return Z})},[]),Se=b.useCallback(async(Q,oe)=>{const he=typeof performance<"u"?performance.now():Date.now();console.log("[Performance] Starting project load:",Q),I(!0),z(0),ie("Loading project..."),R(null);try{z(25),ie("Reading project data...");const Z=await wh(Q);z(50),ie("Processing photos...");const ye=ge(Z.photos,Z.dayContainers||[]),ve={...Z,photos:ye};if(z(75),ie("Initializing view..."),V(ve),x(Q),U(!1),W(!1),Me.set(un,Q),z(90),oe?.addRecent!==!1){const De=Me.get(xt),st=(De?JSON.parse(De):[]).map(Ue=>({...Ue,projectId:Ue.projectId||Ue.rootPath}));let ct=st.find(Ue=>Ue.projectId===Q);ct||(ct=st.find(Ue=>Ue.rootPath===Q));const Xe=ct?.coverUrl;re({projectName:Z.projectName||"Untitled Project",projectId:Q,rootPath:Z.rootPath||"Unknown location",lastOpened:Date.now(),totalPhotos:Z.photos?.length||0,...Xe&&{coverUrl:Xe}})}z(100),ee(null);const Pe=(typeof performance<"u"?performance.now():Date.now())-he,be=ye.length;console.log("[Performance] Project loaded in:",Pe.toFixed(2),"ms"),console.log("[Performance] Photo count:",be),be>0&&console.log("[Performance] Time per photo:",(Pe/be).toFixed(2),"ms"),Pe>5e3&&a("Large project loaded. Performance may be slower.","info")}catch(Z){const ye=Z instanceof Error?Z.message:"Failed to load project";console.error("Failed to load project:",Z),R(ye),(ye.includes("access")&&!ye.includes("no longer available")||ye.includes("permission")||ye.includes("granted"))&&ee(Q),a(ye,"error"),Me.remove(un),W(!0)}finally{I(!1),z(0)}},[ge,V,a,re]),J=b.useCallback(async()=>{if(G){I(!0),z(0),ie("Requesting folder access..."),R(null);try{const Q=await Ks(G);if(Q){if(z(25),ie("Re-requesting permissions..."),await Q.requestPermission({mode:"read"})==="granted"){z(50),ie("Loading project..."),await Se(G,{addRecent:!1}),ee(null);return}}else throw new Error("Project folder access is no longer available. Please reselect the folder from the start screen.");throw new Error("Folder access was not granted.")}catch(Q){const oe=Q instanceof Error?Q.message:"Failed to retry permission";console.error("Failed to retry permission:",Q),R(oe),a(oe,"error"),W(!0),ee(null)}finally{I(!1),z(0)}}},[G,Se,a]),Oe=b.useCallback(async(Q,oe)=>{I(!0),z(0),ie("Initializing project..."),R(null);try{if(oe)return z(25),ie("Saving folder access..."),await ua(oe,Q.dirHandle),z(50),ie("Loading project..."),Se(oe),!0;z(5),ie("Requesting folder access...");const he=await xh({dirHandle:Q.dirHandle,projectName:Q.projectName,rootLabel:Q.rootPath,onProgress:(be,De)=>{const Re=5+be*.789;z(Re),ie(De)}});z(80),ie("Processing photo organization...");const Z=Q.mappings?.length?ae(he.photos,Q.mappings):A(he.photos,he.suggestedDays),ye=(Q.mappings||[]).filter(be=>!be.skip).map(be=>be.folderPath||be.folder),ve=Q.projectName?.trim()||E(Q.rootPath);let Ee,Pe;if(oe){Ee=oe,z(80),ie("Loading existing project data...");const be=Me.get(`${Ph}${oe}`),De=be?JSON.parse(be):{},Re=await ca(Q.dirHandle);let st=Re;if(De.edits){const ct=new Map;De.edits.forEach(Xe=>{Xe?.filePath&&ct.set(Xe.filePath,Xe)}),st=Re.map(Xe=>{const Ue=Xe.filePath?ct.get(Xe.filePath):null;return Ue?{...Xe,day:Ue.day,bucket:Ue.bucket,sequence:Ue.sequence,favorite:Ue.favorite,rating:Ue.rating,archived:Ue.archived,currentName:Ue.currentName}:Xe})}Pe={projectName:De.projectName||ve,rootPath:Q.rootPath||Q.dirHandle.name,photos:st,settings:De.settings||Nr,dayContainers:De.dayContainers||ye,dayLabels:De.dayLabels,lastModified:Date.now()}}else Ee=he.projectId,Pe={projectName:ve,rootPath:Q.rootPath||Q.dirHandle.name,photos:Z,settings:Nr,dayContainers:ye};return z(90),ie("Saving project state..."),f(Z),m(ve),x(Ee),w(Q.rootPath||Q.dirHandle.name),D(Nr),U(!1),W(!1),Me.set(un,Ee),z(95),ie("Updating recent projects..."),re({projectName:ve,projectId:Ee,rootPath:Q.rootPath||Q.dirHandle.name,lastOpened:Date.now(),totalPhotos:Z.length}),z(98),ie("Finalizing project..."),await md(Ee,Pe),W(!1),z(100),ee(null),!0}catch(he){return R(he instanceof Error?he.message:"Failed to initialize project"),U(!0),W(!0),!1}finally{I(!1),z(0)}},[ae,A,o,E,Se,re]);return b.useEffect(()=>{if(F.current)return;F.current=!0;let Q=[];try{const ve=Me.get(xt);if(ve)try{const Ee=JSON.parse(ve);Q=Array.isArray(Ee)?Ee.map(be=>({...be,projectId:be.projectId||be.rootPath})):[];const Pe=new Map;Q.forEach(be=>{be.projectId&&!Pe.has(be.projectId)&&Pe.set(be.projectId,be)}),Q=Array.from(Pe.values()),JSON.stringify(Q)!==JSON.stringify(Ee)&&Me.set(xt,JSON.stringify(Q))}catch(Ee){console.warn("Failed to parse recent projects from storage",Ee),Q=[]}}catch{Q=[]}const oe=_h(Q);(oe.length!==Q.length||oe.some((ve,Ee)=>Q[Ee]?.projectId!==ve.projectId))&&Me.set(xt,JSON.stringify(oe)),B(oe),console.log("Loaded recent projects:",oe.map(ve=>({id:ve.projectId,cover:ve.coverUrl?"has cover":"no cover"})));const Z=Me.get(un),ye=typeof globalThis<"u"&&(globalThis.vitest||globalThis.__APP_VERSION__==="0.0.0");Z&&(ye||"showDirectoryPicker"in window)?ye?W(!1):(async()=>{try{await Ks(Z)?Se(Z):W(!0)}catch(ve){console.warn("Error checking stored handle on startup:",ve),W(!0)}})():g()},[g]),{photos:d,setPhotos:f,projectName:p,setProjectName:m,projectRootPath:y,setProjectRootPath:x,projectFolderLabel:N,setProjectFolderLabel:w,projectSettings:C,setProjectSettings:D,recentProjects:M,setRecentProjects:B,showOnboarding:O,setShowOnboarding:U,showWelcome:H,setShowWelcome:W,projectError:se,setProjectError:R,permissionRetryProjectId:G,setPermissionRetryProjectId:ee,projectNeedingReselection:T,setProjectNeedingReselection:te,loadingProject:q,loadingProgress:de,loadingMessage:fe,dayLabels:ce,setDayLabels:le,dayContainers:$,setDayContainers:h,loadProject:Se,retryProjectPermission:J,handleOnboardingComplete:Oe,updateRecentProjects:re,applySuggestedDays:A,applyFolderMappings:ae,applyDayContainers:ge}}function Rh(){const[o,a]=b.useState("folders"),[u,d]=b.useState(!1),[f,p]=b.useState(!1),[m,y]=b.useState(!1),[x,N]=b.useState(null),[w,C]=b.useState(null),[D,M]=b.useState(null),[B,O]=b.useState(null),U=b.useRef({selectedRootFolder:null,selectedDay:null});return{currentView:o,setCurrentView:a,sidebarCollapsed:u,setSidebarCollapsed:d,hideAssigned:f,setHideAssigned:p,showHelp:m,setShowHelp:y,galleryViewPhoto:x,setGalleryViewPhoto:N,fullscreenPhoto:w,setFullscreenPhoto:C,selectedDay:D,setSelectedDay:M,selectedRootFolder:B,setSelectedRootFolder:O,foldersViewStateRef:U}}function Th(){const[o,a]=b.useState(null),u=b.useRef(null),d=b.useCallback(()=>{a(null),u.current&&(window.clearTimeout(u.current),u.current=null)},[]),f=b.useCallback((p,m="info",y)=>{a({message:p,tone:m,actionLabel:y?.actionLabel,onAction:y?.onAction}),u.current&&window.clearTimeout(u.current);const x=y?.durationMs??2500;u.current=window.setTimeout(()=>{a(null),u.current=null},x)},[]);return{toast:o,showToast:f,clearToast:d}}function ia(o,a){return o.sourceRoot?o.sourceRoot:o.ingested!==!1?o.rootPath:zh(a)}function Lh(o,a,u){return ia(o,a)}function zh(o){const a=o.filter(m=>m.filePath);if(a.length===0)return"";const d=a[0].filePath.split("/");let f=0;for(let m=0;m<d.length-1;m++){const y=d.slice(0,m+1).join("/");if(a.every(N=>N.filePath?.startsWith(y+"/")))f=m+1;else break}return d.slice(0,Math.max(f,d.length-2)).join("/")||"/"}async function Ih(o,a,u,d,f,p){const m=[],y=p.folderStructure.daysFolder,x=p.folderStructure.archiveFolder,N={A:"Establishing",B:"People",C:"Culture-Detail",D:"Action-Moment",E:"Transition",M:"Mood-Food"};for(const w of o){if(!w.filePath||!Fh(w,x,f,y,N))continue;let D="";if(w.archived)D=`${u}/${x}/${w.currentName}`;else if(w.bucket&&w.day!==null){const B=f[w.day]||`Day ${String(w.day).padStart(2,"0")}`,O=N[w.bucket]||w.bucket;D=`${u}/${y}/${B}/${w.bucket}_${O}/${w.currentName}`}else D=`${u}/${w.currentName}`;let M=0;try{w.fileHandle&&(M=(await w.fileHandle.getFile()).size)}catch{}m.push({sourcePath:w.filePath,destinationPath:D,fileSize:M,operation:"copy"})}return{timestamp:Date.now(),operations:m,sourceRoot:a,destinationRoot:u,ingested:d}}function Mh(o){const a=[];a.push("#!/bin/bash"),a.push("# Narrative Export Undo Script"),a.push("# This script safely undoes the last export operation"),a.push("set -e"),a.push(""),a.push(`# Export timestamp: ${new Date(o.timestamp).toISOString()}`),a.push(`# Source root: ${o.sourceRoot}`),a.push(`# Destination root: ${o.destinationRoot}`),a.push(`# Ingested: ${o.ingested}`),a.push(""),a.push("RED='\\033[0;31m'"),a.push("GREEN='\\033[0;32m'"),a.push("YELLOW='\\033[1;33m'"),a.push("NC='\\033[0m' # No Color"),a.push(""),a.push('echo "${YELLOW}${NC}"'),a.push('echo "${YELLOW}       UNDO EXPORT - DRY RUN${NC}"'),a.push('echo "${YELLOW}${NC}"'),a.push("echo"),a.push('echo "${YELLOW}This will delete '+o.operations.length+' files created by the export.${NC}"'),a.push('echo "${RED}WARNING: This operation cannot be undone!${NC}"'),a.push("echo"),a.push('echo "${YELLOW}Files to be deleted:${NC}"'),o.operations.forEach((d,f)=>{f<10&&a.push(`echo "  - ${d.destinationPath}"`)}),o.operations.length>10&&a.push(`echo "  ... and ${o.operations.length-10} more files"`),a.push("echo"),a.push('read -r -p "${YELLOW}Type \\"DELETE\\" to confirm deletion (or press Ctrl+C to abort):${NC} " confirm'),a.push('if [ "$confirm" != "DELETE" ]; then'),a.push('  echo "${RED}Aborted - no files were deleted.${NC}"'),a.push("  exit 0"),a.push("fi"),a.push(""),a.push('echo "${GREEN}Starting undo operation...${NC}"'),a.push(""),o.operations.forEach(d=>{a.push("# Delete: "+d.destinationPath),a.push('if [ -f "'+d.destinationPath+'" ]; then'),d.fileSize>0?(a.push('  FILE_SIZE=$(stat -f%z "'+d.destinationPath+'" 2>/dev/null || stat -c%s "'+d.destinationPath+'" 2>/dev/null || echo "0")'),a.push('  if [ "$FILE_SIZE" -eq "'+d.fileSize+'" ]; then'),a.push('    rm "'+d.destinationPath+'"'),a.push('    echo "${GREEN} Deleted: '+d.destinationPath+'${NC}"'),a.push("  else"),a.push('    echo "${RED} Skipped (size mismatch): '+d.destinationPath+'${NC}"'),a.push("  fi")):(a.push('  rm "'+d.destinationPath+'"'),a.push('  echo "${GREEN} Deleted: '+d.destinationPath+'${NC}"')),a.push("else"),a.push('  echo "${YELLOW} File not found: '+d.destinationPath+'${NC}"'),a.push("fi"),a.push("")}),a.push("echo"),a.push('echo "${YELLOW}Cleaning up empty directories...${NC}"');const u=new Set;return o.operations.forEach(d=>{const f=d.destinationPath.substring(0,d.destinationPath.lastIndexOf("/"));u.add(f)}),Array.from(u).sort().reverse().forEach(d=>{a.push('if [ -d "'+d+'" ] && [ -z "$(ls -A "'+d+'")" ]; then'),a.push('  rmdir "'+d+'"'),a.push('  echo "${GREEN} Removed empty directory: '+d+'${NC}"'),a.push("fi")}),a.push(""),a.push("echo"),a.push('echo "${GREEN}${NC}"'),a.push('echo "${GREEN} Undo operation complete!${NC}"'),a.push('echo "${GREEN}${NC}"'),a.join(`
`)}function Fh(o,a,u,d,f){const p=o.originalName!==o.currentName,m=o.bucket&&!o.isPreOrganized,y=o.day!==null&&o.day!==o.detectedDay,x=o.archived&&!o.filePath?.includes(a);let N=!1;if(o.bucket&&o.day!==null){const w=u[o.day]||`Day ${String(o.day).padStart(2,"0")}`,C=f[o.bucket]||o.bucket,D=`${d}/${w}/${o.bucket}_${C}/${o.currentName}`;N=o.filePath!==D&&!o.filePath?.includes(D)}else if(o.archived){const w=`${a}/${o.currentName}`;N=o.filePath!==w&&!o.filePath?.includes(w)}return p||m||y||x||N}function $h(o,a){try{const u=`narrative:exportManifest:${o}`;localStorage.setItem(u,JSON.stringify(a))}catch(u){console.error("Failed to save export manifest:",u)}}function rd(o){try{const a=`narrative:exportManifest:${o}`,u=localStorage.getItem(a);return u?JSON.parse(u):null}catch(a){return console.error("Failed to load export manifest:",a),null}}function Ah(o,a,u,d,f,p){const[m,y]=b.useState(!1),[x,N]=b.useState(""),[w,C]=b.useState("idle"),[D,M]=b.useState(""),[B,O]=b.useState(null),[U,H]=b.useState(!1),[W,se]=b.useState("");b.useEffect(()=>{if(d){const $=rd(d);O($)}},[d]);const R=b.useCallback($=>{const h=[],F=u.folderStructure.daysFolder,k=u.folderStructure.archiveFolder,E=ia({rootPath:d||"",ingested:f,sourceRoot:p},o);let A=$||D||E;const V=gd,re={},ae=[],ge=[];o.forEach(J=>{const Oe=J.originalName!==J.currentName,Q=J.bucket&&!J.isPreOrganized,oe=J.day!==null&&J.day!==J.detectedDay,he=J.archived&&!J.filePath?.includes(k);let Z=!1;if(J.bucket&&J.day!==null){const ve=a[J.day]||`Day ${String(J.day).padStart(2,"0")}`,Ee=V[J.bucket]||J.bucket,Pe=`${F}/${ve}/${J.bucket}_${Ee}/${J.currentName}`;Z=J.filePath!==Pe&&!J.filePath?.includes(Pe)}else if(J.archived){const ve=`${k}/${J.currentName}`;Z=J.filePath!==ve&&!J.filePath?.includes(ve)}if(Oe||Q||oe||he||Z)if(J.archived)ae.push(J);else if(J.bucket){const ve=J.day;re[ve]||(re[ve]={}),re[ve][J.bucket]||(re[ve][J.bucket]=[]),re[ve][J.bucket].push(J)}else ge.push(J)}),h.push("#!/bin/bash"),h.push("# Narrative Export Script - Ingest-Aware Export"),h.push("# This script organizes your photos based on ingest state"),h.push("set -e"),h.push(""),h.push("# Ingest mode: INGESTED (photos in project)"),h.push(""),h.push("# Export script with dry-run first, then safe execution with preview and confirmation."),h.push("# NOTE: Only modified/newly organized photos are included - existing organized files are left untouched."),h.push(""),A?(h.push("# Where should organized photos be saved?"),h.push(`read -r -p "Destination folder [${A}]: " USER_PROJECT_ROOT`),h.push(`PROJECT_ROOT="\${USER_PROJECT_ROOT:-${A}}"`)):(h.push("# Where should organized photos be saved?"),h.push('read -r -p "Destination folder: " PROJECT_ROOT'),h.push('if [ -z "$PROJECT_ROOT" ]; then'),h.push('  echo "Error: Destination folder is required"'),h.push("  exit 1"),h.push("fi")),h.push(""),h.push("# Remove quotes if present"),h.push('PROJECT_ROOT="${PROJECT_ROOT//\\\'/}"'),h.push('PROJECT_ROOT="${PROJECT_ROOT//\\"/}"'),h.push(""),h.push("# Create destination folder if needed"),h.push('mkdir -p "$PROJECT_ROOT"'),h.push(""),h.push(`DAYS_FOLDER="${F}"`),h.push(`ARCHIVE_FOLDER="${k}"`),h.push('TARGET_DAYS_DIR="${PROJECT_ROOT}/${DAYS_FOLDER}"'),h.push('TARGET_ARCHIVE_DIR="${PROJECT_ROOT}/${ARCHIVE_FOLDER}"'),h.push(""),h.push("# Color codes for output"),h.push("RED='\\033[0;31m'"),h.push("GREEN='\\033[0;32m'"),h.push("YELLOW='\\033[1;33m'"),h.push("BLUE='\\033[0;34m'"),h.push("CYAN='\\033[0;36m'"),h.push("BOLD='\\033[1m'"),h.push("NC='\\033[0m' # No Color"),h.push(""),h.push("# Print section header"),h.push("print_section() {"),h.push('  local title="$1"'),h.push('  local line="${BLUE}${NC}"'),h.push('  echo -e ""; echo -e "$line"; echo -e "$title"; echo -e "$line"'),h.push("}"),h.push(""),h.push('print_section "${CYAN}${BOLD} EXPORT PREVIEW${NC}"'),h.push(""),h.push('echo -e "${YELLOW}Project root:${NC}"'),h.push('echo -e "  ${CYAN}${PROJECT_ROOT}${NC}"'),h.push('echo ""'),h.push('echo -e "${YELLOW}Destination folders:${NC}"'),h.push('echo -e "  Days folder:  ${CYAN}${TARGET_DAYS_DIR}${NC}"'),ae.length>0&&h.push('echo -e "  Archive:      ${CYAN}${TARGET_ARCHIVE_DIR}${NC}"'),h.push('echo ""'),h.push('echo -e "${GREEN}${BOLD}  This is a DRY RUN${NC} - no files will be copied yet."'),h.push('echo -e "${GREEN}You will be asked to confirm before any files are moved.${NC}"'),h.push(""),ge.length>0&&(h.push('echo -e "${YELLOW}${BOLD} Root Files${NC} ('+ge.length+')"'),h.push('echo ""'),ge.forEach(J=>{J.filePath&&h.push('echo -e "  ${CYAN}${NC} '+J.currentName+'"')}),h.push('echo ""'));let Se=ge.length+ae.length;return Object.keys(re).forEach(J=>{Object.keys(re[parseInt(J)]).forEach(Oe=>{Se+=re[parseInt(J)][Oe].length})}),h.push('echo -e "${YELLOW}${BOLD} Organized Photos by Day${NC}"'),h.push('echo ""'),Object.keys(re).map(Number).sort((J,Oe)=>J-Oe).forEach(J=>{const Oe=a[J]||`Day ${String(J).padStart(2,"0")}`,Q=re[J],oe=Object.values(Q).reduce((ye,ve)=>ye+ve.length,0);h.push('echo -e "  ${CYAN}'+F+"/"+Oe+"${NC}  ${BOLD}"+oe+'${NC} photos"');const he={};Object.entries(Q).forEach(([ye,ve])=>{ve.forEach(Ee=>{let Pe="root";if(Ee.filePath){const be=Ee.filePath.split(/[\\/]/).filter(Boolean),De=be.findIndex(Re=>Re===Oe);if(De!==-1&&De<be.length-1){const Re=be[De+1];Re&&!Re.match(/^[A-E]_|^M_/)&&(Pe=Re)}}he[Pe]||(he[Pe]={}),he[Pe][ye]||(he[Pe][ye]=[]),he[Pe][ye].push(Ee)})});const Z=Object.keys(he).sort();Z.forEach((ye,ve)=>{const Pe=ve===Z.length-1?"    ":"    ";ye!=="root"&&h.push('echo -e "  '+Pe+" ${CYAN}"+ye+'${NC}"');const be=he[ye],De=Object.keys(be).sort();De.forEach((Re,st)=>{const ct=V[Re]||Re,Xe=be[Re],Ue=st===De.length-1;let Yt;ye!=="root"?Yt=Ue?"      ":"      ":Yt=Ue?"    ":"    ";const Rn=Re+"_"+ct;h.push('echo -e "  '+Yt+" ${CYAN}"+Rn+"${NC} (${BOLD}"+Xe.length+'${NC})"')})}),h.push('echo ""')}),ae.length>0&&(h.push('echo -e "${YELLOW}${BOLD}  Archive${NC} ('+ae.length+')"'),h.push('echo ""')),h.push(""),h.push('echo -e "${YELLOW}${BOLD} Summary${NC}"'),h.push('echo -e "  Total files to copy: ${CYAN}${BOLD}'+Se+'${NC}"'),h.push('echo ""'),h.push('echo -e "${BLUE}${NC}"'),h.push('echo ""'),h.push('echo -e "${RED}${BOLD}  WARNING:${NC} This will copy files to your project directory."'),h.push('echo ""'),h.push('echo -e "${YELLOW}${BOLD}Type ${NC}\\"${GREEN}yes${NC}\\"${YELLOW} to confirm (or press Ctrl+C to abort)${NC}"'),h.push('read -r -p "Confirm: " confirm'),h.push('if [ "$confirm" != "yes" ]; then'),h.push('  echo ""'),h.push('  echo -e "${YELLOW} Aborted${NC} - no files were copied."'),h.push('  echo ""'),h.push("  exit 0"),h.push("fi"),h.push(""),h.push('echo -e "${GREEN}${NC}"'),h.push('echo -e "${GREEN}${BOLD} Copying files...${NC}"'),h.push('echo -e "${GREEN}${NC}"'),h.push('echo ""'),ge.length>0&&(ge.forEach(J=>{J.filePath&&h.push('if [ -e "${PROJECT_ROOT}/'+J.currentName+'" ]; then echo "Skipping existing: '+J.currentName+'"; else cp "${PROJECT_ROOT}/'+J.filePath+'" "${PROJECT_ROOT}/'+J.currentName+'"; fi')}),h.push("")),h.push("# Ingested mode: create day folders with MECE buckets inside"),h.push('mkdir -p "${TARGET_DAYS_DIR}"'),Object.keys(re).map(Number).sort((J,Oe)=>J-Oe).forEach(J=>{const Oe=a[J]||`Day ${String(J).padStart(2,"0")}`,Q=re[J];Object.keys(Q).sort().forEach(oe=>{const he=V[oe]||oe,Z=`${F}/${Oe}/${oe}_${he}`,ye=Q[oe];h.push('mkdir -p "${PROJECT_ROOT}/'+Z+'"'),ye.forEach(ve=>{ve.filePath&&h.push('if [ -e "${PROJECT_ROOT}/'+Z+"/"+ve.currentName+'" ]; then echo "Skipping existing: '+Z+"/"+ve.currentName+'"; else mkdir -p "${PROJECT_ROOT}/'+Z+'" && cp "${PROJECT_ROOT}/'+ve.filePath+'" "${PROJECT_ROOT}/'+Z+"/"+ve.currentName+'"; fi')})})}),ae.length>0&&(h.push('mkdir -p "${TARGET_ARCHIVE_DIR}"'),ae.forEach(J=>{J.filePath&&h.push('if [ -e "${TARGET_ARCHIVE_DIR}/'+J.currentName+'" ]; then echo "Skipping existing: ${TARGET_ARCHIVE_DIR}/'+J.currentName+'"; else cp "${PROJECT_ROOT}/'+J.filePath+'" "${TARGET_ARCHIVE_DIR}/'+J.currentName+'" && echo "Copied: '+J.currentName+'"; fi')})),h.push(""),h.push('echo ""'),h.push('echo -e "${GREEN}${NC}"'),h.push('echo -e "${GREEN}${BOLD} Copy operation complete!${NC}"'),h.push('echo -e "${GREEN}${NC}"'),h.push('echo ""'),h.join(`
`)},[o,a,u,d,D,f,p]),G=b.useCallback(()=>{const $=R();N($),C("idle"),y(!0)},[R]),ee=b.useCallback(()=>{y(!1)},[]),T=b.useCallback(()=>{const $=x||R(),h=new Blob([$],{type:"text/plain"}),F=URL.createObjectURL(h),k=document.createElement("a");k.href=F,k.download="narrative-export.sh",document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(F)},[x,R]),te=b.useCallback(async()=>{const $=x||R();x||N($);try{if(!navigator?.clipboard?.writeText)throw new Error("Clipboard API unavailable");await navigator.clipboard.writeText($),C("copied")}catch{C("failed")}},[x,R]),q=b.useCallback(()=>{C("idle")},[]),I=b.useCallback($=>{M($);const h=R($);N(h)},[R]),de=b.useCallback(()=>{if(D)return D;const $=o.find(h=>h.filePath);if($?.filePath&&$.folderHierarchy){const h=$.folderHierarchy.join("/"),F=$.filePath;if(h&&F.includes(h)){const k=F.lastIndexOf(h);if(k>0)return F.substring(0,k-1)}}if($?.filePath){const h=$.filePath.split("/");if(h.length>3)return h.slice(0,-2).join("/")}return""},[o,D]),z=b.useCallback(async()=>{if(!d)return;const $={rootPath:d,ingested:f,sourceRoot:p},h=ia($,o),F=Lh($,o),k=await Ih(o,h,F,f!==!1,a,u);return O(k),$h(d,k),k},[o,a,u,d,f,p]),fe=b.useCallback(()=>{if(!d)return;const $=rd(d);if(!$){console.warn("No export manifest found for this project");return}const h=Mh($);se(h),H(!0)},[d]),ie=b.useCallback(()=>{H(!1)},[]),ce=b.useCallback(()=>{if(!W)return;const $=new Blob([W],{type:"text/plain"}),h=URL.createObjectURL($),F=document.createElement("a");F.href=h,F.download="narrative-undo-export.sh",document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(h)},[W]),le=b.useCallback(()=>B!==null,[B]);return{showExportScript:m,exportScriptText:x,exportCopyStatus:w,buildExportScript:R,openExportScriptModal:G,closeExportScriptModal:ee,copyExportScript:te,downloadExportScript:T,resetExportCopyStatus:q,regenerateScript:I,getDetectedProjectPath:de,showUndoScript:U,undoScriptText:W,openUndoScriptModal:fe,closeUndoScriptModal:ie,downloadUndoScript:ce,generateManifest:z,hasExportManifest:le}}function Uh(o,a){if(o.timestamp!==a.timestamp)return o.timestamp-a.timestamp;const u=o.filePath||o.originalName||"",d=a.filePath||a.originalName||"",f=u.localeCompare(d);if(f!==0)return f;const p=(o.originalName||"").localeCompare(a.originalName||"");return p!==0?p:o.id.localeCompare(a.id)}function da(o,a={}){const{groupBy:u,separateVideos:d,selectedDay:f,getSubfolderGroup:p,isVideo:m}=a,y=[...o].sort(Uh);if(u==="subfolder"&&f!=null&&p)return Bh(y,f,p,d,m);if(u==="bucket")return Hh(y,d,m);if(u==="day")return Vh(y,d,m);if(d&&m){const x=y.filter(w=>!m(w)),N=y.filter(w=>m(w));return Gs([...x,...N])}return Gs(y)}function Bh(o,a,u,d,f){const p=new Map;o.forEach(w=>{const C=u(w,a);p.has(C)||p.set(C,[]),p.get(C).push(w)});const m=Array.from(p.entries()).sort(([w],[C])=>w==="Day Root"?-1:C==="Day Root"?1:w.localeCompare(C)).map(([w,C])=>({label:w,photos:C})),y=[],x=[];m.forEach(w=>{const C=y.length;if(d&&f){const D=w.photos.filter(B=>!f(B)),M=w.photos.filter(B=>f(B));y.push(...D,...M)}else y.push(...w.photos);x.push({label:w.label,photos:w.photos,startIndex:C})});const N=new Map;return y.forEach((w,C)=>N.set(w.id,C)),{photos:y,indexMap:N,groups:x}}function Hh(o,a,u){const d=["A","B","C","D","E","M","X",null],f=new Map;o.forEach(m=>{const y=m.bucket||null;f.has(y)||f.set(y,[]),f.get(y).push(m)});const p=[];return d.forEach(m=>{if(!f.has(m))return;const y=f.get(m);if(a&&u){const x=y.filter(w=>!u(w)),N=y.filter(w=>u(w));p.push(...x,...N)}else p.push(...y)}),Gs(p)}function Vh(o,a,u){const d=new Map;o.forEach(m=>{const y=m.day??null;d.has(y)||d.set(y,[]),d.get(y).push(m)});const f=Array.from(d.keys()).sort((m,y)=>m===null?1:y===null?-1:m-y),p=[];return f.forEach(m=>{const y=d.get(m);if(a&&u){const x=y.filter(w=>!u(w)),N=y.filter(w=>u(w));p.push(...x,...N)}else p.push(...y)}),Gs(p)}function Gs(o){const a=new Map;return o.forEach((u,d)=>a.set(u.id,d)),{photos:o,indexMap:a}}function Er(o,a){return a.get(o)??-1}function At(o,a,u,d){const f=Er(o,u.indexMap);if(f===-1)return null;const p=a==="next"?1:-1;let m=f+p;if(d){for(;m>=0&&m<u.photos.length;){if(d(u.photos[m]))return u.photos[m];m+=p}return null}return m>=0&&m<u.photos.length?u.photos[m]:null}function Wh(o){const{selectedPhotos:a,focusedPhoto:u,filteredPhotos:d,orderingResult:f,fullscreenPhoto:p,showHelp:m,showExportScript:y,showWelcome:x,showOnboarding:N,coverSelectionMode:w,hideAssigned:C,MECE_BUCKETS:D,onAssignBucket:M,onToggleFavorite:B,onUndo:O,onRedo:U,onSetFocusedPhoto:H,onSetSelectedPhotos:W,onSetLastSelectedIndex:se,onSetFullscreenPhoto:R,onSetShowHelp:G,onSetCoverSelectionMode:ee,onSetHideAssigned:T,onToggleDebugOverlay:te,onShowToast:q,lastSelectedIndexRef:I}=o;b.useEffect(()=>{const de=z=>{const fe=z.target;if(x||N||y||fe&&(fe.tagName==="INPUT"||fe.tagName==="TEXTAREA"||fe.tagName==="SELECT"||fe.isContentEditable))return;if(m){(z.key==="Escape"||z.key==="?")&&G(!1);return}if(w&&z.key==="Escape"){ee(!1),q?.("Cover selection cancelled.");return}if(z.key==="?"){G(!0);return}if(z.key==="H"&&z.shiftKey){z.preventDefault();const g=!C;T(g),q?.(g?"Hiding assigned photos":"Showing all photos","info");return}if(z.key.toLowerCase()==="d"&&z.shiftKey&&(z.ctrlKey||z.metaKey)){z.preventDefault(),te?.();return}if(z.key==="z"&&(z.metaKey||z.ctrlKey)){z.preventDefault(),z.shiftKey?U():O();return}const ie=u||(a.size>0?Array.from(a)[0]:null);if(!ie)return;const ce=g=>{const E=Er(g,f.indexMap);H(g),W(new Set([g])),se(E===-1?null:E),I&&(I.current=E===-1?null:E)};if(z.key.toLowerCase()==="f"&&!z.shiftKey&&!z.metaKey&&!z.ctrlKey&&!z.altKey){const g=a.size>0?Array.from(a):[ie];B(g);return}const le=["A","B","C","D","E","M","X"],$=z.key.toUpperCase(),h=le.includes($),F=$==="F",k=D.some(g=>g.key===$);if(h||k&&!F){z.preventDefault();const g=$;if(a.size>1){const V=Array.from(a);M(V,g),q?.(`Assigned ${V.length} photos to bucket ${g}`,"info"),W(new Set),H(null),se(null),I&&(I.current=null);return}const E=d.find(V=>V.id===ie);if(!E)return;const A=E.bucket===g?"":g;if(M([ie],A),A&&!z.shiftKey){const V=At(ie,"next",f);V&&ce(V.id)}return}if(z.key==="ArrowRight"){const g=At(ie,"next",f);g&&ce(g.id)}else if(z.key==="ArrowLeft"){const g=At(ie,"prev",f);g&&ce(g.id)}else if(z.key==="j"||z.key==="J"){z.preventDefault();const g=z.shiftKey?A=>!A.bucket:void 0,E=At(ie,"next",f,g);E&&ce(E.id)}else if(z.key==="k"||z.key==="K"){z.preventDefault();const g=z.shiftKey?A=>!A.bucket:void 0,E=At(ie,"prev",f,g);E&&ce(E.id)}else z.key==="Enter"||z.key===" "?(z.preventDefault(),R(ie)):z.key==="Escape"&&(p?R(null):(W(new Set),H(null),se(null),I&&(I.current=null)))};return window.addEventListener("keydown",de),()=>window.removeEventListener("keydown",de)},[a,u,f,M,B,O,U,m,p,x,N,y,w,C,D,H,W,se,R,G,ee,T,te,q,I])}function Kh({photos:o,persistState:a,setDayLabels:u}){const[d,f]=b.useState(null),[p,m]=b.useState(""),y=b.useCallback((w,C)=>{f(w),m(C)},[]),x=b.useCallback(w=>{u(C=>({...C,[w]:p})),a(o),f(null)},[p,a,o,u]),N=b.useCallback(()=>{f(null)},[]);return{editingDay:d,editingDayName:p,setEditingDayName:m,startEditingDay:y,saveDayName:x,cancelEditingDay:N}}function Gh({photos:o,dayLabels:a,dayContainers:u,projectSettings:d,debugEnabled:f,currentView:p,selectedDay:m,selectedRootFolder:y,hideAssigned:x}){const N=b.useMemo(()=>{const R=new Map;return o.forEach(G=>{G.day&&(R.has(G.day)||R.set(G.day,[]),R.get(G.day).push(G))}),Array.from(R.entries()).sort((G,ee)=>G[0]-ee[0])},[o]),w=b.useMemo(()=>N.filter(([R])=>a[R]!=null),[N,a]),C=b.useCallback(R=>R.split(/[\\/]/).filter(Boolean).join("/"),[]),D=/^(?:day|d)[\s_-]?(\d{1,2})/i,M=b.useCallback((R,G)=>{const ee=(u||[]).includes(R),T=G.some(ce=>ce.day!==null),te=G.some(ce=>{const le=(ce.filePath||ce.originalName||"").split("/");return le.length>1&&/^D\d{1,2}/i.test(le[1])}),q=N.some(([ce])=>(a[ce]||`Day ${String(ce).padStart(2,"0")}`)===R),I=R===d?.folderStructure?.daysFolder,de=D.test(R)||R.toLowerCase().startsWith("day"),z=T||te||q||I||de;let fe=null;if(T){const ce={};G.forEach(le=>{le.day!=null&&(ce[le.day]=(ce[le.day]||0)+1)}),Object.keys(ce).length&&(fe=Number(Object.entries(ce).sort((le,$)=>$[1]-le[1])[0][0]))}if(fe==null){const ce=R.match(D);if(ce){const le=parseInt(ce[1],10);Number.isNaN(le)||(fe=le)}}const ie=fe!=null?a[fe]||`Day ${String(fe).padStart(2,"0")}`:R;return{isSelected:ee,isDayLike:z,dayNumber:fe,displayName:ie}},[u,a,N,d]),B=b.useCallback(R=>{const G=R.map(([q,I])=>{const de=M(q,I);return{folder:q,items:I,...de}}),ee=G.filter(q=>q.isSelected),T=G.filter(q=>!q.isSelected&&!q.isDayLike),te=G.filter(q=>!q.isSelected&&q.isDayLike);return ee.sort((q,I)=>(q.dayNumber??999)-(I.dayNumber??999)),T.sort((q,I)=>q.folder.localeCompare(I.folder)),te.sort((q,I)=>q.folder.localeCompare(I.folder)),{selected:ee,nonDay:T,dayLike:te}},[M]),O=b.useCallback((R,G)=>{if(G==null)return"Day Root";const T=C(R.filePath||R.originalName||"").split("/").slice(0,-1),te=d?.folderStructure?.daysFolder;let q=-1;if(te){const I=C(te),de=T.findIndex(z=>z.toLowerCase()===I.toLowerCase());if(de!==-1&&de+1<T.length){const z=T[de+1];Pr(z)===G&&(q=de+1)}}return q===-1&&(q=T.findIndex(I=>te&&I.toLowerCase()===te.toLowerCase()?!1:Pr(I)===G)),q!==-1&&q+1<T.length?T[q+1]:"Day Root"},[C,d]),U=b.useCallback((R,G)=>R.subfolderOverride!==void 0?R.subfolderOverride??"Day Root":O(R,G),[O]),H=b.useMemo(()=>{const R=new Map;for(const G of o){if(G.archived)continue;const ee=(G.filePath||G.originalName||"").split(/[\\/]/),T=ee.length>1?ee[0]:"(root)";R.has(T)||R.set(T,[]),R.get(T).push(G)}return Array.from(R.entries()).sort((G,ee)=>G[0].localeCompare(ee[0]))},[o]),W=b.useMemo(()=>{const R=new Map(H);return(u||[]).forEach(G=>{const ee=C(G).split("/")[0];R.has(ee)||R.set(ee,[])}),Array.from(R.entries())},[H,u,C]);b.useEffect(()=>{},[f,N,a,o,u,d,H,M]);const se=b.useMemo(()=>{const R=T=>!!T.bucket||T.isPreOrganized&&!!T.detectedBucket,G=T=>!x||!R(T)&&!T.archived;let ee=[];switch(p){case"days":if(m!==null){ee=o.filter(T=>!T.archived&&T.day===m).filter(G);break}ee=o.filter(T=>T.day!==null&&!T.archived).filter(G);break;case"folders":if(y!==null){ee=o.filter(T=>{if(T.archived)return!1;const te=C(T.filePath||T.originalName||""),q=C(y),I=te.split("/")[0]||"(root)";return(q.includes("/")?te===q||te.startsWith(`${q}/`):I===q)&&G(T)});break}if(m!==null){ee=o.filter(T=>!T.archived&&T.day===m).filter(G);break}ee=[];break;case"root":if(y!==null){ee=o.filter(T=>!T.archived&&(C(T.filePath||T.originalName||"").split("/")[0]||"(root)")===C(y)&&G(T));break}ee=[];break;case"favorites":ee=o.filter(T=>T.favorite&&!T.archived).filter(G);break;case"archive":ee=o.filter(T=>T.archived).filter(G);break;case"review":ee=o.filter(T=>T.bucket&&!T.archived).filter(G);break;default:ee=o.filter(G);break}return da(ee).photos},[o,x,p,m,y,C]);return{days:N,visibleDays:w,normalizePath:C,categorizeFolder:M,sortFolders:B,getDerivedSubfolderGroup:O,getSubfolderGroup:U,rootGroups:H,displayRootGroups:W,filteredPhotos:se}}function Qh({photos:o,projectRootPath:a,projectName:u,projectFolderLabel:d,setRecentProjects:f,showToast:p}){return{setCoverForPhotoId:b.useCallback(async y=>{if(!a)return;const x=o.find(N=>N.id===y);if(!x){p("Selected photo is no longer available.","error");return}try{let N;if(x.fileHandle)N=await x.fileHandle.getFile();else if(x.thumbnail)N=await(await fetch(x.thumbnail)).blob();else{p("Cannot create cover from this photo.","error");return}const w=`original (${(N.size/1024).toFixed(1)}KB)`;await Hp(10);const C=await Fp(a,N,0,0),D=Me.get(xt),B=(D?JSON.parse(D):[]).map(H=>({...H,projectId:H.projectId||H.rootPath}));let O=B.findIndex(H=>H.projectId===a);O===-1&&(O=B.findIndex(H=>H.rootPath===a));const U=B.map((H,W)=>W===O?{...H,coverKey:C,lastOpened:Date.now()}:H);O===-1&&U.unshift({projectName:u||"Untitled Project",projectId:a,rootPath:d||a,lastOpened:Date.now(),totalPhotos:o.length,coverKey:C}),Me.set(xt,JSON.stringify(U.slice(0,20))),f(U.slice(0,20)),console.log(`Cover saved to IndexedDB (${w}):`,a),p("Cover photo updated.")}catch(N){console.error("Failed to set cover photo:",N),p("Failed to set cover photo.","error")}},[o,a,u,d,f,p])}}function Yh({photos:o,saveToHistory:a,selectedDay:u}){const d=b.useCallback((m,y,x=null)=>{const N=Array.isArray(m)?m:[m],w={},C=o.map(D=>{if(!N.includes(D.id))return D;if(!y)return{...D,bucket:null,sequence:null,archived:!1,currentName:D.originalName};const M=x||D.day||u||Math.ceil(new Date(D.timestamp).getDate()/1),B=`${M}_${y}`,O=o.filter(W=>W.day===M&&W.bucket===y).length,U=(w[B]||O)+1;w[B]=U;const H=y==="X"?D.originalName:`D${String(M).padStart(2,"0")}_${y}_${String(U).padStart(3,"0")}__${D.originalName}`;return{...D,bucket:y,day:M,sequence:U,currentName:H,archived:y==="X"}});a(C)},[o,a,u]),f=b.useCallback(m=>{const y=Array.isArray(m)?m:[m],x=o.map(N=>y.includes(N.id)?{...N,day:null}:N);a(x)},[o,a]),p=b.useCallback(m=>{const y=Array.isArray(m)?m:[m],x=o.map(N=>y.includes(N.id)?{...N,favorite:!N.favorite}:N);a(x)},[o,a]);return{assignBucket:d,removeDayAssignment:f,toggleFavorite:p}}function qh({projectRootPath:o,photosLength:a,selectedRootFolder:u,selectedDay:d,currentView:f,days:p,rootGroups:m,setSelectedDay:y,setSelectedRootFolder:x}){b.useEffect(()=>{if(!o||a===0||u!==null||d!==null||f!=="folders")return;const N=p[0]?.[0]??null;if(N!==null){y(N);return}const w=m[0]?.[0];w&&x(w)},[o,a,u,d,f,m,p,y,x])}function Jh({projectRootPath:o,selectedPhotos:a,showToast:u,setCoverForPhotoId:d}){return{setCoverFromSelection:b.useCallback(async()=>{if(!o)return;if(a.size===0){u("Select a photo to set as cover.");return}if(a.size>1){u("Select a single photo to set as cover.");return}const p=Array.from(a)[0];await d(p)},[o,a,u,d])}}function Xh({handleOnboardingCompleteInternal:o,setHistory:a,setHistoryIndex:u,resetSelection:d,setSelectedDay:f,setSelectedRootFolder:p,setCurrentView:m}){return{handleOnboardingComplete:b.useCallback(async(x,N)=>{await o(x,N)&&(a([]),u(-1),d(),f(null),p(null),m("folders"))},[o,d,m,a,u,f,p])}}function Zh({showWelcome:o,projectName:a,stats:u,currentVersion:d,coverSelectionMode:f,selectedPhotosCount:p,projectRootPath:m,currentView:y,hideAssigned:x,recentProjects:N,projectError:w,permissionRetryProjectId:C,loadingProject:D,hasExportManifest:M,onMainMenu:B,onStartCoverSelection:O,onUseCoverSelection:U,onCancelCoverSelection:H,onSelectRecentProject:W,onOpenProject:se,onDeleteProject:R,onImportTrip:G,onExportScript:ee,onUndoExport:T,onShowHelp:te,onRetryPermission:q,onChangeView:I,onToggleHideAssigned:de,onRememberFoldersViewState:z,onRestoreFoldersViewState:fe,onClearDaySelection:ie}){const[ce,le]=b.useState(!1);return o?null:s.jsxs("header",{className:"border-b border-gray-800 bg-gray-900",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-3",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("img",{src:"/Narrative/assets/Narrative_icon.png",alt:"Narrative",className:"w-8 h-8 rounded"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-lg font-semibold text-gray-100",children:a}),s.jsxs("p",{className:"text-xs text-gray-400",children:[u.sorted," sorted  ",u.root," root  ",u.favorites," ","favorites"]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:d}),s.jsx("button",{onClick:()=>{le(!1),B()},className:"px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm font-medium",title:"Back to the main menu",children:"Main Menu"}),m&&s.jsx("button",{onClick:O,className:`px-3 py-1 rounded text-sm font-medium ${f?"bg-yellow-200 text-yellow-900":"bg-gray-800 hover:bg-gray-700 text-gray-100"}`,title:"Set cover from selected photo",children:f?"Selecting":"Set Cover"}),f&&s.jsxs("div",{className:"px-3 py-1 bg-yellow-50 text-yellow-900 rounded text-sm flex items-center gap-3",children:[s.jsx("span",{children:"Select a photo to set as cover"}),p===1&&s.jsx("button",{onClick:U,className:"underline",children:"Use selection"}),s.jsx("button",{onClick:H,className:"underline",children:"Cancel"})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>le($=>!$),className:"px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm font-medium flex items-center gap-1",title:"Open recent projects","aria-expanded":ce,children:["Projects",s.jsx(id,{className:"w-4 h-4"})]}),ce&&s.jsxs("div",{className:"absolute right-0 mt-2 w-72 rounded-lg border border-gray-800 bg-gray-900 shadow-xl z-20",children:[s.jsx("div",{className:"px-3 py-2 text-xs uppercase tracking-wide text-gray-400 border-b border-gray-800",children:"Recent Projects"}),N.length===0?s.jsx("div",{className:"px-3 py-3 text-sm text-gray-400",children:"No recent projects yet."}):s.jsx("div",{className:"max-h-64 overflow-y-auto",children:N.map($=>s.jsxs("button",{onClick:()=>{le(!1),W($.projectId)},className:"w-full text-left px-3 py-2 hover:bg-gray-800",children:[s.jsx("div",{className:"text-sm text-gray-100",children:$.projectName}),s.jsx("div",{className:"text-xs text-gray-500 truncate",children:$.rootPath})]},$.projectId))}),s.jsx("div",{className:"border-t border-gray-800",children:s.jsx("button",{onClick:()=>{le(!1),se()},className:"w-full text-left px-3 py-2 text-sm text-blue-300 hover:bg-gray-800",children:"Open Project"})})]})]}),m&&s.jsx("button",{onClick:R,className:"px-3 py-1 bg-red-700 hover:bg-red-800 rounded text-sm font-medium",title:"Delete project",children:"Delete"}),s.jsxs("button",{onClick:G,className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-sm font-medium flex items-center gap-1",title:"Import existing trip folder",disabled:D,children:[D?s.jsx(Ys,{className:"w-4 h-4 animate-spin"}):s.jsx(aa,{className:"w-4 h-4"}),"Import Trip"]}),s.jsx("button",{onClick:ee,className:"px-3 py-1 bg-gray-800 hover:bg-gray-700 rounded text-sm font-medium",title:"Export rename script",disabled:u.total===0,children:"Export Script"}),M&&T&&s.jsx("button",{onClick:T,className:"px-3 py-1 bg-yellow-800 hover:bg-yellow-700 rounded text-sm font-medium",title:"Undo last export",children:"Undo Export"}),s.jsx("button",{onClick:te,className:"p-2 hover:bg-gray-800 rounded",title:"Show shortcuts (?)",children:"?"})]})]}),s.jsx("div",{className:"flex gap-1 px-6 pb-2",children:[{id:"folders",label:"Folders",count:u.root},{id:"favorites",label:"Favorites",count:u.favorites},{id:"archive",label:"Archive",count:u.archived},{id:"review",label:"Review",count:u.sorted}].map($=>s.jsxs("button",{onClick:()=>{y==="folders"&&z(),I($.id),$.id==="folders"?fe():ie()},className:`px-4 py-2 rounded-t text-sm font-medium transition-colors ${y===$.id?"bg-gray-950 text-blue-400":"text-gray-400 hover:text-gray-200"}`,children:[$.label," ",$.count>0&&s.jsxs("span",{className:"text-xs opacity-60",children:["(",$.count,")"]})]},$.id))}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 px-6 pb-3",children:[x&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-600/20 border border-blue-500/30 rounded-lg",children:[s.jsx("span",{className:"text-xs text-blue-300",children:"Skip Assigned: ON"}),s.jsx("kbd",{className:"text-xs text-blue-200",children:"Shift+H to toggle"})]}),s.jsx("button",{onClick:de,className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${x?"bg-blue-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:x?"Show All":"Hide Assigned"})]}),w&&s.jsx("div",{className:"mx-6 mb-3 rounded-lg border border-red-800 bg-red-950/60 px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-red-200",children:w}),C&&s.jsx("button",{onClick:q,className:"ml-3 px-3 py-1 bg-red-700 hover:bg-red-600 text-white text-xs rounded transition-colors",children:"Try Again"})]})})]})}function em({currentView:o,sidebarCollapsed:a,onCollapseSidebar:u,onExpandSidebar:d,visibleDays:f,selectedDay:p,selectedRootFolder:m,onSelectDay:y,onSelectRootFolder:x,editingDay:N,editingDayName:w,onChangeEditingDayName:C,onStartEditingDay:D,onSaveDayName:M,onCancelEditingDay:B,onClearSelectedDay:O,days:U,dayLabels:H,dayContainers:W,photos:se,normalizePath:R,rootGroups:G,displayRootGroups:ee,sortFolders:T,projectSettings:te,debugEnabled:q}){return o==="days"&&a?s.jsx("button",{onClick:d,className:"w-12 border-r border-gray-800 bg-gray-900 flex items-center justify-center hover:bg-gray-800 transition-colors","aria-label":"Expand sidebar",title:"Expand sidebar",children:s.jsx(Us,{className:"w-4 h-4 text-gray-400 rotate-180"})}):o==="days"?s.jsx("aside",{className:"w-48 border-r border-gray-800 bg-gray-900 overflow-y-auto",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase",children:"Days"}),s.jsx("button",{onClick:u,className:"p-1 hover:bg-gray-800 rounded","aria-label":"Collapse sidebar",title:"Collapse sidebar",children:s.jsx(Us,{className:"w-4 h-4 text-gray-400"})})]}),s.jsx("div",{className:"space-y-1",children:f.map(([I,de])=>s.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{x(null),y(I)},onKeyDown:z=>{z.key==="Enter"&&(x(null),y(I))},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${p===I?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[s.jsx("div",{className:"flex items-center justify-between",children:N===I?s.jsxs("div",{className:"flex items-center gap-2 w-full",children:[s.jsx("input",{value:w,onChange:z=>C(z.target.value),className:"w-full px-2 py-1 rounded bg-gray-800 text-sm text-gray-100"}),s.jsx("button",{onClick:z=>{z.stopPropagation(),M(I)},className:"p-1 bg-green-600 rounded","aria-label":"Save day name",children:s.jsx(Xo,{className:"w-4 h-4"})}),s.jsx("button",{onClick:z=>{z.stopPropagation(),B()},className:"p-1 bg-gray-800 rounded","aria-label":"Cancel",children:s.jsx(Gt,{className:"w-4 h-4"})})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"font-medium",children:H[I]||`Day ${String(I).padStart(2,"0")}`}),s.jsxs("div",{className:"flex items-center gap-2",children:[p===I&&s.jsx("button",{onClick:z=>{z.stopPropagation(),O()},className:"px-2 py-0.5 rounded bg-gray-800 text-xs text-gray-300 hover:text-white","aria-label":"Clear day selection",title:"Clear day selection",children:"Clear"}),s.jsx("button",{onClick:z=>{z.stopPropagation(),D(I,H[I]||`Day ${String(I).padStart(2,"0")}`)},className:"p-1","aria-label":`Edit day ${I}`,children:s.jsx(Jo,{className:"w-4 h-4 text-gray-400"})})]})]})}),s.jsxs("div",{className:"text-xs opacity-70",children:[de.length," photos"]})]},I))})]})}):o!=="folders"?null:s.jsx("aside",{className:"w-48 border-r border-gray-800 bg-gray-900 overflow-y-auto",children:s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase mb-3",children:"Days"}),s.jsx("div",{className:"space-y-1 mb-4",children:(()=>{const I=new Map,de=W||[],z=[],fe=[];de.forEach(k=>{const g=R(k);g.includes("/")?fe.push(g):z.push(g)});const ie=k=>{const g=R(k);return se.filter(E=>{const A=R(E.filePath||E.originalName||"");return A===g||A.startsWith(`${g}/`)})};U.forEach(([k,g])=>{I.has(k)||I.set(k,{dayNumber:k,photos:g,folderName:null})}),fe.forEach(k=>{const g=k.split("/").slice(-1)[0],E=Pr(g);E==null||I.has(E)||I.set(E,{dayNumber:E,photos:ie(k),folderName:k})});const ce=te?.folderStructure?.daysFolder;if(ce){const k=R(ce),g=new Map;se.forEach(E=>{const V=R(E.filePath||E.originalName||"").split("/");if(V.length<2||V[0]!==k)return;const re=Pr(V[1]);re!=null&&(g.has(re)||g.set(re,[]),g.get(re).push(E))}),g.forEach((E,A)=>{I.has(A)||I.set(A,{dayNumber:A,photos:E,folderName:`${k}/${H[A]||`Day ${String(A).padStart(2,"0")}`}`})})}const le=T(ee),$=[...le.selected,...le.nonDay,...le.dayLike];q&&console.debug("[PhotoOrganizer] Folder categorization:",{selected:le.selected.map(k=>k.folder),nonDay:le.nonDay.map(k=>k.folder),dayLike:le.dayLike.map(k=>k.folder)}),G.forEach(([k,g])=>{const E=$.find(A=>A.folder===k);if(E&&E.isDayLike&&E.dayNumber!==null&&!I.has(E.dayNumber)){const A=g.filter(V=>V.day===E.dayNumber||V.day===null);I.set(E.dayNumber,{dayNumber:E.dayNumber,photos:A,folderName:k})}});const h=Array.from(I.values()).sort((k,g)=>k.dayNumber-g.dayNumber),F=z.filter(k=>$.find(E=>E.folder===k)?.dayNumber===null);return s.jsxs(s.Fragment,{children:[h.map(k=>s.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{x(null),y(k.dayNumber)},onKeyDown:g=>{g.key==="Enter"&&(x(null),y(k.dayNumber))},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${p===k.dayNumber?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[s.jsx("div",{className:"flex items-center justify-between",children:N===k.dayNumber?s.jsxs("div",{className:"flex items-center gap-2 w-full",children:[s.jsx("input",{value:w,onChange:g=>C(g.target.value),className:"w-full px-2 py-1 rounded bg-gray-800 text-sm text-gray-100"}),s.jsx("button",{onClick:g=>{g.stopPropagation(),M(k.dayNumber)},className:"p-1 bg-green-600 rounded","aria-label":"Save day name",children:s.jsx(Xo,{className:"w-4 h-4"})}),s.jsx("button",{onClick:g=>{g.stopPropagation(),B()},className:"p-1 bg-gray-800 rounded","aria-label":"Cancel",children:s.jsx(Gt,{className:"w-4 h-4"})})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"font-medium",children:H[k.dayNumber]||`Day ${String(k.dayNumber).padStart(2,"0")}`}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("button",{onClick:g=>{g.stopPropagation(),D(k.dayNumber,H[k.dayNumber]||`Day ${String(k.dayNumber).padStart(2,"0")}`)},className:"p-1","aria-label":`Edit day ${k.dayNumber}`,children:s.jsx(Jo,{className:"w-4 h-4 text-gray-400"})})})]})}),s.jsxs("div",{className:"text-xs opacity-70",children:[k.photos.length," photos"]})]},`day-${k.dayNumber}`)),F.map(k=>s.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{x(k),y(null)},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${m===k?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"font-medium",children:k}),s.jsx("div",{className:"text-xs px-2 py-0.5 rounded bg-gray-700 text-gray-300",children:"Container"})]}),s.jsxs("div",{className:"text-xs opacity-70",children:[G.find(([g])=>g===k)?.[1].length||0," ","photos"]})]},`container-${k}`))]})})()}),s.jsx("h3",{className:"text-xs font-semibold text-gray-400 uppercase mb-3",children:"Other"}),s.jsx("div",{className:"space-y-1",children:(()=>{const{selected:I,nonDay:de}=T(ee),z=te?.folderStructure?.daysFolder,fe=[];if(z){const ce=R(z),le=new Map;se.forEach($=>{if($.archived)return;const F=R($.filePath||$.originalName||"").split("/");if(F.length<3||F[0]!==ce||Pr(F[1])!=null)return;const g=F[1],E=`${ce}/${g}`;le.has(E)||le.set(E,[]),le.get(E).push($)}),le.forEach(($,h)=>{fe.push({key:h,label:h,items:$})})}const ie=[...de.map(ce=>({key:ce.folder,label:ce.folder,items:ce.items})),...fe];return s.jsxs(s.Fragment,{children:[ie.map(ce=>s.jsxs("div",{role:"button",tabIndex:0,onClick:()=>{x(ce.key),y(null)},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${m===ce.key?"bg-blue-600 text-white":"hover:bg-gray-800 text-gray-300"}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"font-medium",children:ce.label}),s.jsx("div",{className:"flex gap-2"})]}),s.jsxs("div",{className:"text-xs opacity-70",children:[ce.items.length," photos (",ce.items.filter(le=>le.day===null).length," unsorted)"]})]},ce.key)),ie.length===0&&s.jsx("div",{className:"text-xs text-gray-400",children:"No other folders"})]})})()})]})})}const tm=async o=>{try{const a=await o.getFile();return new Promise(u=>{const d=document.createElement("video"),f=document.createElement("canvas"),p=f.getContext("2d"),m=()=>{f.width=d.videoWidth,f.height=d.videoHeight,d.currentTime=0},y=()=>{if(p){p.drawImage(d,0,0);const x=f.toDataURL("image/jpeg",.8);d.removeEventListener("loadedmetadata",m),d.removeEventListener("seeked",y),u(x)}};d.addEventListener("loadedmetadata",m),d.addEventListener("seeked",y),d.src=URL.createObjectURL(a),d.load(),setTimeout(()=>{d.removeEventListener("loadedmetadata",m),d.removeEventListener("seeked",y),u(null)},2e3)})}catch(a){return console.error("Failed to generate video thumbnail:",a),null}},nm=({photos:o,currentPhotoId:a,onSelectPhoto:u,visibleCount:d=7})=>{const f=b.useRef(null),p=b.useRef(null),[m,y]=b.useState({});b.useEffect(()=>{(async()=>{const U=o.filter(H=>H.mimeType?.startsWith("video/")&&!m[H.id]);for(const H of U)if(H.fileHandle){const W=await tm(H.fileHandle);y(se=>({...se,[H.id]:W}))}})()},[o]),b.useEffect(()=>{if(p.current&&f.current){const O=f.current,U=p.current,H=O.getBoundingClientRect(),W=U.getBoundingClientRect();(W.left<H.left||W.right>H.right)&&U.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},[a]);const x=O=>{if(f.current){const U=f.current.clientWidth*.7;f.current.scrollBy({left:O==="right"?U:-U,behavior:"smooth"})}},N=o.findIndex(O=>O.id===a),w=N>0,C=N<o.length-1,D=o.filter(O=>!O.mimeType?.startsWith("video/")),M=o.filter(O=>O.mimeType?.startsWith("video/")),B=(O,U)=>{const H=O.id===a,W=O.bucket?{A:"bg-blue-500",B:"bg-purple-500",C:"bg-green-500",D:"bg-orange-500",E:"bg-yellow-500",M:"bg-indigo-500",X:"bg-gray-500"}[O.bucket]||"bg-gray-500":null,se=O.mimeType?.startsWith("video/")&&m[O.id]||O.thumbnail;return s.jsxs("button",{ref:H?p:null,onClick:()=>u(O.id),className:`relative flex-shrink-0 group ${H?"ring-4 ring-blue-500 shadow-xl scale-110":"hover:ring-2 hover:ring-gray-600"} transition-all duration-200 rounded-lg overflow-hidden`,style:{width:"120px",height:"90px"},"aria-label":`${O.currentName}${H?" (current)":""}`,"aria-current":H?"true":void 0,children:[se?s.jsx("img",{src:se,alt:O.currentName,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full bg-gray-800 flex items-center justify-center",children:s.jsx("span",{className:"text-xs text-gray-500 text-center px-2 break-words",children:O.currentName})}),O.mimeType?.startsWith("video/")&&s.jsx("div",{className:"absolute top-1 left-1 bg-black/70 rounded p-1",children:s.jsx(Sp,{className:"w-3 h-3 text-white"})}),W&&s.jsx("div",{className:`absolute top-1 right-1 ${W} text-white text-xs font-bold rounded px-1.5 py-0.5 shadow-lg`,children:O.bucket}),O.favorite&&s.jsx("div",{className:"absolute bottom-1 right-1 bg-yellow-500 text-white text-xs rounded-full p-1",children:s.jsx("svg",{className:"w-3 h-3 fill-current",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})})}),!H&&s.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:s.jsxs("span",{className:"text-white text-xs font-medium",children:["#",U+1]})}),H&&s.jsx("div",{className:"absolute inset-0 pointer-events-none",children:s.jsx("div",{className:"absolute inset-0 bg-blue-500/10"})})]},O.id)};return s.jsxs("div",{className:"relative bg-gray-900 border-t border-gray-800",children:[w&&s.jsx("button",{onClick:()=>x("left"),className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 p-2 bg-gray-950/80 hover:bg-gray-800 rounded-lg text-gray-300 hover:text-white transition-colors shadow-lg","aria-label":"Scroll left",children:s.jsx(Us,{className:"w-5 h-5"})}),s.jsxs("div",{ref:f,className:"flex items-center gap-3 px-12 py-4 overflow-x-auto scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-gray-900",style:{scrollbarWidth:"thin"},children:[D.length>0&&s.jsxs(s.Fragment,{children:[D.map((O,U)=>B(O,U)),M.length>0&&s.jsx("div",{className:"h-20 border-l border-gray-700 mx-2"})]}),M.length>0&&s.jsx("div",{className:"flex gap-3",children:M.map((O,U)=>{const H=o.findIndex(W=>W.id===O.id);return B(O,H)})})]}),C&&s.jsx("button",{onClick:()=>x("right"),className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 p-2 bg-gray-950/80 hover:bg-gray-800 rounded-lg text-gray-300 hover:text-white transition-colors shadow-lg","aria-label":"Scroll right",children:s.jsx(od,{className:"w-5 h-5"})}),s.jsxs("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 bg-gray-950/80 px-3 py-1 rounded-full text-xs text-gray-300",children:[N+1," / ",o.length]})]})},rm=({photo:o,filteredPhotos:a,orderingResult:u,onClose:d,onNavigate:f,onToggleFavorite:p,onAssignBucket:m,onAssignDay:y,selectedBucket:x,selectedDay:N,buckets:w,dayLabels:C={},onShowToast:D})=>{const[M,B]=b.useState(Er(o.id,u.indexMap)),[O,U]=b.useState(null),[H,W]=b.useState(!1),[se,R]=b.useState(null),[G,ee]=b.useState(!0),[T,te]=b.useState(!0),q=b.useRef(null);b.useEffect(()=>{const h=Er(o.id,u.indexMap);h!==-1&&h!==M&&B(h)},[u.indexMap,o.id,M]);const I=u.photos[M]||o,de=b.useCallback(h=>!h.bucket&&!h.archived,[]),z=u.photos.filter(de).length,fe=z;b.useEffect(()=>(R(null),(async()=>{O&&(I.fileHandle&&q.current===O||!I.fileHandle&&I.thumbnail===O)||(W(!0),q.current=null);try{if(I.fileHandle){const k=await I.fileHandle.getFile(),g=URL.createObjectURL(k);q.current=g,U(g)}else I.thumbnail?U(I.thumbnail):R("No image data available")}catch(k){console.error("Failed to load full resolution image:",k),I.thumbnail?U(I.thumbnail):R("Failed to load image")}finally{W(!1)}})(),()=>{if(q.current&&q.current.startsWith("blob:"))try{URL.revokeObjectURL(q.current)}catch{}}),[I.id,I.fileHandle,I.thumbnail]),b.useEffect(()=>{const F=setTimeout(async()=>{const k=Math.min(M+1,u.photos.length-1),g=Math.max(M-1,0),E=[k,g].filter(A=>A!==M);for(const A of E){const V=u.photos[A];if(V?.fileHandle)try{await V.fileHandle.getFile()}catch{}}},100);return()=>clearTimeout(F)},[M,a]);const ie=b.useCallback(h=>{const F=At(I.id,h,u);if(!F)return;const k=Er(F.id,u.indexMap);k!==-1&&(B(k),f(F.id))},[I.id,u,f]),ce=b.useCallback(h=>{const F=Er(h,u.indexMap);F!==-1&&F!==M&&(B(F),f(h))},[u.indexMap,M,f]),le=b.useCallback(h=>{const F=u.photos[M];if(F)if(h.key==="Escape")h.preventDefault(),d();else if(h.key==="ArrowRight")h.preventDefault(),ie("next");else if(h.key==="ArrowLeft")h.preventDefault(),ie("prev");else if(h.key===" "||h.key.toLowerCase()==="n"){h.preventDefault();const k=At(F.id,"next",u,de);k?(f(k.id),D?.(`${Math.max(fe-1,0)} unassigned remaining`,"info",{durationMs:1e3})):D?.("No more unassigned photos","info")}else if(h.key==="f"||h.key==="F")h.preventDefault(),p(F.id);else if(h.key.toLowerCase()==="x")h.preventDefault(),m(F.id,"X");else{const k=h.key.toUpperCase();if(["A","B","C","D","E","M"].includes(k)){h.preventDefault();const E=F.bucket===k?"":k;if(m(F.id,E),E){const A=At(F.id,"next",u,de);A&&f(A.id)}}}},[M,u,d,ie,p,m,fe,de,f,D]);b.useEffect(()=>(window.addEventListener("keydown",le),()=>window.removeEventListener("keydown",le)),[le]);const $=w.find(h=>h.key===I.bucket);return s.jsxs("div",{className:"fixed inset-0 bg-black z-40 flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-3 border-b border-gray-800 bg-gray-900/95 backdrop-blur",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Gallery View"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"text-sm text-gray-400 text-right",children:[s.jsxs("div",{children:[M+1," / ",u.photos.length]}),z>0&&s.jsxs("div",{className:"text-xs text-blue-300",children:["(",z," unassigned)"]})]}),s.jsx("button",{onClick:d,className:"p-2 hover:bg-gray-800 rounded-lg transition-colors","aria-label":"Close gallery view",children:s.jsx(Gt,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"flex-1 flex items-center justify-center bg-gray-950 overflow-hidden relative",children:[H&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/50 z-10",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ys,{className:"w-12 h-12 animate-spin text-blue-400 mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Loading image..."})]})}),se&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/50 z-10",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-red-400 mb-2",children:se}),s.jsxs("p",{className:"text-xs text-gray-500",children:["File: ",I.currentName]})]})}),O&&s.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:I.mimeType?.startsWith("video/")?s.jsx("video",{src:O,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",controls:!0,autoPlay:!0,muted:!0}):s.jsx("img",{src:O,alt:I.currentName,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"})}),s.jsxs("div",{className:"absolute bottom-4 right-4 flex flex-col items-end gap-2",children:[$&&s.jsxs("div",{className:`${$.color} text-white px-4 py-2 rounded-lg shadow-xl flex items-center gap-2`,children:[s.jsx("span",{className:"text-xl font-bold",children:$.key}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-sm font-semibold",children:$.label}),s.jsx("div",{className:"text-xs opacity-90",children:$.description})]})]}),I.day&&s.jsxs("div",{className:"bg-gray-900/90 backdrop-blur text-white px-4 py-2 rounded-lg shadow-xl",children:[s.jsx("div",{className:"text-xs text-gray-400",children:"Day"}),s.jsx("div",{className:"text-sm font-semibold",children:C[I.day]||`Day ${String(I.day).padStart(2,"0")}`})]}),I.favorite&&s.jsxs("div",{className:"bg-yellow-500 text-white px-3 py-2 rounded-lg shadow-xl flex items-center gap-2",children:[s.jsx(Bs,{className:"w-4 h-4 fill-current"}),s.jsx("span",{className:"text-sm font-semibold",children:"Favorite"})]})]}),s.jsxs("div",{className:"absolute top-4 left-4 bg-gray-900/80 backdrop-blur rounded-lg shadow-lg overflow-hidden flex flex-col",children:[s.jsxs("button",{onClick:()=>ee(!G),className:"flex items-center justify-between px-3 py-2 text-xs text-gray-300 hover:bg-gray-800 transition-colors border-b border-gray-700",children:[s.jsx("span",{className:"font-semibold",children:"Quick Actions"}),G?s.jsx(wp,{className:"w-4 h-4"}):s.jsx(id,{className:"w-4 h-4"})]}),G&&s.jsxs("div",{className:"px-3 py-2 space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:""}),s.jsx("span",{children:"Navigate"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:"A-E,M,X"}),s.jsx("span",{children:"Assign"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:"F"}),s.jsx("span",{children:"Favorite"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-800 rounded text-[10px]",children:"Esc"}),s.jsx("span",{children:"Exit"})]})]})]}),s.jsxs("div",{className:`absolute top-4 bottom-4 right-0 bg-gray-900/90 backdrop-blur rounded-l-lg shadow-2xl overflow-hidden flex transition-all duration-300 ${T?"w-72":"w-10"}`,children:[s.jsx("button",{onClick:()=>te(!T),className:"flex-shrink-0 w-10 flex items-center justify-center text-gray-300 hover:bg-gray-800 transition-colors border-r border-gray-700",title:T?"Hide categories":"Show categories",children:s.jsxs("div",{className:"flex flex-col items-center gap-1",children:[T?s.jsx(od,{className:"w-5 h-5"}):s.jsx(Us,{className:"w-5 h-5"}),!T&&s.jsx("div",{className:"transform -rotate-90 text-[10px] font-semibold whitespace-nowrap mt-2",children:"MECE"})]})}),T&&s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-gray-700",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:"MECE Categories"}),s.jsx("p",{className:"text-[10px] text-gray-400 mt-0.5",children:"Press key to assign bucket"})]}),s.jsx("div",{className:"flex-1 px-3 py-3 space-y-2.5 overflow-y-auto",children:w.map(h=>s.jsxs("div",{className:`${h.color} text-white px-3 py-2.5 rounded-lg text-xs shadow-md hover:shadow-lg transition-shadow cursor-pointer`,onClick:()=>{const F=I.bucket===h.key?"":h.key;m(I.id,F)},children:[s.jsxs("div",{className:"font-bold text-sm flex items-center justify-between",children:[s.jsxs("span",{children:[h.key," - ",h.label]}),I.bucket===h.key&&s.jsx("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded",children:"Active"})]}),s.jsx("div",{className:"opacity-90 text-[11px] mt-1",children:h.description})]},h.key))})]})]})]}),s.jsx(nm,{photos:u.photos,currentPhotoId:I.id,onSelectPhoto:ce})]})};function lm(o){let a=o;for(;a;){if(a.dir)return a.dir==="rtl";a=a.parentElement}return!1}function sm(o,a){const[u,d]=b.useState(a==="rtl");return b.useLayoutEffect(()=>{o&&(a||d(lm(o)))},[a,o]),u}const Qs=typeof window<"u"?b.useLayoutEffect:b.useEffect;function ld(o){if(o!==void 0)switch(typeof o){case"number":return o;case"string":{if(o.endsWith("px"))return parseFloat(o);break}}}function im({box:o,defaultHeight:a,defaultWidth:u,disabled:d,element:f,mode:p,style:m}){const{styleHeight:y,styleWidth:x}=b.useMemo(()=>({styleHeight:ld(m?.height),styleWidth:ld(m?.width)}),[m?.height,m?.width]),[N,w]=b.useState({height:a,width:u}),C=d||p==="only-height"&&y!==void 0||p==="only-width"&&x!==void 0||y!==void 0&&x!==void 0;return Qs(()=>{if(f===null||C)return;const D=new ResizeObserver(M=>{for(const B of M){const{contentRect:O,target:U}=B;f===U&&w(H=>H.height===O.height&&H.width===O.width?H:{height:O.height,width:O.width})}});return D.observe(f,{box:o}),()=>{D?.unobserve(f)}},[o,C,f,y,x]),b.useMemo(()=>({height:y??N.height,width:x??N.width}),[N,y,x])}function om(o){const a=b.useRef(()=>{throw new Error("Cannot call during render.")});return Qs(()=>{a.current=o},[o]),b.useCallback(u=>a.current?.(u),[a])}let kr=null;function am(o=!1){if(kr===null||o){const a=document.createElement("div"),u=a.style;u.width="50px",u.height="50px",u.overflow="scroll",u.direction="rtl";const d=document.createElement("div"),f=d.style;return f.width="100px",f.height="100px",a.appendChild(d),document.body.appendChild(a),a.scrollLeft>0?kr="positive-descending":(a.scrollLeft=1,a.scrollLeft===0?kr="negative":kr="positive-ascending"),document.body.removeChild(a),kr}return kr}function Qo({containerElement:o,direction:a,isRtl:u,scrollOffset:d}){if(a==="horizontal"&&u)switch(am()){case"negative":return-d;case"positive-descending":{if(o){const{clientWidth:f,scrollLeft:p,scrollWidth:m}=o;return m-f-p}break}}return d}function _n(o,a="Assertion error"){if(!o)throw console.error(a),Error(a)}function xl(o,a){if(o===a)return!0;if(!!o!=!!a||(_n(o!==void 0),_n(a!==void 0),Object.keys(o).length!==Object.keys(a).length))return!1;for(const u in o)if(!Object.is(a[u],o[u]))return!1;return!0}function xd({cachedBounds:o,itemCount:a,itemSize:u}){if(a===0)return 0;if(typeof u=="number")return a*u;{const d=o.get(o.size===0?0:o.size-1);_n(d!==void 0,"Unexpected bounds cache miss");const f=(d.scrollOffset+d.size)/o.size;return a*f}}function um({align:o,cachedBounds:a,index:u,itemCount:d,itemSize:f,containerScrollOffset:p,containerSize:m}){if(u<0||u>=d)throw RangeError(`Invalid index specified: ${u}`,{cause:`Index ${u} is not within the range of 0 - ${d-1}`});const y=xd({cachedBounds:a,itemCount:d,itemSize:f}),x=a.get(u),N=Math.max(0,Math.min(y-m,x.scrollOffset)),w=Math.max(0,x.scrollOffset-m+x.size);switch(o==="smart"&&(p>=w&&p<=N?o="auto":o="center"),o){case"start":return N;case"end":return w;case"center":return x.scrollOffset<=m/2?0:x.scrollOffset+x.size/2>=y-m/2?y-m:x.scrollOffset+x.size/2-m/2;default:return p>=w&&p<=N?p:p<w?w:N}}function Yo({cachedBounds:o,containerScrollOffset:a,containerSize:u,itemCount:d,overscanCount:f}){const p=d-1;let m=0,y=-1,x=0,N=-1,w=0;for(;w<p;){const C=o.get(w);if(C.scrollOffset+C.size>a)break;w++}for(m=w,x=Math.max(0,m-f);w<p;){const C=o.get(w);if(C.scrollOffset+C.size>=a+u)break;w++}return y=Math.min(p,w),N=Math.min(d-1,y+f),m<0&&(m=0,y=-1,x=0,N=-1),{startIndexVisible:m,stopIndexVisible:y,startIndexOverscan:x,stopIndexOverscan:N}}function cm({itemCount:o,itemProps:a,itemSize:u}){const d=new Map;return{get(f){for(_n(f<o,`Invalid index ${f}`);d.size-1<f;){const m=d.size;let y;switch(typeof u){case"function":{y=u(m,a);break}case"number":{y=u;break}}if(m===0)d.set(m,{size:y,scrollOffset:0});else{const x=d.get(m-1);_n(x!==void 0,`Unexpected bounds cache miss for index ${f}`),d.set(m,{scrollOffset:x.scrollOffset+x.size,size:y})}}const p=d.get(f);return _n(p!==void 0,`Unexpected bounds cache miss for index ${f}`),p},set(f,p){d.set(f,p)},get size(){return d.size}}}function dm({itemCount:o,itemProps:a,itemSize:u}){return b.useMemo(()=>cm({itemCount:o,itemProps:a,itemSize:u}),[o,a,u])}function fm({containerSize:o,itemSize:a}){let u;return typeof a==="string"?(_n(a.endsWith("%"),`Invalid item size: "${a}"; string values must be percentages (e.g. "100%")`),_n(o!==void 0,"Container size must be defined if a percentage item size is specified"),u=o*parseInt(a)/100):u=a,u}function sd({containerElement:o,containerStyle:a,defaultContainerSize:u=0,direction:d,isRtl:f=!1,itemCount:p,itemProps:m,itemSize:y,onResize:x,overscanCount:N}){const{height:w=u,width:C=u}=im({defaultHeight:d==="vertical"?u:void 0,defaultWidth:d==="horizontal"?u:void 0,element:o,mode:d==="vertical"?"only-height":"only-width",style:a}),D=b.useRef({height:0,width:0}),M=d==="vertical"?w:C,B=fm({containerSize:M,itemSize:y});b.useLayoutEffect(()=>{if(typeof x=="function"){const I=D.current;(I.height!==w||I.width!==C)&&(x({height:w,width:C},{...I}),I.height=w,I.width=C)}},[w,x,C]);const O=dm({itemCount:p,itemProps:m,itemSize:B}),U=b.useCallback(I=>O.get(I),[O]),[H,W]=b.useState(()=>Yo({cachedBounds:O,containerScrollOffset:0,containerSize:M,itemCount:p,overscanCount:N})),{startIndexVisible:se,startIndexOverscan:R,stopIndexVisible:G,stopIndexOverscan:ee}={startIndexVisible:Math.min(p-1,H.startIndexVisible),startIndexOverscan:Math.min(p-1,H.startIndexOverscan),stopIndexVisible:Math.min(p-1,H.stopIndexVisible),stopIndexOverscan:Math.min(p-1,H.stopIndexOverscan)},T=b.useCallback(()=>xd({cachedBounds:O,itemCount:p,itemSize:B}),[O,p,B]),te=b.useCallback(I=>{const de=Qo({containerElement:o,direction:d,isRtl:f,scrollOffset:I});return Yo({cachedBounds:O,containerScrollOffset:de,containerSize:M,itemCount:p,overscanCount:N})},[O,o,M,d,f,p,N]);Qs(()=>{const I=(d==="vertical"?o?.scrollTop:o?.scrollLeft)??0;W(te(I))},[o,d,te]),Qs(()=>{if(!o)return;const I=()=>{W(de=>{const{scrollLeft:z,scrollTop:fe}=o,ie=Qo({containerElement:o,direction:d,isRtl:f,scrollOffset:d==="vertical"?fe:z}),ce=Yo({cachedBounds:O,containerScrollOffset:ie,containerSize:M,itemCount:p,overscanCount:N});return xl(ce,de)?de:ce})};return o.addEventListener("scroll",I),()=>{o.removeEventListener("scroll",I)}},[O,o,M,d,p,N]);const q=om(({align:I="auto",containerScrollOffset:de,index:z})=>{let fe=um({align:I,cachedBounds:O,containerScrollOffset:de,containerSize:M,index:z,itemCount:p,itemSize:B});if(o){if(fe=Qo({containerElement:o,direction:d,isRtl:f,scrollOffset:fe}),typeof o.scrollTo!="function"){const ie=te(fe);xl(H,ie)||W(ie)}return fe}});return{getCellBounds:U,getEstimatedSize:T,scrollToIndex:q,startIndexOverscan:R,startIndexVisible:se,stopIndexOverscan:ee,stopIndexVisible:G}}function pm(o){return b.useMemo(()=>o,Object.values(o))}function hm(o,a){const{ariaAttributes:u,style:d,...f}=o,{ariaAttributes:p,style:m,...y}=a;return xl(u,p)&&xl(d,m)&&xl(f,y)}function mm({cellComponent:o,cellProps:a,children:u,className:d,columnCount:f,columnWidth:p,defaultHeight:m=0,defaultWidth:y=0,dir:x,gridRef:N,onCellsRendered:w,onResize:C,overscanCount:D=3,rowCount:M,rowHeight:B,style:O,tagName:U="div",...H}){const W=pm(a),se=b.useMemo(()=>b.memo(o,hm),[o]),[R,G]=b.useState(null),ee=sm(R,x),{getCellBounds:T,getEstimatedSize:te,startIndexOverscan:q,startIndexVisible:I,scrollToIndex:de,stopIndexOverscan:z,stopIndexVisible:fe}=sd({containerElement:R,containerStyle:O,defaultContainerSize:y,direction:"horizontal",isRtl:ee,itemCount:f,itemProps:W,itemSize:p,onResize:C,overscanCount:D}),{getCellBounds:ie,getEstimatedSize:ce,startIndexOverscan:le,startIndexVisible:$,scrollToIndex:h,stopIndexOverscan:F,stopIndexVisible:k}=sd({containerElement:R,containerStyle:O,defaultContainerSize:m,direction:"vertical",itemCount:M,itemProps:W,itemSize:B,onResize:C,overscanCount:D});b.useImperativeHandle(N,()=>({get element(){return R},scrollToCell({behavior:A="auto",columnAlign:V="auto",columnIndex:re,rowAlign:ae="auto",rowIndex:ge}){const Se=de({align:V,containerScrollOffset:R?.scrollLeft??0,index:re}),J=h({align:ae,containerScrollOffset:R?.scrollTop??0,index:ge});typeof R?.scrollTo=="function"&&R.scrollTo({behavior:A,left:Se,top:J})},scrollToColumn({align:A="auto",behavior:V="auto",index:re}){const ae=de({align:A,containerScrollOffset:R?.scrollLeft??0,index:re});typeof R?.scrollTo=="function"&&R.scrollTo({behavior:V,left:ae})},scrollToRow({align:A="auto",behavior:V="auto",index:re}){const ae=h({align:A,containerScrollOffset:R?.scrollTop??0,index:re});typeof R?.scrollTo=="function"&&R.scrollTo({behavior:V,top:ae})}}),[R,de,h]),b.useEffect(()=>{q>=0&&z>=0&&le>=0&&F>=0&&w&&w({columnStartIndex:I,columnStopIndex:fe,rowStartIndex:$,rowStopIndex:k},{columnStartIndex:q,columnStopIndex:z,rowStartIndex:le,rowStopIndex:F})},[w,q,I,z,fe,le,$,F,k]);const g=b.useMemo(()=>{const A=[];if(f>0&&M>0)for(let V=le;V<=F;V++){const re=ie(V),ae=[];for(let ge=q;ge<=z;ge++){const Se=T(ge);ae.push(b.createElement(se,{...W,ariaAttributes:{"aria-colindex":ge+1,role:"gridcell"},columnIndex:ge,key:ge,rowIndex:V,style:{position:"absolute",left:ee?void 0:0,right:ee?0:void 0,transform:`translate(${ee?-Se.scrollOffset:Se.scrollOffset}px, ${re.scrollOffset}px)`,height:re.size,width:Se.size}}))}A.push(s.jsx("div",{role:"row","aria-rowindex":V+1,children:ae},V))}return A},[se,W,f,q,z,T,ie,ee,M,le,F]),E=s.jsx("div",{"aria-hidden":!0,style:{height:ce(),width:te(),zIndex:-1}});return b.createElement(U,{"aria-colcount":f,"aria-rowcount":M,role:"grid",...H,className:d,dir:x,ref:G,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",flexGrow:1,overflow:"auto",...O}},g,u,E)}const gm=5,ym=200,vm=12;function xm({photos:o,selectedPhotos:a,onSelectPhoto:u,onOpenViewer:d,height:f=800,width:p,columnCount:m=gm,cellSize:y=ym,gap:x=vm}){const N=p??m*y,w=b.useMemo(()=>Math.ceil(o.length/m),[o.length,m]),C=b.useCallback(({columnIndex:D,rowIndex:M,style:B})=>{const O=M*m+D;if(O>=o.length)return null;const U=o[O],H=a.has(U.id),W={...B,left:B.left+x,top:B.top+x,width:B.width-x,height:B.height-x};return s.jsx("div",{style:W,onClick:()=>u(U.id),onDoubleClick:()=>d(U.id),className:`cursor-pointer rounded-lg overflow-hidden ${H?"ring-2 ring-blue-500":""}`,children:U.thumbnail?s.jsx("img",{src:U.thumbnail,alt:U.currentName,className:"w-full h-full object-cover",loading:"lazy"}):s.jsx("div",{className:"w-full h-full bg-gray-900 flex items-center justify-center",children:s.jsx("span",{className:"text-xs text-gray-400",children:U.currentName})})})},[m,x,d,u,o,a]);return s.jsx(mm,{columnCount:m,columnWidth:y,height:f,rowCount:w,rowHeight:y,width:N,children:C})}const wm=600,jm=300;function Nm({loadingProject:o,currentView:a,selectedDay:u,selectedRootFolder:d,photos:f,rootGroups:p,filteredPhotos:m,selectedPhotos:y,galleryViewPhoto:x,dayLabels:N,buckets:w,onSelectPhoto:C,onOpenViewer:D,onCloseViewer:M,onNavigateViewer:B,onToggleFavorite:O,onAssignBucket:U,onAssignDay:H,onSaveToHistory:W,onShowToast:se,getSubfolderGroup:R,getDerivedSubfolderGroup:G,isVideoPhoto:ee,isMeceBucketLabel:T}){const te=b.useRef({}),q=u!==null,I=u===1?{title:"Day 1: Try organizing these photos",body:"This day is intentionally unassigned. Single-click to select, then press A-E/M/X (or use the right sidebar) to assign buckets. Double-click a photo to inspect it with the filmstrip."}:u===2?{title:"Day 2: Already organized",body:'This day is fully assigned so you can see the end state. Use "Hide Assigned" to compare, or open a photo to browse buckets in the viewer.'}:u===3?{title:"Day 3: In progress",body:'This day is partially assigned. Use "Hide Assigned" to focus on the remaining photos, then bucket the rest to finish the day.'}:null;b.useEffect(()=>{console.log("[PhotoGrid] Day callout state",{currentView:a,selectedDay:u,showDemoCallout:q,dayCalloutTitle:I?.title??null})},[a,u,q,I?.title]);const de=I?s.jsxs("div",{className:"rounded-lg border border-blue-500/40 bg-blue-500/10 px-4 py-3 text-sm text-blue-100",children:[s.jsx("div",{className:"font-semibold text-blue-200",children:I.title}),s.jsx("div",{className:"mt-1 text-blue-100/90",children:I.body})]}):null,z=(k,g)=>{g.stopPropagation(),te.current[k]?(clearTimeout(te.current[k]),delete te.current[k],D(k)):te.current[k]=setTimeout(()=>{delete te.current[k],C(k)},jm)},fe=(k,g,E)=>s.jsx("div",{className:"grid grid-cols-5 gap-3",children:k.map(A=>s.jsxs("div",{onClick:V=>z(A.id,V),"data-testid":`photo-${A.id}`,className:`relative group cursor-pointer rounded-lg overflow-visible transition-all shadow-lg hover:shadow-xl ${A.bucket||A.archived?"":"hover:scale-105"} ${y.has(A.id)?"ring-2 ring-blue-500":""}`,children:[s.jsx("div",{className:`rounded-lg overflow-hidden ${A.bucket||A.archived?"opacity-70 saturate-75":""}`,children:A.thumbnail?A.mimeType?.startsWith("video/")?s.jsx("video",{src:A.thumbnail,className:"w-full aspect-square object-cover",muted:!0,preload:"metadata"}):s.jsx("img",{src:A.thumbnail,alt:A.currentName,className:"w-full aspect-square object-cover"}):s.jsx("div",{className:"w-full aspect-square bg-gray-900 flex items-center justify-center text-xs text-gray-400 px-2 text-center",children:A.currentName})}),A.mimeType?.startsWith("video/")&&s.jsx("div",{className:"absolute top-2 left-2 bg-black/70 backdrop-blur-sm rounded-full p-1.5",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M6.3 2.84A1.5 1.5 0 004 4.11v11.78a1.5 1.5 0 002.3 1.27l9.344-5.891a1.5 1.5 0 000-2.538L6.3 2.841z"})})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity z-5",children:s.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-2",children:s.jsx("p",{className:"text-xs font-medium text-white truncate",children:A.currentName})})}),A.isPreOrganized&&s.jsx("div",{className:"absolute top-2 right-2 z-10",children:s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-blue-600 text-white shadow-lg",title:`Auto-assigned: Day ${A.detectedDay??""}, Bucket ${A.detectedBucket??""}`,children:"Organized"})}),A.bucket&&(()=>{const V=w.find(Se=>Se.key===A.bucket),re=V?.color||"bg-gray-500",ge={"bg-blue-500":"rgb(59, 130, 246)","bg-purple-500":"rgb(168, 85, 247)","bg-green-500":"rgb(34, 197, 94)","bg-orange-500":"rgb(249, 115, 22)","bg-yellow-500":"rgb(234, 179, 8)","bg-indigo-500":"rgb(99, 102, 241)","bg-gray-500":"rgb(107, 114, 128)"}[re];return s.jsx("div",{className:"absolute bottom-2 left-2 px-2 py-1 rounded text-xs font-bold text-white shadow-lg z-10",style:{backgroundColor:ge||"rgb(107, 114, 128)"},title:`Bucket: ${A.bucket}${V?` (${V.label})`:""}`,children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{children:A.bucket}),A.favorite&&s.jsx(Bs,{className:"w-3 h-3 fill-current"})]})})})(),!A.bucket&&A.favorite&&s.jsx("div",{className:"absolute bottom-2 left-2 bg-yellow-500 text-white rounded-full p-1.5 shadow-lg z-10",children:s.jsx(Bs,{className:"w-3.5 h-3.5 fill-current"})})]},A.id))});if(o)return s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ys,{className:"w-12 h-12 mx-auto mb-4 animate-spin text-blue-400"}),s.jsx("p",{className:"text-gray-400",children:"Loading project..."})]})});if(a==="days"&&u===null)return s.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx(xp,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Select a day to view photos"})]})});if(a==="folders"&&d===null&&u===null)return s.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx(qo,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Select a folder to view photos"})]})});const ie=a==="folders"&&d?(p.find(k=>k[0]===d)?.[1]||[]).filter(k=>!k.archived):null,ce=ie!==null?ie:m,le=da(ce,{groupBy:u!==null?"subfolder":null,separateVideos:!0,selectedDay:u,getSubfolderGroup:R,isVideo:ee}),$=le.photos;le.indexMap;const h=u!==null?le.groups??null:null;if(ce.length===0)return s.jsx("div",{className:"flex items-center justify-center h-96 text-gray-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx(qo,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"No photos in this view"})]})});if(x){const k=$.find(g=>g.id===x);if(k)return s.jsx(rm,{photo:k,filteredPhotos:$,orderingResult:le,onClose:M,onNavigate:B,onToggleFavorite:g=>O(g),onAssignBucket:(g,E)=>{if(U(g,E),E){const V=At(g,"next",le,ge=>!ge.bucket&&!ge.archived);if(V){B(V.id);return}const re=At(g,"next",le);if(re){B(re.id);return}const ae=At(g,"prev",le);if(ae){B(ae.id);return}M()}},onAssignDay:(g,E)=>H(g,E),selectedBucket:k.bucket||void 0,selectedDay:k.day,buckets:w,dayLabels:N,onShowToast:se})}return u!==null&&h?s.jsxs("div",{className:"space-y-8",children:[de,h.map(k=>{const g=k.photos,E=g.filter(ee),A=g.filter(Q=>!ee(Q)),V=E.length>0&&A.length>0,re=k.photos.filter(Q=>Q.day===u);re.some(Q=>Q.subfolderOverride!==void 0);const ae=re.some(Q=>Q.subfolderOverride===null),ge=k.label==="Day Root",Se=T(k.label),J=ge&&ae,Oe=!ge&&!Se;return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:k.label}),s.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-400",children:[s.jsxs("span",{children:[k.photos.length," items"]}),J&&s.jsx("button",{className:"text-xs text-red-300 hover:text-red-200",title:"Revert photos back to subfolder",onClick:()=>{const Q=f.map(oe=>oe.day!==u?oe:re.find(he=>he.id===oe.id)?{...oe,subfolderOverride:void 0}:oe);W(Q),se("Photos reverted to subfolder.","info")},children:"Undo Ingest"}),Oe&&s.jsxs("div",{className:"flex items-center gap-2",children:[!ae&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"text-xs text-blue-300 hover:text-blue-200",title:"Move photos in this subfolder to the day root",onClick:()=>{const Q=f.map(he=>he.day!==u||G(he,u)!==k.label?he:{...he,subfolderOverride:null});W(Q);const oe=N[u]||`Day ${String(u).padStart(2,"0")}`;se(`Photos moved to ${oe}.`,"info")},children:"Ingest to Day"}),s.jsx("button",{className:"text-xs text-gray-300 hover:text-gray-100",onClick:()=>{const Q=f.map(oe=>{if(oe.day!==u)return oe;const he=G(oe,u);return he!==k.label?oe:{...oe,subfolderOverride:he}});W(Q)},children:"Keep Subfolder"})]}),ae&&s.jsx("button",{className:"text-xs text-red-300 hover:text-red-200",title:"Revert photos back to subfolder",onClick:()=>{const Q=f.map(oe=>oe.day!==u?oe:re.find(he=>he.id===oe.id)?{...oe,subfolderOverride:void 0}:oe);W(Q),se("Photos reverted to subfolder.","info")},children:"Undo Ingest"})]})]})]}),V&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-2 text-xs uppercase tracking-wider text-gray-500",children:"Photos"}),fe(A),s.jsx("div",{className:"mt-6 mb-2 text-xs uppercase tracking-wider text-gray-500",children:"Videos"}),fe(E)]}),!V&&fe(g)]},k.label)})]}):u===null&&$.length>=wm?s.jsx(xm,{photos:$,selectedPhotos:y,onSelectPhoto:C,onOpenViewer:D}):u!==null?s.jsxs("div",{className:"space-y-6",children:[de,fe($)]}):fe($)}function km({selectedPhotos:o,photos:a,days:u,buckets:d,onSaveToHistory:f,onPersistState:p,onSetDayLabels:m,onSetSelectedDay:y,onSetCurrentView:x,onSetSelectedPhotos:N,onRemoveDayAssignment:w,onAssignBucket:C,onToggleFavorite:D}){const[M,B]=b.useState(!1),[O,U]=b.useState("");if(b.useEffect(()=>{B(!1)},[o]),o.size===0)return null;const H=o.size===1?Array.from(o)[0]:null,W=H?a.find(se=>se.id===H):null;return s.jsx("aside",{className:"w-80 border-l border-gray-800 bg-gray-900 overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsx("div",{className:"mb-6",children:o.size===1&&W?s.jsxs(s.Fragment,{children:[W.mimeType?.startsWith("video/")?s.jsx("video",{src:W.thumbnail,className:"w-full rounded-lg",controls:!0}):s.jsx("img",{src:W.thumbnail,alt:"Selected",className:"w-full rounded-lg"}),s.jsx("div",{className:"mt-2 text-xs text-gray-400 font-mono break-all",children:M?s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{value:O,onChange:se=>U(se.target.value),className:"w-full px-2 py-1 rounded bg-gray-800 text-sm text-gray-100"}),s.jsx("button",{onClick:()=>{const se=a.map(R=>R.id===H?{...R,currentName:O}:R);f(se),B(!1)},className:"p-1 bg-green-600 rounded","aria-label":"Save name",children:s.jsx(Xo,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>B(!1),className:"p-1 bg-gray-800 rounded","aria-label":"Cancel edit name",children:s.jsx(Gt,{className:"w-4 h-4"})})]}):s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:W.currentName}),s.jsx("button",{onClick:()=>{U(W.currentName||W.originalName||""),B(!0)},className:"p-1 ml-2","aria-label":"Edit name",children:s.jsx(Jo,{className:"w-4 h-4 text-gray-400"})})]})})]}):s.jsxs("div",{className:"text-sm text-gray-300",children:[o.size," selected"]})}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Assign Day"}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsxs("select",{"aria-label":"Assign to...",onChange:se=>{const R=se.target.value;if(!R)return;const G=R==="new"?Math.max(0,...u.map(te=>te[0]))+1:Number(R),ee=Array.from(o),T=a.map(te=>ee.includes(te.id)?{...te,day:G}:te);f(T),R==="new"&&(m(te=>({...te,[G]:`Day ${String(G).padStart(2,"0")}`})),p(T)),y(G),x("days"),N(new Set)},className:"px-3 py-2 rounded bg-gray-800",defaultValue:"",children:[s.jsx("option",{value:"",children:"Assign to..."}),u.map(([se])=>s.jsx("option",{value:se,children:`Day ${String(se).padStart(2,"0")}`},se)),s.jsx("option",{value:"new",children:"Create new day"})]}),s.jsx("div",{className:"text-xs text-gray-400",children:"Assign selected photos to a day folder"})]}),s.jsx("button",{onClick:()=>{w(Array.from(o)),N(new Set)},className:"w-full px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded text-sm font-medium transition-colors",children:"Remove Day Assignment"})]}),s.jsxs("div",{className:"space-y-2 mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Assign Category"}),d.map(se=>s.jsxs("button",{onClick:()=>C(Array.from(o),se.key),className:`w-full text-left px-4 py-3 rounded-lg transition-all ${se.color} hover:brightness-110 text-white`,children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("span",{className:"font-bold text-lg",children:se.key}),s.jsx("span",{className:"ml-3 font-medium",children:se.label})]})}),s.jsx("p",{className:"text-xs mt-1 opacity-80",children:se.description})]},se.key))]}),s.jsx("div",{className:"space-y-3 pt-6 border-t border-gray-800",children:s.jsxs("button",{onClick:()=>D(Array.from(o)),className:`w-full px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${o.size===1&&W?.favorite?"bg-yellow-600 hover:bg-yellow-700":"bg-gray-800 hover:bg-gray-700"}`,children:[s.jsx(Bs,{className:`w-4 h-4 ${o.size===1&&W?.favorite?"fill-current":""}`}),"Toggle Favorite (F)"]})})]})})}function Sm({isOpen:o,buckets:a,onClose:u}){return o?s.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-6",children:s.jsx("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Keyboard Shortcuts"}),s.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-800 rounded",children:s.jsx(Gt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-blue-400 mb-3",children:"Workflow"}),s.jsxs("ol",{className:"space-y-2 text-sm text-gray-200 list-decimal pl-5",children:[s.jsx("li",{children:"Single-click a photo in the grid to select it, then assign a bucket from the right sidebar (or press A-E/M/X)."}),s.jsx("li",{children:"Double-click a photo to open the viewer. Use the filmstrip below to move through photos one by one."}),s.jsx("li",{children:"Use the Days sidebar to jump between days, or hide assigned photos to focus on what is left."})]}),s.jsx("p",{className:"mt-3 text-xs text-amber-200",children:"Note: Export scripts are currently macOS-only."})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-blue-400 mb-3",children:"MECE Categories"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.map(d=>s.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[s.jsx("kbd",{className:`px-2 py-1 rounded ${d.color} text-white font-bold`,children:d.key==="F"?"M":d.key}),s.jsx("span",{children:d.label})]},d.key))}),s.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"Keyboard shortcuts: AE, X, M (Mood/Food). F is reserved for Favorite."})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-blue-400 mb-3",children:"Navigation"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:""}),s.jsx("span",{children:"Previous / Next photo"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"J / K"}),s.jsx("span",{children:"Next / Previous (grid)"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Shift+J / Shift+K"}),s.jsx("span",{children:"Next / Previous unassigned"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Enter"}),s.jsx("span",{children:"Fullscreen view"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Esc"}),s.jsx("span",{children:"Close / Deselect"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Space / N"}),s.jsx("span",{children:"Next unassigned (viewer)"})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-blue-400 mb-3",children:"Actions"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"F"}),s.jsx("span",{children:"Toggle favorite"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Shift+H"}),s.jsx("span",{children:"Toggle Skip Assigned"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"AE, M, X"}),s.jsx("span",{children:"Assign bucket (multi-select supported)"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Z"}),s.jsx("span",{children:"Undo (keyboard)"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Z"}),s.jsx("span",{children:"Redo (keyboard)"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Ctrl+Shift+D"}),s.jsx("span",{children:"Toggle debug overlay"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"?"}),s.jsx("span",{children:"Show this help"})]})]})]})]})]})})}):null}function bm({isOpen:o,scriptText:a,copyStatus:u,detectedProjectPath:d,onClose:f,onCopyScript:p,onDownloadScript:m,onRegenerateScript:y}){const[x,N]=b.useState(d);b.useEffect(()=>{N(d)},[d]);const w=C=>{const D=C.target.value;N(D),y(D)};return o?s.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-6",children:s.jsxs("div",{className:"bg-gray-900 rounded-lg max-w-3xl w-full overflow-hidden border border-gray-800 shadow-2xl",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-800 flex items-center justify-between bg-gray-800/50",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-100",children:"Export Script"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Organize and copy your photos"})]}),s.jsx("button",{onClick:f,className:"p-2 hover:bg-gray-700 rounded-lg transition-colors","aria-label":"Close export script dialog",children:s.jsx(Gt,{className:"w-5 h-5 text-gray-400"})})]}),s.jsxs("div",{className:"px-6 py-5 space-y-5 max-h-[calc(100vh-150px)] overflow-y-auto",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-200",children:"Project Directory"}),s.jsx("input",{type:"text",value:x,onChange:w,placeholder:"/Users/you/Photos/Trip-to-Japan",className:"w-full px-4 py-3 rounded-lg border border-gray-700 bg-gray-950 text-gray-100 text-sm font-mono focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Full path to your photo project folder"})]}),s.jsxs("div",{className:"bg-blue-950/40 border border-blue-900/50 rounded-lg p-3 flex gap-3",children:[s.jsx(Np,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-100",children:[s.jsx("p",{className:"font-medium mb-1",children:"How to use:"}),s.jsxs("ol",{className:"text-xs text-blue-200 space-y-1",children:[s.jsx("li",{children:"1. Download the script below"}),s.jsx("li",{children:"2. Open Terminal in your project folder"}),s.jsxs("li",{children:["3. Run:"," ",s.jsx("code",{className:"bg-blue-900/50 px-1.5 py-0.5 rounded font-mono",children:"bash narrative-export.sh"})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-semibold text-gray-200",children:"Script (narrative-export.sh)"}),s.jsxs("span",{className:"text-xs text-gray-500",children:[a.split(`
`).length," lines"]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("textarea",{readOnly:!0,value:a,className:"w-full h-64 rounded-lg border border-gray-800 bg-gray-950 px-4 py-3 text-xs text-gray-100 font-mono leading-relaxed focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none"}),s.jsx("div",{className:"absolute top-0 right-0 bottom-0 w-px bg-gradient-to-b from-blue-500/30 to-transparent pointer-events-none"})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[s.jsxs("button",{onClick:m,className:"px-5 py-3 rounded-lg bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800 text-sm font-semibold flex items-center gap-2 transition-all",children:[s.jsx(aa,{className:"w-4 h-4"}),"Download Script"]}),s.jsxs("button",{onClick:p,className:"px-5 py-3 rounded-lg bg-gray-800 text-gray-100 hover:bg-gray-700 active:bg-gray-600 text-sm font-semibold flex items-center gap-2 transition-all",children:[s.jsx(jp,{className:"w-4 h-4"}),"Copy to Clipboard"]}),u==="copied"&&s.jsx("div",{className:"flex items-center gap-2 px-4 py-3 rounded-lg bg-green-950/50 border border-green-900/50",children:s.jsx("span",{className:"text-sm text-green-300 font-medium",children:" Copied to clipboard!"})}),u==="failed"&&s.jsx("div",{className:"flex items-center gap-2 px-4 py-3 rounded-lg bg-red-950/50 border border-red-900/50",children:s.jsx("span",{className:"text-sm text-red-300 font-medium",children:"Copy failed. Use download instead."})})]})]})]})}):null}function Cm({isOpen:o,scriptText:a,onClose:u,onDownloadScript:d}){return o?s.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-6",children:s.jsxs("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full overflow-hidden border border-gray-800",children:[s.jsxs("div",{className:"px-5 py-4 border-b border-gray-800 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Vc,{className:"w-5 h-5 text-yellow-500"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Undo Last Export"})]}),s.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-800 rounded","aria-label":"Close undo script dialog",children:s.jsx(Gt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"px-5 py-4 space-y-3",children:[s.jsx("div",{className:"bg-yellow-900/20 border border-yellow-700/50 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Vc,{className:"w-4 h-4 text-yellow-500 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-yellow-200",children:[s.jsx("p",{className:"font-medium mb-1",children:"Warning: This will delete exported files"}),s.jsx("p",{className:"text-yellow-300/80",children:"This script will remove all files created by your last export. Files are validated by size before deletion for safety."})]})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Undo Script"}),s.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["Download and run this script to undo your last export:"," ",s.jsx("code",{className:"bg-gray-800 px-1.5 py-0.5 rounded text-xs",children:"bash narrative-undo-export.sh"})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:d,className:"px-4 py-2 rounded-lg bg-yellow-600 text-white hover:bg-yellow-700 text-sm font-medium flex items-center gap-2",children:[s.jsx(aa,{className:"w-4 h-4"}),"Download Undo Script"]}),s.jsx("button",{onClick:u,className:"px-3 py-2 rounded-lg bg-gray-800 text-gray-100 hover:bg-gray-700 text-sm",children:"Cancel"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Script Preview"}),s.jsx("textarea",{readOnly:!0,value:a,className:"w-full h-48 rounded-lg border border-gray-800 bg-gray-950 px-3 py-2 text-xs text-gray-100 font-mono"})]})]})]})}):null}function Em({toast:o,onDismiss:a}){return o?s.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:s.jsxs("div",{className:`flex items-center gap-3 px-4 py-2 rounded-lg text-sm shadow-lg ${o.tone==="error"?"bg-red-600 text-white":"bg-gray-800 text-gray-100"}`,role:"status","aria-live":"polite",children:[s.jsx("span",{children:o.message}),s.jsxs("div",{className:"flex items-center gap-2",children:[o.actionLabel&&s.jsx("button",{onClick:()=>{o.onAction?.(),a()},className:"px-2 py-0.5 rounded bg-white/10 text-xs text-white hover:bg-white/20",children:o.actionLabel}),s.jsx("button",{onClick:a,className:"p-1 rounded hover:bg-white/10","aria-label":"Dismiss toast",children:s.jsx(Gt,{className:"w-4 h-4"})})]})]})}):null}function Pm({photoId:o,photos:a,onClose:u}){if(!o)return null;const d=a.find(f=>f.id===o);return d?s.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:[s.jsx("button",{onClick:u,className:"absolute top-4 right-4 p-2 bg-black/50 hover:bg-black/70 rounded-full transition-colors",children:s.jsx(Gt,{className:"w-6 h-6"})}),d.mimeType?.startsWith("video/")?s.jsx("video",{src:d.thumbnail,controls:!0,className:"max-w-full max-h-full object-contain",autoPlay:!1}):s.jsx("img",{src:d.thumbnail,alt:"Fullscreen",className:"max-w-full max-h-full object-contain"}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent p-6",children:[s.jsx("p",{className:"text-center text-sm font-mono",children:d.currentName}),s.jsx("p",{className:"text-center text-xs text-gray-400 mt-2",children:"Press ESC to close  Arrow keys to navigate"})]})]}):null}function Dm({enabled:o,photos:a,filteredPhotos:u,selectedPhotos:d,currentView:f}){const p=b.useRef(performance.now()),[m,y]=b.useState(0);return b.useEffect(()=>{const x=performance.now(),N=x-p.current;p.current=x,o&&y(N)},[o,a,u,d,f]),o?s.jsxs("div",{className:"fixed bottom-4 left-4 bg-black/90 text-white text-xs p-3 rounded-lg font-mono z-50",children:[s.jsx("div",{className:"font-bold mb-2",children:"Debug Info"}),s.jsxs("div",{children:["Total Photos: ",a]}),s.jsxs("div",{children:["Filtered: ",u]}),s.jsxs("div",{children:["Selected: ",d]}),s.jsxs("div",{children:["View: ",f]}),s.jsxs("div",{children:["Last Render: ",m.toFixed(2),"ms"]}),s.jsx("div",{className:"mt-2 text-gray-400",children:"Press Ctrl+Shift+D to toggle"})]}):null}function _m(){const o=b.useRef([]),[a,u]=b.useState(Vs.getDisplayVersion()),d=!1,[f,p]=b.useState(!1),[m,y]=b.useState(!1),{toast:x,showToast:N,clearToast:w}=Th(),{currentView:C,setCurrentView:D,sidebarCollapsed:M,setSidebarCollapsed:B,hideAssigned:O,setHideAssigned:U,showHelp:H,setShowHelp:W,galleryViewPhoto:se,setGalleryViewPhoto:R,fullscreenPhoto:G,setFullscreenPhoto:ee,selectedDay:T,setSelectedDay:te,selectedRootFolder:q,setSelectedRootFolder:I,foldersViewStateRef:de}=Rh(),{photos:z,setPhotos:fe,projectName:ie,setProjectName:ce,projectRootPath:le,setProjectRootPath:$,projectFolderLabel:h,projectSettings:F,recentProjects:k,setRecentProjects:g,showOnboarding:E,setShowOnboarding:A,showWelcome:V,setShowWelcome:re,projectError:ae,setProjectError:ge,permissionRetryProjectId:Se,projectNeedingReselection:J,setProjectNeedingReselection:Oe,loadingProject:Q,loadingProgress:oe,loadingMessage:he,dayLabels:Z,setDayLabels:ye,dayContainers:ve,loadProject:Ee,retryProjectPermission:Pe,handleOnboardingComplete:be}=Oh({debugEnabled:d,showToast:N,prevThumbnailsRef:o}),{setHistory:De,setHistoryIndex:Re,persistState:st,saveToHistory:ct,undo:Xe,redo:Ue}=Sh({photos:z,setPhotos:fe,projectRootPath:le,projectName:ie,projectFolderLabel:h,projectSettings:F,dayLabels:Z,prevThumbnailsRef:o}),{showExportScript:Yt,exportScriptText:Rn,exportCopyStatus:qn,openExportScriptModal:wl,closeExportScriptModal:Tn,copyExportScript:Ln,downloadExportScript:ei,regenerateScript:jl,getDetectedProjectPath:Nl,showUndoScript:ti,undoScriptText:Dr,openUndoScriptModal:_r,closeUndoScriptModal:Or,downloadUndoScript:Rr,hasExportManifest:Tr}=Ah(z,Z,F,le||void 0),{setCoverForPhotoId:qt}=Qh({photos:z,projectRootPath:le,projectName:ie,projectFolderLabel:h,setRecentProjects:g,showToast:N});b.useEffect(()=>{(async()=>{try{const ze=await Vs.getCurrentVersion();u(`v${ze}`)}catch{}})()},[d]);const{days:Ut,visibleDays:kl,normalizePath:Sl,sortFolders:bl,getDerivedSubfolderGroup:Cl,getSubfolderGroup:Jn,rootGroups:Jt,displayRootGroups:El,filteredPhotos:Rt}=Gh({photos:z,dayLabels:Z,dayContainers:ve,projectSettings:F,debugEnabled:d,currentView:C,selectedDay:T,selectedRootFolder:q,hideAssigned:O}),zn=b.useCallback(je=>{if(je.mimeType?.startsWith("video/"))return!0;const ze=je.originalName.split(".").pop()?.toLowerCase()||"";return["mp4","mov","webm","avi","mkv"].includes(ze)},[]),cn=As.useMemo(()=>{const ze=(C==="folders"&&q?(Jt.find(Ve=>Ve[0]===q)?.[1]||[]).filter(Ve=>!Ve.archived):null)??Rt;return da(ze,{groupBy:T!==null?"subfolder":null,separateVideos:!0,selectedDay:T,getSubfolderGroup:Jn,isVideo:zn})},[C,q,Jt,Rt,T,Jn,zn]),{editingDay:ni,editingDayName:In,setEditingDayName:Xn,startEditingDay:Zn,saveDayName:Lr,cancelEditingDay:ri}=Kh({photos:z,persistState:st,setDayLabels:ye}),{selectedPhotos:Xt,setSelectedPhotos:zr,focusedPhoto:Zt,setFocusedPhoto:Pl,setLastSelectedIndex:Dl,lastSelectedIndexRef:li,resetSelection:_l}=bh({filteredPhotos:Rt,coverSelectionMode:f,setCoverForPhotoId:qt,setCoverSelectionMode:p}),{setCoverFromSelection:Ol}=Jh({projectRootPath:le,selectedPhotos:Xt,showToast:N,setCoverForPhotoId:qt}),{handleOnboardingComplete:Ir}=Xh({handleOnboardingCompleteInternal:be,setHistory:De,setHistoryIndex:Re,resetSelection:_l,setSelectedDay:te,setSelectedRootFolder:I,setCurrentView:D}),Rl=b.useCallback(()=>{te(null),I(null)},[te,I]);qh({projectRootPath:le,photosLength:z.length,selectedRootFolder:q,selectedDay:T,currentView:C,days:Ut,rootGroups:Jt,setSelectedDay:te,setSelectedRootFolder:I});const{assignBucket:Mr,removeDayAssignment:si,toggleFavorite:Be}=Yh({photos:z,saveToHistory:ct,selectedDay:T});Wh({selectedPhotos:Xt,focusedPhoto:Zt,filteredPhotos:Rt,orderingResult:cn,fullscreenPhoto:G,showHelp:H,showExportScript:Yt,showWelcome:V,showOnboarding:E,coverSelectionMode:f,hideAssigned:O,MECE_BUCKETS:vl,onAssignBucket:Mr,onToggleFavorite:Be,onUndo:Xe,onRedo:Ue,onSetFocusedPhoto:Pl,onSetSelectedPhotos:zr,onSetLastSelectedIndex:Dl,onSetFullscreenPhoto:ee,onSetShowHelp:W,onSetCoverSelectionMode:p,onSetHideAssigned:U,onToggleDebugOverlay:()=>y(je=>!je),onShowToast:N,lastSelectedIndexRef:li});const ii=As.useMemo(()=>({total:z.length,sorted:z.filter(je=>je.bucket&&!je.archived).length,unsorted:z.filter(je=>!je.bucket&&!je.archived).length,archived:z.filter(je=>je.archived).length,favorites:z.filter(je=>je.favorite).length,root:z.filter(je=>je.day===null&&!je.archived).length}),[z]);return s.jsxs("div",{className:"h-screen flex flex-col bg-gray-950 text-gray-100",children:[s.jsx(Zh,{showWelcome:V,projectName:ie,stats:ii,currentVersion:a,coverSelectionMode:f,selectedPhotosCount:Xt.size,projectRootPath:le,currentView:C,hideAssigned:O,recentProjects:k,projectError:ae,permissionRetryProjectId:Se,loadingProject:Q,hasExportManifest:Tr(),onMainMenu:()=>{A(!1),ge(null),re(!0),Me.remove(un)},onStartCoverSelection:()=>{p(!0),N("Select a photo to set as cover. Click a photo to set, or press Esc to cancel.","info")},onUseCoverSelection:async()=>{await Ol(),p(!1)},onCancelCoverSelection:()=>{p(!1),N("Cover selection cancelled.")},onSelectRecentProject:je=>{Ee(je)},onOpenProject:()=>{A(!0)},onDeleteProject:async()=>{if(!(!le||!window.confirm(`Delete project '${ie}'? This will remove local state and stored folder access. This cannot be undone.`))){try{await jh(le)}catch{N("Failed to delete project.","error");return}try{const ze=Me.get(xt),bt=(ze?JSON.parse(ze):[]).filter(Tl=>Tl.projectId!==le);Me.set(xt,JSON.stringify(bt)),g(bt)}catch{}Me.remove(un),fe([]),$(null),ce("No Project"),re(!0),N("Project deleted.")}},onImportTrip:()=>{ge(null),A(!0)},onExportScript:wl,onUndoExport:_r,onShowHelp:()=>W(!0),onRetryPermission:Pe,onChangeView:je=>D(je),onToggleHideAssigned:()=>U(je=>!je),onRememberFoldersViewState:()=>{de.current={selectedRootFolder:q,selectedDay:T}},onRestoreFoldersViewState:()=>{I(de.current.selectedRootFolder),te(de.current.selectedDay)},onClearDaySelection:()=>{te(null)}}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsx(em,{currentView:C,sidebarCollapsed:M,onCollapseSidebar:()=>B(!0),onExpandSidebar:()=>B(!1),visibleDays:kl,selectedDay:T,selectedRootFolder:q,onSelectDay:te,onSelectRootFolder:I,editingDay:ni,editingDayName:In,onChangeEditingDayName:Xn,onStartEditingDay:Zn,onSaveDayName:Lr,onCancelEditingDay:ri,onClearSelectedDay:Rl,days:Ut,dayLabels:Z,dayContainers:ve,photos:z,normalizePath:Sl,rootGroups:Jt,displayRootGroups:El,sortFolders:bl,projectSettings:F,debugEnabled:d}),s.jsx("main",{className:"flex-1 overflow-y-auto",children:s.jsx("div",{className:"p-6",children:s.jsx(Nm,{loadingProject:Q,currentView:C,selectedDay:T,selectedRootFolder:q,photos:z,rootGroups:Jt,filteredPhotos:Rt,selectedPhotos:Xt,galleryViewPhoto:se,dayLabels:Z,buckets:vl,onSelectPhoto:je=>zr(new Set([je])),onOpenViewer:je=>R(je),onCloseViewer:()=>R(null),onNavigateViewer:je=>R(je),onToggleFavorite:je=>{fe(ze=>ze.map(Ve=>Ve.id===je?{...Ve,favorite:!Ve.favorite}:Ve)),st(z.map(ze=>ze.id===je?{...ze,favorite:!ze.favorite}:ze))},onAssignBucket:(je,ze)=>Mr(je,ze),onAssignDay:(je,ze)=>{fe(Ve=>Ve.map(bt=>bt.id===je?{...bt,day:ze}:bt)),st(z.map(Ve=>Ve.id===je?{...Ve,day:ze}:Ve))},onSaveToHistory:ct,onShowToast:N,getSubfolderGroup:Jn,getDerivedSubfolderGroup:Cl,isVideoPhoto:zn,isMeceBucketLabel:kh})})}),Xt.size>0&&!G&&s.jsx(km,{selectedPhotos:Xt,photos:z,days:Ut,buckets:vl,onSaveToHistory:ct,onPersistState:st,onSetDayLabels:ye,onSetSelectedDay:te,onSetCurrentView:D,onSetSelectedPhotos:zr,onRemoveDayAssignment:si,onAssignBucket:Mr,onToggleFavorite:Be})]}),s.jsx(Pm,{photoId:G,photos:z,onClose:()=>ee(null)}),s.jsx(bm,{isOpen:Yt,scriptText:Rn,copyStatus:qn,detectedProjectPath:Nl(),onClose:Tn,onCopyScript:Ln,onDownloadScript:ei,onRegenerateScript:jl}),s.jsx(Cm,{isOpen:ti,scriptText:Dr,onClose:Or,onDownloadScript:Rr}),s.jsx(Sm,{isOpen:H,buckets:vl,onClose:()=>W(!1)}),s.jsx(Em,{toast:x,onDismiss:w}),s.jsx(Dm,{enabled:m,photos:z.length,filteredPhotos:cn.photos.length,selectedPhotos:Xt.size,currentView:C}),V&&s.jsx(Kp,{isOpen:V,onClose:()=>{le&&(re(!1),Me.set(un,le))},onCreateComplete:Ir,onOpenProject:async je=>{ge(null);const ze=typeof globalThis<"u"&&(globalThis.vitest||globalThis.__APP_VERSION__==="0.0.0");if(!ze&&!("showDirectoryPicker"in window)){ge("This app requires the File System Access API, which is not available in this browser environment. Please use a compatible browser like Chrome or Edge.");return}if(ze){Ee(je);return}try{if(!await Ks(je))try{const bt=await window.showDirectoryPicker();await ua(je,bt),Ee(je);return}catch(bt){console.warn("Folder re-selection cancelled or failed:",bt),Oe(je),A(!0);return}Ee(je)}catch(Ve){console.warn("Error checking stored handle on project open:",Ve),Oe(je),A(!0)}},recentProjects:k,canClose:!!le,errorMessage:ae}),s.jsx(ad,{isOpen:E,onClose:()=>{A(!1),Oe(null)},onComplete:je=>Ir(je,J),recentProjects:k,onSelectRecent:je=>{ge(null),Oe(null),A(!1),Ee(je)}}),s.jsx(Gp,{isOpen:Q,title:"Loading Project",message:he,progress:oe,showProgressBar:!0})]})}function Om(){return s.jsx(_m,{})}const wd=document.getElementById("root");if(!wd)throw new Error('Root element not found. Make sure index.html contains a div with id="root"');gp.createRoot(wd).render(s.jsx(As.StrictMode,{children:s.jsx(Om,{})}));export{op as g};
